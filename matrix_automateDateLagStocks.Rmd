---
title: "matrix"
author: "Janis Corona"
date: "3/14/2020"
output:
  word_document: default
  html_document: default
---

This script is a modified version of the matrix.Rmd script but that the lag and date can be set to analyze the counts, and the file will be saved as STOCK_COUNTS_52<+date queried+lag value>.csv.

What date do you want to get information starting at? How many lags do you want to run this program for? Default is the lag 7, or value seven days earlier.
```{r}
date='1999-01-01'

lag = 5

lagN = paste('lag',lag,sep='')
```


This script automates 52 stocks by ticker symbol pulled from yahoo finance, it then counts the number of times the stock increases in a set of days compared to its price 7 days ago. This could be modified as a better automated script to select the price of these stocks in any amount of days prior to each date's value on that day for the closing value. The date could also be modified so that all dates that were trading days after the date and including it will be calculated. The number of times the days increase or decrease in a row is counted, the number of times that exact number of days increased as well as decreased, and the date the cumulative increase or decrease started is found from this script. Could be useful for a program that finds where you are, how many days it is into increasing or decreasing and what the probability of the stocks in this program increasing or decreasing any more given the number in its historical data. It would not be based on economic hits, but you can manually look those dates up and also see if the values increase or decrease more in seven days by the day of the week, the month, the year, or a date you know a tragedy or financial upset occurred.

The file you need to run this for these specific stocks is the yahooStockBasket.csv file in the folder you found this script.


```{r, error=FALSE, message=FALSE, warning=FALSE}
library(lubridate)
library(dplyr)
library(quantmod)
library(PerformanceAnalytics)
library(tidyr)
```


***


```{r}
stockNames <- read.csv('yahooStockBasket.csv', header=TRUE, sep=',', 
                       na.strings=c('',' ','NA'))
allStocks <- as.character(stockNames$stock)
allStocks
```





```{r, error=FALSE, message=FALSE, warning=FALSE}

tickers <- allStocks

weights <- rep(1/length(tickers), length(tickers))

All_portfolioPrices <- NULL

for (ticker in tickers){
  All_portfolioPrices <- cbind(All_portfolioPrices, getSymbols.yahoo(ticker,
  from = date, 
  periodicity='daily', auto.assign=FALSE)[,4:5])
  
}

names <- as.data.frame(as.character(index(All_portfolioPrices)))
colnames(names) <- 'Date'
portfolio <- as.data.frame(All_portfolioPrices)
all <- cbind(names,portfolio)
```


save a copy to use later if this above program has errors or takes too long to download.
```{r}
write.csv(portfolio, paste(paste('portfolio',date, sep='_'),'csv',sep='.'), row.names=TRUE)
```


```{r}
close <- grep('Close',colnames(portfolio))
Close <- portfolio[,c(close)]
colSums(is.na(Close))
colnames(Close)
```

Remove columns with a lot of NAs from the data. 
```{r}

Close_noNAs <- Close[,-c(9,13,17,18,19,25,27,32,34,46,50,61,65)]
colnames(Close_noNAs) <- gsub('.Close', '', colnames(Close_noNAs))

close52 <- Close_noNAs[complete.cases(Close_noNAs),]
print('The earliest date that all of these 52 stocks have complete stock value information is: ')
as.character(row.names(close52)[1])
```

These are the stocks that were excluded
```{r}
excluded <- Close[,c(9,13,17,18,19,25,27,32,34,46,50,61,65)]
colnames(excluded) <- gsub('.Close', '', colnames(excluded))
colnames(excluded) <- gsub('.PB', '-PB', colnames(excluded))
colnames(excluded)
```

```{r}
excluded$Date <- as.Date(row.names(excluded))
Excluded <- gather(excluded,'stockName','stockDayValue',1:13)

Excluded$stockName <- as.factor(Excluded$stockName)

Lgnbt <- subset(Excluded, Excluded$stockName=='GNBT')
Lfcau <- subset(Excluded, Excluded$stockName=='FCAU')
Lqsr <- subset(Excluded, Excluded$stockName=='QSR')
Lgrpn <- subset(Excluded, Excluded$stockName=='GRPN')
Lscepb <- subset(Excluded, Excluded$stockName=='SCE-PB')
Lgm <- subset(Excluded, Excluded$stockName=='GM')
Lasccy <- subset(Excluded, Excluded$stockName=='ASCCY')
Lcssep <- subset(Excluded, Excluded$stockName=='CSSEP')
Lamc <- subset(Excluded, Excluded$stockName=='AMC')
Ltmus <- subset(Excluded, Excluded$stockName=='TMUS')
Lpbyi <- subset(Excluded, Excluded$stockName=='PBYI')
Lsdc <- subset(Excluded, Excluded$stockName=='SDC')
Lyelp <- subset(Excluded, Excluded$stockName=='YELP')

Lgnbt <- Lgnbt[complete.cases(Lgnbt$stockDayValue),]
Lgnbt$startDayValue <-Lgnbt$stockDayValue[1]
Lgnbt$startDayDate <- Lgnbt$Date[1]

Lfcau <- Lfcau[complete.cases(Lfcau$stockDayValue),]
Lfcau$startDayValue <-Lfcau$stockDayValue[1]
Lfcau$startDayDate <- Lfcau$Date[1]

Lqsr <- Lqsr[complete.cases(Lqsr$stockDayValue),]
Lqsr$startDayValue <-Lqsr$stockDayValue[1]
Lqsr$startDayDate <- Lqsr$Date[1]

Lgrpn <- Lgrpn[complete.cases(Lgrpn$stockDayValue),]
Lgrpn$startDayValue <-Lgrpn$stockDayValue[1]
Lgrpn$startDayDate <- Lgrpn$Date[1]

Lscepb <- Lscepb[complete.cases(Lscepb$stockDayValue),]
Lscepb$startDayValue <-Lscepb$stockDayValue[1]
Lscepb$startDayDate <- Lscepb$Date[1]

Lgm <- Lgm[complete.cases(Lgm$stockDayValue),]
Lgm$startDayValue <-Lgm$stockDayValue[1]
Lgm$startDayDate <- Lgm$Date[1]

Lasccy <- Lasccy[complete.cases(Lasccy$stockDayValue),]
Lasccy$startDayValue <-Lasccy$stockDayValue[1]
Lasccy$startDayDate <- Lasccy$Date[1]

Lcssep <- Lcssep[complete.cases(Lcssep$stockDayValue),]
Lcssep$startDayValue <-Lcssep$stockDayValue[1]
Lcssep$startDayDate <- Lcssep$Date[1]

Lamc <- Lamc[complete.cases(Lamc$stockDayValue),]
Lamc$startDayValue <-Lamc$stockDayValue[1]
Lamc$startDayDate <- Lamc$Date[1]

Ltmus <- Ltmus[complete.cases(Ltmus$stockDayValue),]
Ltmus$startDayValue <-Ltmus$stockDayValue[1]
Ltmus$startDayDate <- Ltmus$Date[1]

Lpbyi <- Lpbyi[complete.cases(Lpbyi$stockDayValue),]
Lpbyi$startDayValue <-Lpbyi$stockDayValue[1]
Lpbyi$startDayDate <- Lpbyi$Date[1]

Lsdc <- Lsdc[complete.cases(Lsdc$stockDayValue),]
Lsdc$startDayValue <-Lsdc$stockDayValue[1]
Lsdc$startDayDate <- Lsdc$Date[1]

Lyelp <- Lyelp[complete.cases(Lyelp$stockDayValue),]
Lyelp$startDayValue <-Lyelp$stockDayValue[1]
Lyelp$startDayDate <- Lyelp$Date[1]


Excluded1 <- rbind(Lgnbt, Lfcau, Lqsr,Lgrpn,Lscepb,Lgm,Lasccy,Lcssep,Lamc,Ltmus,Lpbyi,
                   Lsdc,Lyelp)

final <- subset(Excluded1, Excluded1$Date==Excluded1$Date[length(Excluded1$Date)])
final$finalDayValue <- final$stockDayValue
final$finalDayDate <- final$Date
final1 <- final[,c(2,6,7)]

final1 <- final1[order(final1$stockName),]


Excluded1$DayOfWeek <- as.factor(weekdays(Excluded1$Date))
Excluded1$Year <- as.factor(year(as.Date(Excluded1$Date)))
Excluded1$Month <- as.factor(month(as.Date(Excluded1$Date)))
Excluded1$Month <- as.factor(month.abb[Excluded1$Month])
Excluded1$MonthYear <- as.factor(paste(Excluded1$Month, Excluded1$Year, sep='-'))

Excluded2 <- merge(Excluded1,final1, by.x='stockName', by.y='stockName')


```

```{r}
Excluded2 <- Excluded2[with(Excluded2, order(stockName, Date)),]

Lgnbt <- subset(Excluded2, Excluded2$stockName=='GNBT')
Lfcau <- subset(Excluded2, Excluded2$stockName=='FCAU')
Lqsr <- subset(Excluded2, Excluded2$stockName=='QSR')
Lgrpn <- subset(Excluded2, Excluded2$stockName=='GRPN')
Lscepb <- subset(Excluded2, Excluded2$stockName=='SCE-PB')
Lgm <- subset(Excluded2, Excluded2$stockName=='GM')
Lasccy <- subset(Excluded2, Excluded2$stockName=='ASCCY')
Lcssep <- subset(Excluded2, Excluded2$stockName=='CSSEP')
Lamc <- subset(Excluded2, Excluded2$stockName=='AMC')
Ltmus <- subset(Excluded2, Excluded2$stockName=='TMUS')
Lpbyi <- subset(Excluded2, Excluded2$stockName=='PBYI')
Lsdc <- subset(Excluded2, Excluded2$stockName=='SDC')
Lyelp <- subset(Excluded2, Excluded2$stockName=='YELP')

gnbtLN <- lag(Lgnbt$stockDayValue, lag)
fcauLN <- lag(Lfcau$stockDayValue, lag)
qsrLN <- lag(Lqsr$stockDayValue, lag)
grpnLN <- lag(Lgrpn$stockDayValue, lag)
scepbLN <- lag(Lscepb$stockDayValue, lag)
gmLN <- lag(Lgm$stockDayValue, lag)
asccyLN <- lag(Lasccy$stockDayValue, lag)
cssepLN <- lag(Lcssep$stockDayValue, lag)
amcLN <- lag(Lamc$stockDayValue, lag)
tmusLN <- lag(Ltmus$stockDayValue, lag)
pbyiLN <- lag(Lpbyi$stockDayValue, lag)
sdcLN <- lag(Lsdc$stockDayValue, lag)
yelpLN <- lag(Lyelp$stockDayValue, lag)


Excluded2$lag7 <- c(gnbtLN,fcauLN,qsrLN,grpnLN,scepbLN,
              gmLN,asccyLN,cssepLN,amcLN,tmusLN,pbyiLN,sdcLN,yelpLN)

Excluded2$today2lag7 <- Excluded2$stockDayValue/Excluded2$lag7
```

```{r}
GNBT1 <- subset(Excluded2, Excluded2$stockName=='GNBT')
GNBT1 <- GNBT1[complete.cases(GNBT1),]


#assign a 1 to increasing values
GNBT1$todayGrtrThanLag7 <- ifelse(GNBT1$today2lag7>1, 1,0)

GNBT1$cumulativeSumTodayGrtrThanLag7 <- cumsum(GNBT1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countGNBT10 <- GNBT1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countGNBT10 <- as.data.frame(countGNBT10)
countGNBT10 <- countGNBT10[,-3]
colnames(countGNBT10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countGNBT10$decrDaysThisCycle <- countGNBT10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countGNBT10b <- countGNBT10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countGNBT10b <- as.data.frame(countGNBT10b)
countGNBT10b <- countGNBT10b[,-3]
colnames(countGNBT10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsGNBTtableDecr <- merge(countGNBT10, countGNBT10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
GNBT3 <- merge(GNBT1, countsGNBTtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
GNBT3 <- GNBT3[,c(3,7,9,8,10,2,4,13,14,15,1,17,16,18,5,6,11,12)]


#assign a 1 to decreasing values
GNBT3$todayLessThanLag7 <- ifelse(GNBT3$today2lag7>1, 0,1)

GNBT3$cumulativeSumTodayLessThanLag7 <- cumsum(GNBT3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countGNBT11 <- GNBT3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countGNBT11 <- as.data.frame(countGNBT11)
countGNBT11 <- countGNBT11[,-3]
colnames(countGNBT11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countGNBT11$incrDaysThisCycle <- countGNBT11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countGNBT11b <- countGNBT11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countGNBT11b <- as.data.frame(countGNBT11b)
countGNBT11b <- countGNBT11b[,-3]
colnames(countGNBT11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsGNBTtableIncr <- merge(countGNBT11, countGNBT11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
GNBT4 <- merge(GNBT3, countsGNBTtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



GNBT5 <- GNBT4[,c(2:15,20,1,22,21,23,16:19)]
GNBT5
```


```{r}
FCAU1 <- subset(Excluded2, Excluded2$stockName=='FCAU')
FCAU1 <- FCAU1[complete.cases(FCAU1),]


#assign a 1 to increasing values
FCAU1$todayGrtrThanLag7 <- ifelse(FCAU1$today2lag7>1, 1,0)

FCAU1$cumulativeSumTodayGrtrThanLag7 <- cumsum(FCAU1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countFCAU10 <- FCAU1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countFCAU10 <- as.data.frame(countFCAU10)
countFCAU10 <- countFCAU10[,-3]
colnames(countFCAU10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countFCAU10$decrDaysThisCycle <- countFCAU10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countFCAU10b <- countFCAU10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countFCAU10b <- as.data.frame(countFCAU10b)
countFCAU10b <- countFCAU10b[,-3]
colnames(countFCAU10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsFCAUtableDecr <- merge(countFCAU10, countFCAU10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
FCAU3 <- merge(FCAU1, countsFCAUtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
FCAU3 <- FCAU3[,c(3,7,9,8,10,2,4,13,14,15,1,17,16,18,5,6,11,12)]


#assign a 1 to decreasing values
FCAU3$todayLessThanLag7 <- ifelse(FCAU3$today2lag7>1, 0,1)

FCAU3$cumulativeSumTodayLessThanLag7 <- cumsum(FCAU3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countFCAU11 <- FCAU3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countFCAU11 <- as.data.frame(countFCAU11)
countFCAU11 <- countFCAU11[,-3]
colnames(countFCAU11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countFCAU11$incrDaysThisCycle <- countFCAU11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countFCAU11b <- countFCAU11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countFCAU11b <- as.data.frame(countFCAU11b)
countFCAU11b <- countFCAU11b[,-3]
colnames(countFCAU11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsFCAUtableIncr <- merge(countFCAU11, countFCAU11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
FCAU4 <- merge(FCAU3, countsFCAUtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



FCAU5 <- FCAU4[,c(2:15,20,1,22,21,23,16:19)]
FCAU5
```

```{r}
QSR1 <- subset(Excluded2, Excluded2$stockName=='QSR')
QSR1 <- QSR1[complete.cases(QSR1),]


#assign a 1 to increasing values
QSR1$todayGrtrThanLag7 <- ifelse(QSR1$today2lag7>1, 1,0)

QSR1$cumulativeSumTodayGrtrThanLag7 <- cumsum(QSR1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countQSR10 <- QSR1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countQSR10 <- as.data.frame(countQSR10)
countQSR10 <- countQSR10[,-3]
colnames(countQSR10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countQSR10$decrDaysThisCycle <- countQSR10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countQSR10b <- countQSR10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countQSR10b <- as.data.frame(countQSR10b)
countQSR10b <- countQSR10b[,-3]
colnames(countQSR10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsQSRtableDecr <- merge(countQSR10, countQSR10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
QSR3 <- merge(QSR1, countsQSRtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
QSR3 <- QSR3[,c(3,7,9,8,10,2,4,13,14,15,1,17,16,18,5,6,11,12)]


#assign a 1 to decreasing values
QSR3$todayLessThanLag7 <- ifelse(QSR3$today2lag7>1, 0,1)

QSR3$cumulativeSumTodayLessThanLag7 <- cumsum(QSR3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countQSR11 <- QSR3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countQSR11 <- as.data.frame(countQSR11)
countQSR11 <- countQSR11[,-3]
colnames(countQSR11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countQSR11$incrDaysThisCycle <- countQSR11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countQSR11b <- countQSR11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countQSR11b <- as.data.frame(countQSR11b)
countQSR11b <- countQSR11b[,-3]
colnames(countQSR11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsQSRtableIncr <- merge(countQSR11, countQSR11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
QSR4 <- merge(QSR3, countsQSRtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



QSR5 <- QSR4[,c(2:15,20,1,22,21,23,16:19)]
QSR5
```

```{r}
GRPN1 <- subset(Excluded2, Excluded2$stockName=='GRPN')
GRPN1 <- GRPN1[complete.cases(GRPN1),]


#assign a 1 to increasing values
GRPN1$todayGrtrThanLag7 <- ifelse(GRPN1$today2lag7>1, 1,0)

GRPN1$cumulativeSumTodayGrtrThanLag7 <- cumsum(GRPN1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countGRPN10 <- GRPN1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countGRPN10 <- as.data.frame(countGRPN10)
countGRPN10 <- countGRPN10[,-3]
colnames(countGRPN10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countGRPN10$decrDaysThisCycle <- countGRPN10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countGRPN10b <- countGRPN10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countGRPN10b <- as.data.frame(countGRPN10b)
countGRPN10b <- countGRPN10b[,-3]
colnames(countGRPN10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsGRPNtableDecr <- merge(countGRPN10, countGRPN10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
GRPN3 <- merge(GRPN1, countsGRPNtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
GRPN3 <- GRPN3[,c(3,7,9,8,10,2,4,13,14,15,1,17,16,18,5,6,11,12)]


#assign a 1 to decreasing values
GRPN3$todayLessThanLag7 <- ifelse(GRPN3$today2lag7>1, 0,1)

GRPN3$cumulativeSumTodayLessThanLag7 <- cumsum(GRPN3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countGRPN11 <- GRPN3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countGRPN11 <- as.data.frame(countGRPN11)
countGRPN11 <- countGRPN11[,-3]
colnames(countGRPN11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countGRPN11$incrDaysThisCycle <- countGRPN11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countGRPN11b <- countGRPN11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countGRPN11b <- as.data.frame(countGRPN11b)
countGRPN11b <- countGRPN11b[,-3]
colnames(countGRPN11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsGRPNtableIncr <- merge(countGRPN11, countGRPN11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
GRPN4 <- merge(GRPN3, countsGRPNtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



GRPN5 <- GRPN4[,c(2:15,20,1,22,21,23,16:19)]
GRPN5
```

```{r}
SCEPB1 <- subset(Excluded2, Excluded2$stockName=='SCE-PB')
SCEPB1 <- SCEPB1[complete.cases(SCEPB1),]


#assign a 1 to increasing values
SCEPB1$todayGrtrThanLag7 <- ifelse(SCEPB1$today2lag7>1, 1,0)

SCEPB1$cumulativeSumTodayGrtrThanLag7 <- cumsum(SCEPB1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countSCEPB10 <- SCEPB1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countSCEPB10 <- as.data.frame(countSCEPB10)
countSCEPB10 <- countSCEPB10[,-3]
colnames(countSCEPB10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countSCEPB10$decrDaysThisCycle <- countSCEPB10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countSCEPB10b <- countSCEPB10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countSCEPB10b <- as.data.frame(countSCEPB10b)
countSCEPB10b <- countSCEPB10b[,-3]
colnames(countSCEPB10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsSCEPBtableDecr <- merge(countSCEPB10, countSCEPB10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
SCEPB3 <- merge(SCEPB1, countsSCEPBtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
SCEPB3 <- SCEPB3[,c(3,7,9,8,10,2,4,13,14,15,1,17,16,18,5,6,11,12)]


#assign a 1 to decreasing values
SCEPB3$todayLessThanLag7 <- ifelse(SCEPB3$today2lag7>1, 0,1)

SCEPB3$cumulativeSumTodayLessThanLag7 <- cumsum(SCEPB3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countSCEPB11 <- SCEPB3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countSCEPB11 <- as.data.frame(countSCEPB11)
countSCEPB11 <- countSCEPB11[,-3]
colnames(countSCEPB11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countSCEPB11$incrDaysThisCycle <- countSCEPB11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countSCEPB11b <- countSCEPB11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countSCEPB11b <- as.data.frame(countSCEPB11b)
countSCEPB11b <- countSCEPB11b[,-3]
colnames(countSCEPB11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsSCEPBtableIncr <- merge(countSCEPB11, countSCEPB11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
SCEPB4 <- merge(SCEPB3, countsSCEPBtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



SCEPB5 <- SCEPB4[,c(2:15,20,1,22,21,23,16:19)]
SCEPB5
```


```{r}
GM1 <- subset(Excluded2, Excluded2$stockName=='GM')
GM1 <- GM1[complete.cases(GM1),]


#assign a 1 to increasing values
GM1$todayGrtrThanLag7 <- ifelse(GM1$today2lag7>1, 1,0)

GM1$cumulativeSumTodayGrtrThanLag7 <- cumsum(GM1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countGM10 <- GM1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countGM10 <- as.data.frame(countGM10)
countGM10 <- countGM10[,-3]
colnames(countGM10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countGM10$decrDaysThisCycle <- countGM10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countGM10b <- countGM10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countGM10b <- as.data.frame(countGM10b)
countGM10b <- countGM10b[,-3]
colnames(countGM10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsGMtableDecr <- merge(countGM10, countGM10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
GM3 <- merge(GM1, countsGMtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
GM3 <- GM3[,c(3,7,9,8,10,2,4,13,14,15,1,17,16,18,5,6,11,12)]


#assign a 1 to decreasing values
GM3$todayLessThanLag7 <- ifelse(GM3$today2lag7>1, 0,1)

GM3$cumulativeSumTodayLessThanLag7 <- cumsum(GM3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countGM11 <- GM3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countGM11 <- as.data.frame(countGM11)
countGM11 <- countGM11[,-3]
colnames(countGM11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countGM11$incrDaysThisCycle <- countGM11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countGM11b <- countGM11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countGM11b <- as.data.frame(countGM11b)
countGM11b <- countGM11b[,-3]
colnames(countGM11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsGMtableIncr <- merge(countGM11, countGM11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
GM4 <- merge(GM3, countsGMtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



GM5 <- GM4[,c(2:15,20,1,22,21,23,16:19)]
GM5
```


```{r}
ASCCY1 <- subset(Excluded2, Excluded2$stockName=='ASCCY')
ASCCY1 <- ASCCY1[complete.cases(ASCCY1),]


#assign a 1 to increasing values
ASCCY1$todayGrtrThanLag7 <- ifelse(ASCCY1$today2lag7>1, 1,0)

ASCCY1$cumulativeSumTodayGrtrThanLag7 <- cumsum(ASCCY1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countASCCY10 <- ASCCY1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countASCCY10 <- as.data.frame(countASCCY10)
countASCCY10 <- countASCCY10[,-3]
colnames(countASCCY10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countASCCY10$decrDaysThisCycle <- countASCCY10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countASCCY10b <- countASCCY10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countASCCY10b <- as.data.frame(countASCCY10b)
countASCCY10b <- countASCCY10b[,-3]
colnames(countASCCY10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsASCCYtableDecr <- merge(countASCCY10, countASCCY10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
ASCCY3 <- merge(ASCCY1, countsASCCYtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
ASCCY3 <- ASCCY3[,c(3,7,9,8,10,2,4,13,14,15,1,17,16,18,5,6,11,12)]


#assign a 1 to decreasing values
ASCCY3$todayLessThanLag7 <- ifelse(ASCCY3$today2lag7>1, 0,1)

ASCCY3$cumulativeSumTodayLessThanLag7 <- cumsum(ASCCY3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countASCCY11 <- ASCCY3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countASCCY11 <- as.data.frame(countASCCY11)
countASCCY11 <- countASCCY11[,-3]
colnames(countASCCY11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countASCCY11$incrDaysThisCycle <- countASCCY11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countASCCY11b <- countASCCY11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countASCCY11b <- as.data.frame(countASCCY11b)
countASCCY11b <- countASCCY11b[,-3]
colnames(countASCCY11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsASCCYtableIncr <- merge(countASCCY11, countASCCY11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
ASCCY4 <- merge(ASCCY3, countsASCCYtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



ASCCY5 <- ASCCY4[,c(2:15,20,1,22,21,23,16:19)]
ASCCY5
```


```{r}
CSSEP1 <- subset(Excluded2, Excluded2$stockName=='CSSEP')
CSSEP1 <- CSSEP1[complete.cases(CSSEP1),]


#assign a 1 to increasing values
CSSEP1$todayGrtrThanLag7 <- ifelse(CSSEP1$today2lag7>1, 1,0)

CSSEP1$cumulativeSumTodayGrtrThanLag7 <- cumsum(CSSEP1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countCSSEP10 <- CSSEP1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countCSSEP10 <- as.data.frame(countCSSEP10)
countCSSEP10 <- countCSSEP10[,-3]
colnames(countCSSEP10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countCSSEP10$decrDaysThisCycle <- countCSSEP10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countCSSEP10b <- countCSSEP10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countCSSEP10b <- as.data.frame(countCSSEP10b)
countCSSEP10b <- countCSSEP10b[,-3]
colnames(countCSSEP10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsCSSEPtableDecr <- merge(countCSSEP10, countCSSEP10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
CSSEP3 <- merge(CSSEP1, countsCSSEPtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
CSSEP3 <- CSSEP3[,c(3,7,9,8,10,2,4,13,14,15,1,17,16,18,5,6,11,12)]


#assign a 1 to decreasing values
CSSEP3$todayLessThanLag7 <- ifelse(CSSEP3$today2lag7>1, 0,1)

CSSEP3$cumulativeSumTodayLessThanLag7 <- cumsum(CSSEP3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countCSSEP11 <- CSSEP3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countCSSEP11 <- as.data.frame(countCSSEP11)
countCSSEP11 <- countCSSEP11[,-3]
colnames(countCSSEP11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countCSSEP11$incrDaysThisCycle <- countCSSEP11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countCSSEP11b <- countCSSEP11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countCSSEP11b <- as.data.frame(countCSSEP11b)
countCSSEP11b <- countCSSEP11b[,-3]
colnames(countCSSEP11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsCSSEPtableIncr <- merge(countCSSEP11, countCSSEP11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
CSSEP4 <- merge(CSSEP3, countsCSSEPtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



CSSEP5 <- CSSEP4[,c(2:15,20,1,22,21,23,16:19)]
CSSEP5
```


```{r}
AMC1 <- subset(Excluded2, Excluded2$stockName=='AMC')
AMC1 <- AMC1[complete.cases(AMC1),]


#assign a 1 to increasing values
AMC1$todayGrtrThanLag7 <- ifelse(AMC1$today2lag7>1, 1,0)

AMC1$cumulativeSumTodayGrtrThanLag7 <- cumsum(AMC1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countAMC10 <- AMC1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countAMC10 <- as.data.frame(countAMC10)
countAMC10 <- countAMC10[,-3]
colnames(countAMC10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countAMC10$decrDaysThisCycle <- countAMC10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countAMC10b <- countAMC10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countAMC10b <- as.data.frame(countAMC10b)
countAMC10b <- countAMC10b[,-3]
colnames(countAMC10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsAMCtableDecr <- merge(countAMC10, countAMC10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
AMC3 <- merge(AMC1, countsAMCtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
AMC3 <- AMC3[,c(3,7,9,8,10,2,4,13,14,15,1,17,16,18,5,6,11,12)]


#assign a 1 to decreasing values
AMC3$todayLessThanLag7 <- ifelse(AMC3$today2lag7>1, 0,1)

AMC3$cumulativeSumTodayLessThanLag7 <- cumsum(AMC3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countAMC11 <- AMC3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countAMC11 <- as.data.frame(countAMC11)
countAMC11 <- countAMC11[,-3]
colnames(countAMC11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countAMC11$incrDaysThisCycle <- countAMC11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countAMC11b <- countAMC11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countAMC11b <- as.data.frame(countAMC11b)
countAMC11b <- countAMC11b[,-3]
colnames(countAMC11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsAMCtableIncr <- merge(countAMC11, countAMC11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
AMC4 <- merge(AMC3, countsAMCtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



AMC5 <- AMC4[,c(2:15,20,1,22,21,23,16:19)]
AMC5
```


```{r}
TMUS1 <- subset(Excluded2, Excluded2$stockName=='TMUS')
TMUS1 <- TMUS1[complete.cases(TMUS1),]


#assign a 1 to increasing values
TMUS1$todayGrtrThanLag7 <- ifelse(TMUS1$today2lag7>1, 1,0)

TMUS1$cumulativeSumTodayGrtrThanLag7 <- cumsum(TMUS1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countTMUS10 <- TMUS1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countTMUS10 <- as.data.frame(countTMUS10)
countTMUS10 <- countTMUS10[,-3]
colnames(countTMUS10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countTMUS10$decrDaysThisCycle <- countTMUS10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countTMUS10b <- countTMUS10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countTMUS10b <- as.data.frame(countTMUS10b)
countTMUS10b <- countTMUS10b[,-3]
colnames(countTMUS10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsTMUStableDecr <- merge(countTMUS10, countTMUS10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
TMUS3 <- merge(TMUS1, countsTMUStableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
TMUS3 <- TMUS3[,c(3,7,9,8,10,2,4,13,14,15,1,17,16,18,5,6,11,12)]


#assign a 1 to decreasing values
TMUS3$todayLessThanLag7 <- ifelse(TMUS3$today2lag7>1, 0,1)

TMUS3$cumulativeSumTodayLessThanLag7 <- cumsum(TMUS3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countTMUS11 <- TMUS3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countTMUS11 <- as.data.frame(countTMUS11)
countTMUS11 <- countTMUS11[,-3]
colnames(countTMUS11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countTMUS11$incrDaysThisCycle <- countTMUS11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countTMUS11b <- countTMUS11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countTMUS11b <- as.data.frame(countTMUS11b)
countTMUS11b <- countTMUS11b[,-3]
colnames(countTMUS11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsTMUStableIncr <- merge(countTMUS11, countTMUS11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
TMUS4 <- merge(TMUS3, countsTMUStableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



TMUS5 <- TMUS4[,c(2:15,20,1,22,21,23,16:19)]
TMUS5
```


```{r}
PBYI1 <- subset(Excluded2, Excluded2$stockName=='PBYI')
PBYI1 <- PBYI1[complete.cases(PBYI1),]


#assign a 1 to increasing values
PBYI1$todayGrtrThanLag7 <- ifelse(PBYI1$today2lag7>1, 1,0)

PBYI1$cumulativeSumTodayGrtrThanLag7 <- cumsum(PBYI1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countPBYI10 <- PBYI1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countPBYI10 <- as.data.frame(countPBYI10)
countPBYI10 <- countPBYI10[,-3]
colnames(countPBYI10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countPBYI10$decrDaysThisCycle <- countPBYI10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countPBYI10b <- countPBYI10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countPBYI10b <- as.data.frame(countPBYI10b)
countPBYI10b <- countPBYI10b[,-3]
colnames(countPBYI10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsPBYItableDecr <- merge(countPBYI10, countPBYI10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
PBYI3 <- merge(PBYI1, countsPBYItableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
PBYI3 <- PBYI3[,c(3,7,9,8,10,2,4,13,14,15,1,17,16,18,5,6,11,12)]


#assign a 1 to decreasing values
PBYI3$todayLessThanLag7 <- ifelse(PBYI3$today2lag7>1, 0,1)

PBYI3$cumulativeSumTodayLessThanLag7 <- cumsum(PBYI3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countPBYI11 <- PBYI3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countPBYI11 <- as.data.frame(countPBYI11)
countPBYI11 <- countPBYI11[,-3]
colnames(countPBYI11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countPBYI11$incrDaysThisCycle <- countPBYI11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countPBYI11b <- countPBYI11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countPBYI11b <- as.data.frame(countPBYI11b)
countPBYI11b <- countPBYI11b[,-3]
colnames(countPBYI11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsPBYItableIncr <- merge(countPBYI11, countPBYI11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
PBYI4 <- merge(PBYI3, countsPBYItableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



PBYI5 <- PBYI4[,c(2:15,20,1,22,21,23,16:19)]
PBYI5
```


```{r}
SDC1 <- subset(Excluded2, Excluded2$stockName=='SDC')
SDC1 <- SDC1[complete.cases(SDC1),]


#assign a 1 to increasing values
SDC1$todayGrtrThanLag7 <- ifelse(SDC1$today2lag7>1, 1,0)

SDC1$cumulativeSumTodayGrtrThanLag7 <- cumsum(SDC1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countSDC10 <- SDC1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countSDC10 <- as.data.frame(countSDC10)
countSDC10 <- countSDC10[,-3]
colnames(countSDC10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countSDC10$decrDaysThisCycle <- countSDC10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countSDC10b <- countSDC10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countSDC10b <- as.data.frame(countSDC10b)
countSDC10b <- countSDC10b[,-3]
colnames(countSDC10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsSDCtableDecr <- merge(countSDC10, countSDC10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
SDC3 <- merge(SDC1, countsSDCtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
SDC3 <- SDC3[,c(3,7,9,8,10,2,4,13,14,15,1,17,16,18,5,6,11,12)]


#assign a 1 to decreasing values
SDC3$todayLessThanLag7 <- ifelse(SDC3$today2lag7>1, 0,1)

SDC3$cumulativeSumTodayLessThanLag7 <- cumsum(SDC3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countSDC11 <- SDC3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countSDC11 <- as.data.frame(countSDC11)
countSDC11 <- countSDC11[,-3]
colnames(countSDC11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countSDC11$incrDaysThisCycle <- countSDC11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countSDC11b <- countSDC11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countSDC11b <- as.data.frame(countSDC11b)
countSDC11b <- countSDC11b[,-3]
colnames(countSDC11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsSDCtableIncr <- merge(countSDC11, countSDC11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
SDC4 <- merge(SDC3, countsSDCtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



SDC5 <- SDC4[,c(2:15,20,1,22,21,23,16:19)]
SDC5
```


```{r}
YELP1 <- subset(Excluded2, Excluded2$stockName=='YELP')
YELP1 <- YELP1[complete.cases(YELP1),]


#assign a 1 to increasing values
YELP1$todayGrtrThanLag7 <- ifelse(YELP1$today2lag7>1, 1,0)

YELP1$cumulativeSumTodayGrtrThanLag7 <- cumsum(YELP1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countYELP10 <- YELP1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countYELP10 <- as.data.frame(countYELP10)
countYELP10 <- countYELP10[,-3]
colnames(countYELP10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countYELP10$decrDaysThisCycle <- countYELP10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countYELP10b <- countYELP10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countYELP10b <- as.data.frame(countYELP10b)
countYELP10b <- countYELP10b[,-3]
colnames(countYELP10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsYELPtableDecr <- merge(countYELP10, countYELP10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
YELP3 <- merge(YELP1, countsYELPtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
YELP3 <- YELP3[,c(3,7,9,8,10,2,4,13,14,15,1,17,16,18,5,6,11,12)]


#assign a 1 to decreasing values
YELP3$todayLessThanLag7 <- ifelse(YELP3$today2lag7>1, 0,1)

YELP3$cumulativeSumTodayLessThanLag7 <- cumsum(YELP3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countYELP11 <- YELP3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countYELP11 <- as.data.frame(countYELP11)
countYELP11 <- countYELP11[,-3]
colnames(countYELP11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countYELP11$incrDaysThisCycle <- countYELP11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countYELP11b <- countYELP11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countYELP11b <- as.data.frame(countYELP11b)
countYELP11b <- countYELP11b[,-3]
colnames(countYELP11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsYELPtableIncr <- merge(countYELP11, countYELP11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
YELP4 <- merge(YELP3, countsYELPtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



YELP5 <- YELP4[,c(2:15,20,1,22,21,23,16:19)]
YELP5
```


```{r}
inCompREQ_stocks <- rbind(GNBT5,FCAU5,QSR5,GRPN5,SCEPB5,GM5,ASCCY5,CSSEP5,AMC5,TMUS5,PBYI5,
                       SDC5,YELP5)
colnames(inCompREQ_stocks) <- gsub('lag7',lagN, colnames(inCompREQ_stocks))
colnames(inCompREQ_stocks) <- gsub('Lag7',lagN, colnames(inCompREQ_stocks))

```

```{r}
write.csv(inCompREQ_stocks, paste(paste(paste('incomplete_stocks',date,sep='_'),
                                        lagN, sep='_'),
                                        'csv',sep='.'), row.names=FALSE)
```


***
***
Those were the stocks excluded from the 52 stocks and less stocks combined to the 52 stocks at the end, for which ALL dates had information for closing stock daily values for those specific stocks. 

***

The rest of code pulls the information needed for the 52 stocks originally having more information for the date requested.
```{r}
colnames(CloseAll) <- gsub('.Close','',colnames(CloseAll))
CloseAll$Date <- as.Date(row.names(CloseAll))
```

The table of only those stocks that had information for all dates declared at the beginning.
```{r}
CloseAll2 <- gather(CloseAll,'stockName','stockDayValue',1:41)
CloseAll2$stockName <- as.factor(CloseAll2$stockName)

start <- subset(CloseAll2, CloseAll2$Date==CloseAll2$Date[1])
final <- subset(CloseAll2, CloseAll2$Date==CloseAll2$Date[length(CloseAll2$Date)])
colnames(start)[3] <- 'startDayValue'
colnames(final)[3] <- 'finalDayValue'
final <- final[order(final$stockName),2:3]
startFinal <-merge(start,final, by.x='stockName', by.y='stockName')
startFinalmeta <- merge(startFinal, stockNames, by.x='stockName', by.y='stock')

CloseAll2$DayOfWeek <- as.factor(weekdays(CloseAll$Date))
CloseAll2$Year <- as.factor(year(as.Date(CloseAll$Date)))
CloseAll2$Month <- as.factor(month(as.Date(CloseAll$Date)))
CloseAll2$Month <- as.factor(month.abb[CloseAll2$Month])
CloseAll2$MonthYear <- as.factor(paste(CloseAll2$Month, CloseAll2$Year, sep='-'))

sfm <- startFinalmeta[,-2]
CloseAll3 <- merge(CloseAll2, sfm, by.x='stockName', by.y='stockName')

```


Create a table of the 52 stocks' information.
```{r}
meta <- as.data.frame(colnames(Close_noNAs))
colnames(meta) <- 'stockName'
Meta52 <- merge(meta, stockNames, by.x='stockName', by.y='stock')
```


```{r}
Close_noNAs$Date <- as.Date(row.names(Close_noNAs))
```


```{r}
Close_noNAs$DayOfWeek <- weekdays(Close_noNAs$Date)
```

```{r}
month <- month(as.Date(Close_noNAs$Date))
Month <- month.abb[month]
Close_noNAs$Month <- Month
```


Add in the year of the Date column.
```{r}
Year <- year(as.Date(Close_noNAs$Date))

Close_noNAs$Year <- Year

Close_noNAs$MonthYear <- paste(Close_noNAs$Month, Close_noNAs$Year, sep='-')
Close_noNAs$MonthYear <- as.factor(Close_noNAs$MonthYear)
```




```{r}
#make all the stock name columns one field of stock names
df52 <- gather(Close_noNAs, 'stockName','stockDayValue',1:52)


```


Add the 7 day lag then add the ratio of each day's stock value to the lag. Then get the counts of cumulative days the ratio increased and decreased. 

```{r}
df52 <- df52[with(df52, order(stockName, Date)),]

Laal <- subset(df52, df52$stockName=='AAL')
Laap <- subset(df52, df52$stockName=='AAP')
Laddyy <- subset(df52, df52$stockName=='ADDYY')
Lamzn <- subset(df52, df52$stockName=='AMZN')
Larwr <- subset(df52, df52$stockName=='ARWR')
Lc <- subset(df52, df52$stockName=='C')
Lcost <- subset(df52, df52$stockName=='COST')
Lcvx <- subset(df52, df52$stockName=='CVX')
Ldltr <- subset(df52, df52$stockName=='DLTR')
Lepd <- subset(df52, df52$stockName=='EPD')
Lf <- subset(df52, df52$stockName=='F')
Lffin <- subset(df52, df52$stockName=='FFIN')
Lftr <- subset(df52, df52$stockName=='FTR')
Lgoog <- subset(df52, df52$stockName=='GOOG')
Lhd <- subset(df52, df52$stockName=='HD')
Lhmc <- subset(df52, df52$stockName=='HMC')
Lhoft <- subset(df52, df52$stockName=='HOFT')
Lhrb <- subset(df52, df52$stockName=='HRB')
Lhst <- subset(df52, df52$stockName=='HST')
Lino <- subset(df52, df52$stockName=='INO')
Ljblu <- subset(df52, df52$stockName=='JBLU')
Ljnj <- subset(df52, df52$stockName=='JNJ')
Ljpm <- subset(df52, df52$stockName=='JPM')
Ljwn <- subset(df52, df52$stockName=='JWN')
Lkgji <- subset(df52, df52$stockName=='KGJI')
Lkss <- subset(df52, df52$stockName=='KSS')
Lluv <- subset(df52, df52$stockName=='LUV')
Lm <- subset(df52, df52$stockName=='M')
Lmgm <- subset(df52, df52$stockName=='MGM')
Lmsft <- subset(df52, df52$stockName=='MSFT')
Lnflx <- subset(df52, df52$stockName=='NFLX')
Lnke <- subset(df52, df52$stockName=='NKE')
Lnsany <- subset(df52, df52$stockName=='NSANY')
Lnus <- subset(df52, df52$stockName=='NUS')
Loncy <- subset(df52, df52$stockName=='ONCY')
Lpcg <- subset(df52, df52$stockName=='PCG')
Lrost <- subset(df52, df52$stockName=='ROST')
Lrrgb <- subset(df52, df52$stockName=='RRGB')
Ls <- subset(df52, df52$stockName=='S')
Lsig <- subset(df52, df52$stockName=='SIG')
Lt <- subset(df52, df52$stockName=='T')
Lteva <- subset(df52, df52$stockName=='TEVA')
Ltgt <- subset(df52, df52$stockName=='TGT')
Ltjx <- subset(df52, df52$stockName=='TJX')
Ltm <- subset(df52, df52$stockName=='TM')
Lubsi <- subset(df52, df52$stockName=='UBSI')
Lvz <- subset(df52, df52$stockName=='VZ')
Lwfc <- subset(df52, df52$stockName=='WFC')
Lwm <- subset(df52, df52$stockName=='WM')
Lwmt <- subset(df52, df52$stockName=='WMT')
Lwwe <- subset(df52, df52$stockName=='WWE')
Lxom <- subset(df52, df52$stockName=='XOM')

aalLN <- lag(Laal$stockDayValue, lag)
aapLN <- lag(Laap$stockDayValue, lag)
addyyLN <- lag(Laddyy$stockDayValue, lag)
amznLN <- lag(Lamzn$stockDayValue, lag)
arwrLN <- lag(Larwr$stockDayValue, lag)
cLN <- lag(Lc$stockDayValue, lag)
costLN <- lag(Lcost$stockDayValue, lag)
cvxLN <- lag(Lcvx$stockDayValue, lag)
dltrLN <- lag(Ldltr$stockDayValue, lag)
epdLN <- lag(Lepd$stockDayValue, lag)
fLN <- lag(Lf$stockDayValue, lag)
ffinLN <- lag(Lffin$stockDayValue, lag)
ftrLN <- lag(Lftr$stockDayValue, lag)
googLN <- lag(Lgoog$stockDayValue, lag)
hdLN <- lag(Lhd$stockDayValue, lag)
hmcLN <- lag(Lhmc$stockDayValue, lag)
hoftLN <- lag(Lhoft$stockDayValue, lag)
hrbLN <- lag(Lhrb$stockDayValue, lag)
hstLN <- lag(Lhst$stockDayValue, lag)
inoLN <- lag(Lino$stockDayValue, lag)
jbluLN <- lag(Ljblu$stockDayValue, lag)
jnjLN <- lag(Ljnj$stockDayValue, lag)
jpmLN <- lag(Ljpm$stockDayValue, lag)
jwnLN <- lag(Ljwn$stockDayValue, lag)
kgjiLN <- lag(Lkgji$stockDayValue, lag)
kssLN <- lag(Lkss$stockDayValue, lag)
luvLN <- lag(Lluv$stockDayValue, lag)
mLN <- lag(Lm$stockDayValue, lag)
mgmLN <- lag(Lmgm$stockDayValue, lag)
msftLN <- lag(Lmsft$stockDayValue, lag)
nflxLN <- lag(Lnflx$stockDayValue, lag)
nkeLN <- lag(Lnke$stockDayValue, lag)
nsanyLN <- lag(Lnsany$stockDayValue, lag)
nusLN <- lag(Lnus$stockDayValue, lag)
oncyLN <- lag(Loncy$stockDayValue, lag)
pcgLN <- lag(Lpcg$stockDayValue, lag)
rostLN <- lag(Lrost$stockDayValue, lag)
rrgbLN <- lag(Lrrgb$stockDayValue, lag)
sLN <- lag(Ls$stockDayValue, lag)
sigLN <- lag(Lsig$stockDayValue, lag)
tLN <- lag(Lt$stockDayValue, lag)
tevaLN <- lag(Lteva$stockDayValue, lag)
tgtLN <- lag(Ltgt$stockDayValue, lag)
tjxLN <- lag(Ltjx$stockDayValue, lag)
tmLN <- lag(Ltm$stockDayValue, lag)
ubsiLN <- lag(Lubsi$stockDayValue, lag)
vzLN <- lag(Lvz$stockDayValue, lag)
wfcLN <- lag(Lwfc$stockDayValue, lag)
wmLN <- lag(Lwm$stockDayValue, lag)
wmtLN <- lag(Lwmt$stockDayValue, lag)
wweLN <- lag(Lwwe$stockDayValue, lag)
xomLN <- lag(Lxom$stockDayValue, lag)

df52$lag7 <- c(aalLN,aapLN,addyyLN,amznLN,arwrLN,
              cLN,costLN,cvxLN,dltrLN,epdLN,fLN,ffinLN,ftrLN,googLN,hdLN,
              hmcLN,hoftLN,hrbLN,hstLN,inoLN,jbluLN,jnjLN,jpmLN,
              jwnLN,kgjiLN,kssLN,luvLN,mLN,mgmLN,msftLN,nflxLN,nkeLN,
              nsanyLN,nusLN,oncyLN,pcgLN,rostLN,
              rrgbLN,sLN,sigLN,tLN,tevaLN,tgtLN,tjxLN,tmLN,
              ubsiLN,vzLN,wfcLN,wmLN,wmtLN,wweLN,xomLN)

#the dataset is ordered by stock then by date, so this works with matching,
#NAs are present when no data in dataset before that date, and the today2lag7
#will also have NAs in those instances
df52$today2lag7 <- df52$stockDayValue/df52$lag7


df52_b <- df52[complete.cases(df52),]

df52_c <- df52_b[with(df52_b, order(stockName, Date)),]

#complete date requested stocks
comp <- as.data.frame(unique(CloseAll3$stockName))
colnames(comp) <- 'stockName'

CloseAll4 <- CloseAll3[with(CloseAll3, order(stockName, Date)),]

compStocks <- merge(comp, df52_c, by.x='stockName', by.y='stockName')


```

***

```{r}
AAL1 <- subset(df52, df52$stockName=='AAL')
AAL1 <- AAL1[complete.cases(AAL1),]


#assign a 1 to increasing values
AAL1$todayGrtrThanLag7 <- ifelse(AAL1$today2lag7>1, 1,0)

AAL1$cumulativeSumTodayGrtrThanLag7 <- cumsum(AAL1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countAAL10 <- AAL1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countAAL10 <- as.data.frame(countAAL10)
countAAL10 <- countAAL10[,-3]
colnames(countAAL10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countAAL10$decrDaysThisCycle <- countAAL10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countAAL10b <- countAAL10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countAAL10b <- as.data.frame(countAAL10b)
countAAL10b <- countAAL10b[,-3]
colnames(countAAL10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsAALtableDecr <- merge(countAAL10, countAAL10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
AAL3 <- merge(AAL1, countsAALtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
AAL3 <- AAL3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
AAL3$todayLessThanLag7 <- ifelse(AAL3$today2lag7>1, 0,1)

AAL3$cumulativeSumTodayLessThanLag7 <- cumsum(AAL3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countAAL11 <- AAL3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countAAL11 <- as.data.frame(countAAL11)
countAAL11 <- countAAL11[,-3]
colnames(countAAL11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countAAL11$incrDaysThisCycle <- countAAL11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countAAL11b <- countAAL11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countAAL11b <- as.data.frame(countAAL11b)
countAAL11b <- countAAL11b[,-3]
colnames(countAAL11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsAALtableIncr <- merge(countAAL11, countAAL11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
AAL4 <- merge(AAL3, countsAALtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



AAL5 <- AAL4[,c(2:16,1,18,17,19)]
AAL5
```

***


```{r}
AAP1 <- subset(df52, df52$stockName=='AAP')
AAP1 <- AAP1[complete.cases(AAP1),]


#assign a 1 to increasing values
AAP1$todayGrtrThanLag7 <- ifelse(AAP1$today2lag7>1, 1,0)

AAP1$cumulativeSumTodayGrtrThanLag7 <- cumsum(AAP1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countAAP10 <- AAP1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countAAP10 <- as.data.frame(countAAP10)
countAAP10 <- countAAP10[,-3]
colnames(countAAP10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countAAP10$decrDaysThisCycle <- countAAP10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countAAP10b <- countAAP10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countAAP10b <- as.data.frame(countAAP10b)
countAAP10b <- countAAP10b[,-3]
colnames(countAAP10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsAAPtableDecr <- merge(countAAP10, countAAP10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
AAP3 <- merge(AAP1, countsAAPtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
AAP3 <- AAP3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
AAP3$todayLessThanLag7 <- ifelse(AAP3$today2lag7>1, 0,1)

AAP3$cumulativeSumTodayLessThanLag7 <- cumsum(AAP3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countAAP11 <- AAP3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countAAP11 <- as.data.frame(countAAP11)
countAAP11 <- countAAP11[,-3]
colnames(countAAP11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countAAP11$incrDaysThisCycle <- countAAP11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countAAP11b <- countAAP11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countAAP11b <- as.data.frame(countAAP11b)
countAAP11b <- countAAP11b[,-3]
colnames(countAAP11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsAAPtableIncr <- merge(countAAP11, countAAP11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
AAP4 <- merge(AAP3, countsAAPtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



AAP5 <- AAP4[,c(2:16,1,18,17,19)]
AAP5
```

***


```{r}
ADDYY1 <- subset(df52, df52$stockName=='ADDYY')
ADDYY1 <- ADDYY1[complete.cases(ADDYY1),]


#assign a 1 to increasing values
ADDYY1$todayGrtrThanLag7 <- ifelse(ADDYY1$today2lag7>1, 1,0)

ADDYY1$cumulativeSumTodayGrtrThanLag7 <- cumsum(ADDYY1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countADDYY10 <- ADDYY1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countADDYY10 <- as.data.frame(countADDYY10)
countADDYY10 <- countADDYY10[,-3]
colnames(countADDYY10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countADDYY10$decrDaysThisCycle <- countADDYY10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countADDYY10b <- countADDYY10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countADDYY10b <- as.data.frame(countADDYY10b)
countADDYY10b <- countADDYY10b[,-3]
colnames(countADDYY10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsADDYYtableDecr <- merge(countADDYY10, countADDYY10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
ADDYY3 <- merge(ADDYY1, countsADDYYtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
ADDYY3 <- ADDYY3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
ADDYY3$todayLessThanLag7 <- ifelse(ADDYY3$today2lag7>1, 0,1)

ADDYY3$cumulativeSumTodayLessThanLag7 <- cumsum(ADDYY3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countADDYY11 <- ADDYY3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countADDYY11 <- as.data.frame(countADDYY11)
countADDYY11 <- countADDYY11[,-3]
colnames(countADDYY11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countADDYY11$incrDaysThisCycle <- countADDYY11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countADDYY11b <- countADDYY11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countADDYY11b <- as.data.frame(countADDYY11b)
countADDYY11b <- countADDYY11b[,-3]
colnames(countADDYY11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsADDYYtableIncr <- merge(countADDYY11, countADDYY11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
ADDYY4 <- merge(ADDYY3, countsADDYYtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



ADDYY5 <- ADDYY4[,c(2:16,1,18,17,19)]
ADDYY5
```

***


```{r}
AMZN1 <- subset(df52, df52$stockName=='AMZN')
AMZN1 <- AMZN1[complete.cases(AMZN1),]


#assign a 1 to increasing values
AMZN1$todayGrtrThanLag7 <- ifelse(AMZN1$today2lag7>1, 1,0)

AMZN1$cumulativeSumTodayGrtrThanLag7 <- cumsum(AMZN1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countAMZN10 <- AMZN1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countAMZN10 <- as.data.frame(countAMZN10)
countAMZN10 <- countAMZN10[,-3]
colnames(countAMZN10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countAMZN10$decrDaysThisCycle <- countAMZN10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countAMZN10b <- countAMZN10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countAMZN10b <- as.data.frame(countAMZN10b)
countAMZN10b <- countAMZN10b[,-3]
colnames(countAMZN10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsAMZNtableDecr <- merge(countAMZN10, countAMZN10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
AMZN3 <- merge(AMZN1, countsAMZNtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
AMZN3 <- AMZN3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
AMZN3$todayLessThanLag7 <- ifelse(AMZN3$today2lag7>1, 0,1)

AMZN3$cumulativeSumTodayLessThanLag7 <- cumsum(AMZN3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countAMZN11 <- AMZN3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countAMZN11 <- as.data.frame(countAMZN11)
countAMZN11 <- countAMZN11[,-3]
colnames(countAMZN11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countAMZN11$incrDaysThisCycle <- countAMZN11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countAMZN11b <- countAMZN11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countAMZN11b <- as.data.frame(countAMZN11b)
countAMZN11b <- countAMZN11b[,-3]
colnames(countAMZN11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsAMZNtableIncr <- merge(countAMZN11, countAMZN11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
AMZN4 <- merge(AMZN3, countsAMZNtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



AMZN5 <- AMZN4[,c(2:16,1,18,17,19)]
AMZN5
```

***


```{r}
ARWR1 <- subset(df52, df52$stockName=='ARWR')
ARWR1 <- ARWR1[complete.cases(ARWR1),]


#assign a 1 to increasing values
ARWR1$todayGrtrThanLag7 <- ifelse(ARWR1$today2lag7>1, 1,0)

ARWR1$cumulativeSumTodayGrtrThanLag7 <- cumsum(ARWR1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countARWR10 <- ARWR1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countARWR10 <- as.data.frame(countARWR10)
countARWR10 <- countARWR10[,-3]
colnames(countARWR10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countARWR10$decrDaysThisCycle <- countARWR10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countARWR10b <- countARWR10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countARWR10b <- as.data.frame(countARWR10b)
countARWR10b <- countARWR10b[,-3]
colnames(countARWR10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsARWRtableDecr <- merge(countARWR10, countARWR10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
ARWR3 <- merge(ARWR1, countsARWRtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
ARWR3 <- ARWR3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
ARWR3$todayLessThanLag7 <- ifelse(ARWR3$today2lag7>1, 0,1)

ARWR3$cumulativeSumTodayLessThanLag7 <- cumsum(ARWR3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countARWR11 <- ARWR3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countARWR11 <- as.data.frame(countARWR11)
countARWR11 <- countARWR11[,-3]
colnames(countARWR11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countARWR11$incrDaysThisCycle <- countARWR11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countARWR11b <- countARWR11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countARWR11b <- as.data.frame(countARWR11b)
countARWR11b <- countARWR11b[,-3]
colnames(countARWR11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsARWRtableIncr <- merge(countARWR11, countARWR11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
ARWR4 <- merge(ARWR3, countsARWRtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



ARWR5 <- ARWR4[,c(2:16,1,18,17,19)]
ARWR5
```

***


```{r}
C1 <- subset(df52, df52$stockName=='C')
C1 <- C1[complete.cases(C1),]


#assign a 1 to increasing values
C1$todayGrtrThanLag7 <- ifelse(C1$today2lag7>1, 1,0)

C1$cumulativeSumTodayGrtrThanLag7 <- cumsum(C1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countC10 <- C1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countC10 <- as.data.frame(countC10)
countC10 <- countC10[,-3]
colnames(countC10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countC10$decrDaysThisCycle <- countC10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countC10b <- countC10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countC10b <- as.data.frame(countC10b)
countC10b <- countC10b[,-3]
colnames(countC10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsCtableDecr <- merge(countC10, countC10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
C3 <- merge(C1, countsCtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
C3 <- C3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
C3$todayLessThanLag7 <- ifelse(C3$today2lag7>1, 0,1)

C3$cumulativeSumTodayLessThanLag7 <- cumsum(C3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countC11 <- C3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countC11 <- as.data.frame(countC11)
countC11 <- countC11[,-3]
colnames(countC11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countC11$incrDaysThisCycle <- countC11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countC11b <- countC11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countC11b <- as.data.frame(countC11b)
countC11b <- countC11b[,-3]
colnames(countC11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsCtableIncr <- merge(countC11, countC11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
C4 <- merge(C3, countsCtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



C5 <- C4[,c(2:16,1,18,17,19)]
C5
```

***


```{r}
COST1 <- subset(df52, df52$stockName=='COST')
COST1 <- COST1[complete.cases(COST1),]


#assign a 1 to increasing values
COST1$todayGrtrThanLag7 <- ifelse(COST1$today2lag7>1, 1,0)

COST1$cumulativeSumTodayGrtrThanLag7 <- cumsum(COST1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countCOST10 <- COST1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countCOST10 <- as.data.frame(countCOST10)
countCOST10 <- countCOST10[,-3]
colnames(countCOST10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countCOST10$decrDaysThisCycle <- countCOST10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countCOST10b <- countCOST10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countCOST10b <- as.data.frame(countCOST10b)
countCOST10b <- countCOST10b[,-3]
colnames(countCOST10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsCOSTtableDecr <- merge(countCOST10, countCOST10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
COST3 <- merge(COST1, countsCOSTtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
COST3 <- COST3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
COST3$todayLessThanLag7 <- ifelse(COST3$today2lag7>1, 0,1)

COST3$cumulativeSumTodayLessThanLag7 <- cumsum(COST3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countCOST11 <- COST3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countCOST11 <- as.data.frame(countCOST11)
countCOST11 <- countCOST11[,-3]
colnames(countCOST11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countCOST11$incrDaysThisCycle <- countCOST11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countCOST11b <- countCOST11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countCOST11b <- as.data.frame(countCOST11b)
countCOST11b <- countCOST11b[,-3]
colnames(countCOST11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsCOSTtableIncr <- merge(countCOST11, countCOST11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
COST4 <- merge(COST3, countsCOSTtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



COST5 <- COST4[,c(2:16,1,18,17,19)]
COST5
```

***


```{r}
CVX1 <- subset(df52, df52$stockName=='CVX')
CVX1 <- CVX1[complete.cases(CVX1),]


#assign a 1 to increasing values
CVX1$todayGrtrThanLag7 <- ifelse(CVX1$today2lag7>1, 1,0)

CVX1$cumulativeSumTodayGrtrThanLag7 <- cumsum(CVX1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countCVX10 <- CVX1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countCVX10 <- as.data.frame(countCVX10)
countCVX10 <- countCVX10[,-3]
colnames(countCVX10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countCVX10$decrDaysThisCycle <- countCVX10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countCVX10b <- countCVX10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countCVX10b <- as.data.frame(countCVX10b)
countCVX10b <- countCVX10b[,-3]
colnames(countCVX10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsCVXtableDecr <- merge(countCVX10, countCVX10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
CVX3 <- merge(CVX1, countsCVXtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
CVX3 <- CVX3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
CVX3$todayLessThanLag7 <- ifelse(CVX3$today2lag7>1, 0,1)

CVX3$cumulativeSumTodayLessThanLag7 <- cumsum(CVX3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countCVX11 <- CVX3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countCVX11 <- as.data.frame(countCVX11)
countCVX11 <- countCVX11[,-3]
colnames(countCVX11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countCVX11$incrDaysThisCycle <- countCVX11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countCVX11b <- countCVX11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countCVX11b <- as.data.frame(countCVX11b)
countCVX11b <- countCVX11b[,-3]
colnames(countCVX11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsCVXtableIncr <- merge(countCVX11, countCVX11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
CVX4 <- merge(CVX3, countsCVXtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



CVX5 <- CVX4[,c(2:16,1,18,17,19)]
CVX5
```

***


```{r}
DLTR1 <- subset(df52, df52$stockName=='DLTR')
DLTR1 <- DLTR1[complete.cases(DLTR1),]


#assign a 1 to increasing values
DLTR1$todayGrtrThanLag7 <- ifelse(DLTR1$today2lag7>1, 1,0)

DLTR1$cumulativeSumTodayGrtrThanLag7 <- cumsum(DLTR1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countDLTR10 <- DLTR1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countDLTR10 <- as.data.frame(countDLTR10)
countDLTR10 <- countDLTR10[,-3]
colnames(countDLTR10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countDLTR10$decrDaysThisCycle <- countDLTR10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countDLTR10b <- countDLTR10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countDLTR10b <- as.data.frame(countDLTR10b)
countDLTR10b <- countDLTR10b[,-3]
colnames(countDLTR10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsDLTRtableDecr <- merge(countDLTR10, countDLTR10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
DLTR3 <- merge(DLTR1, countsDLTRtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
DLTR3 <- DLTR3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
DLTR3$todayLessThanLag7 <- ifelse(DLTR3$today2lag7>1, 0,1)

DLTR3$cumulativeSumTodayLessThanLag7 <- cumsum(DLTR3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countDLTR11 <- DLTR3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countDLTR11 <- as.data.frame(countDLTR11)
countDLTR11 <- countDLTR11[,-3]
colnames(countDLTR11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countDLTR11$incrDaysThisCycle <- countDLTR11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countDLTR11b <- countDLTR11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countDLTR11b <- as.data.frame(countDLTR11b)
countDLTR11b <- countDLTR11b[,-3]
colnames(countDLTR11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsDLTRtableIncr <- merge(countDLTR11, countDLTR11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
DLTR4 <- merge(DLTR3, countsDLTRtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



DLTR5 <- DLTR4[,c(2:16,1,18,17,19)]
DLTR5
```

***


```{r}
EPD1 <- subset(df52, df52$stockName=='EPD')
EPD1 <- EPD1[complete.cases(EPD1),]


#assign a 1 to increasing values
EPD1$todayGrtrThanLag7 <- ifelse(EPD1$today2lag7>1, 1,0)

EPD1$cumulativeSumTodayGrtrThanLag7 <- cumsum(EPD1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countEPD10 <- EPD1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countEPD10 <- as.data.frame(countEPD10)
countEPD10 <- countEPD10[,-3]
colnames(countEPD10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countEPD10$decrDaysThisCycle <- countEPD10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countEPD10b <- countEPD10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countEPD10b <- as.data.frame(countEPD10b)
countEPD10b <- countEPD10b[,-3]
colnames(countEPD10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsEPDtableDecr <- merge(countEPD10, countEPD10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
EPD3 <- merge(EPD1, countsEPDtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
EPD3 <- EPD3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
EPD3$todayLessThanLag7 <- ifelse(EPD3$today2lag7>1, 0,1)

EPD3$cumulativeSumTodayLessThanLag7 <- cumsum(EPD3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countEPD11 <- EPD3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countEPD11 <- as.data.frame(countEPD11)
countEPD11 <- countEPD11[,-3]
colnames(countEPD11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countEPD11$incrDaysThisCycle <- countEPD11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countEPD11b <- countEPD11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countEPD11b <- as.data.frame(countEPD11b)
countEPD11b <- countEPD11b[,-3]
colnames(countEPD11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsEPDtableIncr <- merge(countEPD11, countEPD11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
EPD4 <- merge(EPD3, countsEPDtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



EPD5 <- EPD4[,c(2:16,1,18,17,19)]
EPD5
```

***


```{r}
F1 <- subset(df52, df52$stockName=='F')
F1 <- F1[complete.cases(F1),]


#assign a 1 to increasing values
F1$todayGrtrThanLag7 <- ifelse(F1$today2lag7>1, 1,0)

F1$cumulativeSumTodayGrtrThanLag7 <- cumsum(F1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countF10 <- F1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countF10 <- as.data.frame(countF10)
countF10 <- countF10[,-3]
colnames(countF10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countF10$decrDaysThisCycle <- countF10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countF10b <- countF10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countF10b <- as.data.frame(countF10b)
countF10b <- countF10b[,-3]
colnames(countF10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsFtableDecr <- merge(countF10, countF10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
F3 <- merge(F1, countsFtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
F3 <- F3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
F3$todayLessThanLag7 <- ifelse(F3$today2lag7>1, 0,1)

F3$cumulativeSumTodayLessThanLag7 <- cumsum(F3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countF11 <- F3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countF11 <- as.data.frame(countF11)
countF11 <- countF11[,-3]
colnames(countF11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countF11$incrDaysThisCycle <- countF11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countF11b <- countF11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countF11b <- as.data.frame(countF11b)
countF11b <- countF11b[,-3]
colnames(countF11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsFtableIncr <- merge(countF11, countF11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
F4 <- merge(F3, countsFtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



F5 <- F4[,c(2:16,1,18,17,19)]
F5
```

***


```{r}
FFIN1 <- subset(df52, df52$stockName=='FFIN')
FFIN1 <- FFIN1[complete.cases(FFIN1),]


#assign a 1 to increasing values
FFIN1$todayGrtrThanLag7 <- ifelse(FFIN1$today2lag7>1, 1,0)

FFIN1$cumulativeSumTodayGrtrThanLag7 <- cumsum(FFIN1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countFFIN10 <- FFIN1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countFFIN10 <- as.data.frame(countFFIN10)
countFFIN10 <- countFFIN10[,-3]
colnames(countFFIN10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countFFIN10$decrDaysThisCycle <- countFFIN10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countFFIN10b <- countFFIN10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countFFIN10b <- as.data.frame(countFFIN10b)
countFFIN10b <- countFFIN10b[,-3]
colnames(countFFIN10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsFFINtableDecr <- merge(countFFIN10, countFFIN10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
FFIN3 <- merge(FFIN1, countsFFINtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
FFIN3 <- FFIN3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
FFIN3$todayLessThanLag7 <- ifelse(FFIN3$today2lag7>1, 0,1)

FFIN3$cumulativeSumTodayLessThanLag7 <- cumsum(FFIN3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countFFIN11 <- FFIN3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countFFIN11 <- as.data.frame(countFFIN11)
countFFIN11 <- countFFIN11[,-3]
colnames(countFFIN11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countFFIN11$incrDaysThisCycle <- countFFIN11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countFFIN11b <- countFFIN11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countFFIN11b <- as.data.frame(countFFIN11b)
countFFIN11b <- countFFIN11b[,-3]
colnames(countFFIN11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsFFINtableIncr <- merge(countFFIN11, countFFIN11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
FFIN4 <- merge(FFIN3, countsFFINtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



FFIN5 <- FFIN4[,c(2:16,1,18,17,19)]
FFIN5
```

***


```{r}
FTR1 <- subset(df52, df52$stockName=='FTR')
FTR1 <- FTR1[complete.cases(FTR1),]


#assign a 1 to increasing values
FTR1$todayGrtrThanLag7 <- ifelse(FTR1$today2lag7>1, 1,0)

FTR1$cumulativeSumTodayGrtrThanLag7 <- cumsum(FTR1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countFTR10 <- FTR1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countFTR10 <- as.data.frame(countFTR10)
countFTR10 <- countFTR10[,-3]
colnames(countFTR10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countFTR10$decrDaysThisCycle <- countFTR10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countFTR10b <- countFTR10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countFTR10b <- as.data.frame(countFTR10b)
countFTR10b <- countFTR10b[,-3]
colnames(countFTR10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsFTRtableDecr <- merge(countFTR10, countFTR10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
FTR3 <- merge(FTR1, countsFTRtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
FTR3 <- FTR3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
FTR3$todayLessThanLag7 <- ifelse(FTR3$today2lag7>1, 0,1)

FTR3$cumulativeSumTodayLessThanLag7 <- cumsum(FTR3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countFTR11 <- FTR3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countFTR11 <- as.data.frame(countFTR11)
countFTR11 <- countFTR11[,-3]
colnames(countFTR11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countFTR11$incrDaysThisCycle <- countFTR11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countFTR11b <- countFTR11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countFTR11b <- as.data.frame(countFTR11b)
countFTR11b <- countFTR11b[,-3]
colnames(countFTR11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsFTRtableIncr <- merge(countFTR11, countFTR11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
FTR4 <- merge(FTR3, countsFTRtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



FTR5 <- FTR4[,c(2:16,1,18,17,19)]
FTR5
```

***


```{r}
GOOG1 <- subset(df52, df52$stockName=='GOOG')
GOOG1 <- GOOG1[complete.cases(GOOG1),]


#assign a 1 to increasing values
GOOG1$todayGrtrThanLag7 <- ifelse(GOOG1$today2lag7>1, 1,0)

GOOG1$cumulativeSumTodayGrtrThanLag7 <- cumsum(GOOG1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countGOOG10 <- GOOG1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countGOOG10 <- as.data.frame(countGOOG10)
countGOOG10 <- countGOOG10[,-3]
colnames(countGOOG10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countGOOG10$decrDaysThisCycle <- countGOOG10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countGOOG10b <- countGOOG10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countGOOG10b <- as.data.frame(countGOOG10b)
countGOOG10b <- countGOOG10b[,-3]
colnames(countGOOG10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsGOOGtableDecr <- merge(countGOOG10, countGOOG10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
GOOG3 <- merge(GOOG1, countsGOOGtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
GOOG3 <- GOOG3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
GOOG3$todayLessThanLag7 <- ifelse(GOOG3$today2lag7>1, 0,1)

GOOG3$cumulativeSumTodayLessThanLag7 <- cumsum(GOOG3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countGOOG11 <- GOOG3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countGOOG11 <- as.data.frame(countGOOG11)
countGOOG11 <- countGOOG11[,-3]
colnames(countGOOG11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countGOOG11$incrDaysThisCycle <- countGOOG11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countGOOG11b <- countGOOG11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countGOOG11b <- as.data.frame(countGOOG11b)
countGOOG11b <- countGOOG11b[,-3]
colnames(countGOOG11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsGOOGtableIncr <- merge(countGOOG11, countGOOG11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
GOOG4 <- merge(GOOG3, countsGOOGtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



GOOG5 <- GOOG4[,c(2:16,1,18,17,19)]
GOOG5
```

***


```{r}
HD1 <- subset(df52, df52$stockName=='HD')
HD1 <- HD1[complete.cases(HD1),]


#assign a 1 to increasing values
HD1$todayGrtrThanLag7 <- ifelse(HD1$today2lag7>1, 1,0)

HD1$cumulativeSumTodayGrtrThanLag7 <- cumsum(HD1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countHD10 <- HD1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countHD10 <- as.data.frame(countHD10)
countHD10 <- countHD10[,-3]
colnames(countHD10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countHD10$decrDaysThisCycle <- countHD10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countHD10b <- countHD10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countHD10b <- as.data.frame(countHD10b)
countHD10b <- countHD10b[,-3]
colnames(countHD10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsHDtableDecr <- merge(countHD10, countHD10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
HD3 <- merge(HD1, countsHDtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
HD3 <- HD3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
HD3$todayLessThanLag7 <- ifelse(HD3$today2lag7>1, 0,1)

HD3$cumulativeSumTodayLessThanLag7 <- cumsum(HD3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countHD11 <- HD3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countHD11 <- as.data.frame(countHD11)
countHD11 <- countHD11[,-3]
colnames(countHD11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countHD11$incrDaysThisCycle <- countHD11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countHD11b <- countHD11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countHD11b <- as.data.frame(countHD11b)
countHD11b <- countHD11b[,-3]
colnames(countHD11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsHDtableIncr <- merge(countHD11, countHD11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
HD4 <- merge(HD3, countsHDtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



HD5 <- HD4[,c(2:16,1,18,17,19)]
HD5
```

***


```{r}
HMC1 <- subset(df52, df52$stockName=='HMC')
HMC1 <- HMC1[complete.cases(HMC1),]


#assign a 1 to increasing values
HMC1$todayGrtrThanLag7 <- ifelse(HMC1$today2lag7>1, 1,0)

HMC1$cumulativeSumTodayGrtrThanLag7 <- cumsum(HMC1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countHMC10 <- HMC1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countHMC10 <- as.data.frame(countHMC10)
countHMC10 <- countHMC10[,-3]
colnames(countHMC10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countHMC10$decrDaysThisCycle <- countHMC10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countHMC10b <- countHMC10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countHMC10b <- as.data.frame(countHMC10b)
countHMC10b <- countHMC10b[,-3]
colnames(countHMC10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsHMCtableDecr <- merge(countHMC10, countHMC10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
HMC3 <- merge(HMC1, countsHMCtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
HMC3 <- HMC3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
HMC3$todayLessThanLag7 <- ifelse(HMC3$today2lag7>1, 0,1)

HMC3$cumulativeSumTodayLessThanLag7 <- cumsum(HMC3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countHMC11 <- HMC3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countHMC11 <- as.data.frame(countHMC11)
countHMC11 <- countHMC11[,-3]
colnames(countHMC11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countHMC11$incrDaysThisCycle <- countHMC11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countHMC11b <- countHMC11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countHMC11b <- as.data.frame(countHMC11b)
countHMC11b <- countHMC11b[,-3]
colnames(countHMC11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsHMCtableIncr <- merge(countHMC11, countHMC11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
HMC4 <- merge(HMC3, countsHMCtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



HMC5 <- HMC4[,c(2:16,1,18,17,19)]
HMC5
```

***


```{r}
HOFT1 <- subset(df52, df52$stockName=='HOFT')
HOFT1 <- HOFT1[complete.cases(HOFT1),]


#assign a 1 to increasing values
HOFT1$todayGrtrThanLag7 <- ifelse(HOFT1$today2lag7>1, 1,0)

HOFT1$cumulativeSumTodayGrtrThanLag7 <- cumsum(HOFT1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countHOFT10 <- HOFT1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countHOFT10 <- as.data.frame(countHOFT10)
countHOFT10 <- countHOFT10[,-3]
colnames(countHOFT10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countHOFT10$decrDaysThisCycle <- countHOFT10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countHOFT10b <- countHOFT10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countHOFT10b <- as.data.frame(countHOFT10b)
countHOFT10b <- countHOFT10b[,-3]
colnames(countHOFT10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsHOFTtableDecr <- merge(countHOFT10, countHOFT10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
HOFT3 <- merge(HOFT1, countsHOFTtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
HOFT3 <- HOFT3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
HOFT3$todayLessThanLag7 <- ifelse(HOFT3$today2lag7>1, 0,1)

HOFT3$cumulativeSumTodayLessThanLag7 <- cumsum(HOFT3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countHOFT11 <- HOFT3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countHOFT11 <- as.data.frame(countHOFT11)
countHOFT11 <- countHOFT11[,-3]
colnames(countHOFT11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countHOFT11$incrDaysThisCycle <- countHOFT11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countHOFT11b <- countHOFT11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countHOFT11b <- as.data.frame(countHOFT11b)
countHOFT11b <- countHOFT11b[,-3]
colnames(countHOFT11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsHOFTtableIncr <- merge(countHOFT11, countHOFT11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
HOFT4 <- merge(HOFT3, countsHOFTtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



HOFT5 <- HOFT4[,c(2:16,1,18,17,19)]
HOFT5
```

***


```{r}
HRB1 <- subset(df52, df52$stockName=='HRB')
HRB1 <- HRB1[complete.cases(HRB1),]


#assign a 1 to increasing values
HRB1$todayGrtrThanLag7 <- ifelse(HRB1$today2lag7>1, 1,0)

HRB1$cumulativeSumTodayGrtrThanLag7 <- cumsum(HRB1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countHRB10 <- HRB1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countHRB10 <- as.data.frame(countHRB10)
countHRB10 <- countHRB10[,-3]
colnames(countHRB10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countHRB10$decrDaysThisCycle <- countHRB10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countHRB10b <- countHRB10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countHRB10b <- as.data.frame(countHRB10b)
countHRB10b <- countHRB10b[,-3]
colnames(countHRB10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsHRBtableDecr <- merge(countHRB10, countHRB10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
HRB3 <- merge(HRB1, countsHRBtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
HRB3 <- HRB3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
HRB3$todayLessThanLag7 <- ifelse(HRB3$today2lag7>1, 0,1)

HRB3$cumulativeSumTodayLessThanLag7 <- cumsum(HRB3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countHRB11 <- HRB3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countHRB11 <- as.data.frame(countHRB11)
countHRB11 <- countHRB11[,-3]
colnames(countHRB11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countHRB11$incrDaysThisCycle <- countHRB11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countHRB11b <- countHRB11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countHRB11b <- as.data.frame(countHRB11b)
countHRB11b <- countHRB11b[,-3]
colnames(countHRB11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsHRBtableIncr <- merge(countHRB11, countHRB11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
HRB4 <- merge(HRB3, countsHRBtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



HRB5 <- HRB4[,c(2:16,1,18,17,19)]
HRB5
```

***


```{r}
HST1 <- subset(df52, df52$stockName=='HST')
HST1 <- HST1[complete.cases(HST1),]


#assign a 1 to increasing values
HST1$todayGrtrThanLag7 <- ifelse(HST1$today2lag7>1, 1,0)

HST1$cumulativeSumTodayGrtrThanLag7 <- cumsum(HST1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countHST10 <- HST1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countHST10 <- as.data.frame(countHST10)
countHST10 <- countHST10[,-3]
colnames(countHST10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countHST10$decrDaysThisCycle <- countHST10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countHST10b <- countHST10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countHST10b <- as.data.frame(countHST10b)
countHST10b <- countHST10b[,-3]
colnames(countHST10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsHSTtableDecr <- merge(countHST10, countHST10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
HST3 <- merge(HST1, countsHSTtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
HST3 <- HST3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
HST3$todayLessThanLag7 <- ifelse(HST3$today2lag7>1, 0,1)

HST3$cumulativeSumTodayLessThanLag7 <- cumsum(HST3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countHST11 <- HST3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countHST11 <- as.data.frame(countHST11)
countHST11 <- countHST11[,-3]
colnames(countHST11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countHST11$incrDaysThisCycle <- countHST11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countHST11b <- countHST11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countHST11b <- as.data.frame(countHST11b)
countHST11b <- countHST11b[,-3]
colnames(countHST11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsHSTtableIncr <- merge(countHST11, countHST11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
HST4 <- merge(HST3, countsHSTtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



HST5 <- HST4[,c(2:16,1,18,17,19)]
HST5
```

***


```{r}
INO1 <- subset(df52, df52$stockName=='INO')
INO1 <- INO1[complete.cases(INO1),]


#assign a 1 to increasing values
INO1$todayGrtrThanLag7 <- ifelse(INO1$today2lag7>1, 1,0)

INO1$cumulativeSumTodayGrtrThanLag7 <- cumsum(INO1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countINO10 <- INO1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countINO10 <- as.data.frame(countINO10)
countINO10 <- countINO10[,-3]
colnames(countINO10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countINO10$decrDaysThisCycle <- countINO10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countINO10b <- countINO10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countINO10b <- as.data.frame(countINO10b)
countINO10b <- countINO10b[,-3]
colnames(countINO10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsINOtableDecr <- merge(countINO10, countINO10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
INO3 <- merge(INO1, countsINOtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
INO3 <- INO3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
INO3$todayLessThanLag7 <- ifelse(INO3$today2lag7>1, 0,1)

INO3$cumulativeSumTodayLessThanLag7 <- cumsum(INO3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countINO11 <- INO3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countINO11 <- as.data.frame(countINO11)
countINO11 <- countINO11[,-3]
colnames(countINO11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countINO11$incrDaysThisCycle <- countINO11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countINO11b <- countINO11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countINO11b <- as.data.frame(countINO11b)
countINO11b <- countINO11b[,-3]
colnames(countINO11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsINOtableIncr <- merge(countINO11, countINO11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
INO4 <- merge(INO3, countsINOtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



INO5 <- INO4[,c(2:16,1,18,17,19)]
INO5
```

***


```{r}
JBLU1 <- subset(df52, df52$stockName=='JBLU')
JBLU1 <- JBLU1[complete.cases(JBLU1),]


#assign a 1 to increasing values
JBLU1$todayGrtrThanLag7 <- ifelse(JBLU1$today2lag7>1, 1,0)

JBLU1$cumulativeSumTodayGrtrThanLag7 <- cumsum(JBLU1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countJBLU10 <- JBLU1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countJBLU10 <- as.data.frame(countJBLU10)
countJBLU10 <- countJBLU10[,-3]
colnames(countJBLU10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countJBLU10$decrDaysThisCycle <- countJBLU10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countJBLU10b <- countJBLU10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countJBLU10b <- as.data.frame(countJBLU10b)
countJBLU10b <- countJBLU10b[,-3]
colnames(countJBLU10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsJBLUtableDecr <- merge(countJBLU10, countJBLU10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
JBLU3 <- merge(JBLU1, countsJBLUtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
JBLU3 <- JBLU3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
JBLU3$todayLessThanLag7 <- ifelse(JBLU3$today2lag7>1, 0,1)

JBLU3$cumulativeSumTodayLessThanLag7 <- cumsum(JBLU3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countJBLU11 <- JBLU3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countJBLU11 <- as.data.frame(countJBLU11)
countJBLU11 <- countJBLU11[,-3]
colnames(countJBLU11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countJBLU11$incrDaysThisCycle <- countJBLU11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countJBLU11b <- countJBLU11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countJBLU11b <- as.data.frame(countJBLU11b)
countJBLU11b <- countJBLU11b[,-3]
colnames(countJBLU11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsJBLUtableIncr <- merge(countJBLU11, countJBLU11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
JBLU4 <- merge(JBLU3, countsJBLUtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



JBLU5 <- JBLU4[,c(2:16,1,18,17,19)]
JBLU5
```

***


```{r}
JNJ1 <- subset(df52, df52$stockName=='JNJ')
JNJ1 <- JNJ1[complete.cases(JNJ1),]


#assign a 1 to increasing values
JNJ1$todayGrtrThanLag7 <- ifelse(JNJ1$today2lag7>1, 1,0)

JNJ1$cumulativeSumTodayGrtrThanLag7 <- cumsum(JNJ1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countJNJ10 <- JNJ1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countJNJ10 <- as.data.frame(countJNJ10)
countJNJ10 <- countJNJ10[,-3]
colnames(countJNJ10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countJNJ10$decrDaysThisCycle <- countJNJ10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countJNJ10b <- countJNJ10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countJNJ10b <- as.data.frame(countJNJ10b)
countJNJ10b <- countJNJ10b[,-3]
colnames(countJNJ10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsJNJtableDecr <- merge(countJNJ10, countJNJ10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
JNJ3 <- merge(JNJ1, countsJNJtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
JNJ3 <- JNJ3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
JNJ3$todayLessThanLag7 <- ifelse(JNJ3$today2lag7>1, 0,1)

JNJ3$cumulativeSumTodayLessThanLag7 <- cumsum(JNJ3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countJNJ11 <- JNJ3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countJNJ11 <- as.data.frame(countJNJ11)
countJNJ11 <- countJNJ11[,-3]
colnames(countJNJ11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countJNJ11$incrDaysThisCycle <- countJNJ11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countJNJ11b <- countJNJ11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countJNJ11b <- as.data.frame(countJNJ11b)
countJNJ11b <- countJNJ11b[,-3]
colnames(countJNJ11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsJNJtableIncr <- merge(countJNJ11, countJNJ11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
JNJ4 <- merge(JNJ3, countsJNJtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



JNJ5 <- JNJ4[,c(2:16,1,18,17,19)]
JNJ5
```

***


```{r}
JPM1 <- subset(df52, df52$stockName=='JPM')
JPM1 <- JPM1[complete.cases(JPM1),]


#assign a 1 to increasing values
JPM1$todayGrtrThanLag7 <- ifelse(JPM1$today2lag7>1, 1,0)

JPM1$cumulativeSumTodayGrtrThanLag7 <- cumsum(JPM1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countJPM10 <- JPM1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countJPM10 <- as.data.frame(countJPM10)
countJPM10 <- countJPM10[,-3]
colnames(countJPM10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countJPM10$decrDaysThisCycle <- countJPM10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countJPM10b <- countJPM10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countJPM10b <- as.data.frame(countJPM10b)
countJPM10b <- countJPM10b[,-3]
colnames(countJPM10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsJPMtableDecr <- merge(countJPM10, countJPM10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
JPM3 <- merge(JPM1, countsJPMtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
JPM3 <- JPM3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
JPM3$todayLessThanLag7 <- ifelse(JPM3$today2lag7>1, 0,1)

JPM3$cumulativeSumTodayLessThanLag7 <- cumsum(JPM3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countJPM11 <- JPM3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countJPM11 <- as.data.frame(countJPM11)
countJPM11 <- countJPM11[,-3]
colnames(countJPM11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countJPM11$incrDaysThisCycle <- countJPM11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countJPM11b <- countJPM11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countJPM11b <- as.data.frame(countJPM11b)
countJPM11b <- countJPM11b[,-3]
colnames(countJPM11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsJPMtableIncr <- merge(countJPM11, countJPM11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
JPM4 <- merge(JPM3, countsJPMtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



JPM5 <- JPM4[,c(2:16,1,18,17,19)]
JPM5
```

***


```{r}
JWN1 <- subset(df52, df52$stockName=='JWN')
JWN1 <- JWN1[complete.cases(JWN1),]


#assign a 1 to increasing values
JWN1$todayGrtrThanLag7 <- ifelse(JWN1$today2lag7>1, 1,0)

JWN1$cumulativeSumTodayGrtrThanLag7 <- cumsum(JWN1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countJWN10 <- JWN1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countJWN10 <- as.data.frame(countJWN10)
countJWN10 <- countJWN10[,-3]
colnames(countJWN10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countJWN10$decrDaysThisCycle <- countJWN10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countJWN10b <- countJWN10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countJWN10b <- as.data.frame(countJWN10b)
countJWN10b <- countJWN10b[,-3]
colnames(countJWN10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsJWNtableDecr <- merge(countJWN10, countJWN10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
JWN3 <- merge(JWN1, countsJWNtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
JWN3 <- JWN3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
JWN3$todayLessThanLag7 <- ifelse(JWN3$today2lag7>1, 0,1)

JWN3$cumulativeSumTodayLessThanLag7 <- cumsum(JWN3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countJWN11 <- JWN3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countJWN11 <- as.data.frame(countJWN11)
countJWN11 <- countJWN11[,-3]
colnames(countJWN11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countJWN11$incrDaysThisCycle <- countJWN11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countJWN11b <- countJWN11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countJWN11b <- as.data.frame(countJWN11b)
countJWN11b <- countJWN11b[,-3]
colnames(countJWN11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsJWNtableIncr <- merge(countJWN11, countJWN11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
JWN4 <- merge(JWN3, countsJWNtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



JWN5 <- JWN4[,c(2:16,1,18,17,19)]
JWN5
```

***


```{r}
KGJI1 <- subset(df52, df52$stockName=='KGJI')
KGJI1 <- KGJI1[complete.cases(KGJI1),]


#assign a 1 to increasing values
KGJI1$todayGrtrThanLag7 <- ifelse(KGJI1$today2lag7>1, 1,0)

KGJI1$cumulativeSumTodayGrtrThanLag7 <- cumsum(KGJI1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countKGJI10 <- KGJI1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countKGJI10 <- as.data.frame(countKGJI10)
countKGJI10 <- countKGJI10[,-3]
colnames(countKGJI10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countKGJI10$decrDaysThisCycle <- countKGJI10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countKGJI10b <- countKGJI10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countKGJI10b <- as.data.frame(countKGJI10b)
countKGJI10b <- countKGJI10b[,-3]
colnames(countKGJI10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsKGJItableDecr <- merge(countKGJI10, countKGJI10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
KGJI3 <- merge(KGJI1, countsKGJItableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
KGJI3 <- KGJI3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
KGJI3$todayLessThanLag7 <- ifelse(KGJI3$today2lag7>1, 0,1)

KGJI3$cumulativeSumTodayLessThanLag7 <- cumsum(KGJI3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countKGJI11 <- KGJI3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countKGJI11 <- as.data.frame(countKGJI11)
countKGJI11 <- countKGJI11[,-3]
colnames(countKGJI11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countKGJI11$incrDaysThisCycle <- countKGJI11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countKGJI11b <- countKGJI11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countKGJI11b <- as.data.frame(countKGJI11b)
countKGJI11b <- countKGJI11b[,-3]
colnames(countKGJI11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsKGJItableIncr <- merge(countKGJI11, countKGJI11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
KGJI4 <- merge(KGJI3, countsKGJItableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



KGJI5 <- KGJI4[,c(2:16,1,18,17,19)]
KGJI5
```

***


```{r}
KSS1 <- subset(df52, df52$stockName=='KSS')
KSS1 <- KSS1[complete.cases(KSS1),]


#assign a 1 to increasing values
KSS1$todayGrtrThanLag7 <- ifelse(KSS1$today2lag7>1, 1,0)

KSS1$cumulativeSumTodayGrtrThanLag7 <- cumsum(KSS1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countKSS10 <- KSS1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countKSS10 <- as.data.frame(countKSS10)
countKSS10 <- countKSS10[,-3]
colnames(countKSS10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countKSS10$decrDaysThisCycle <- countKSS10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countKSS10b <- countKSS10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countKSS10b <- as.data.frame(countKSS10b)
countKSS10b <- countKSS10b[,-3]
colnames(countKSS10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsKSStableDecr <- merge(countKSS10, countKSS10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
KSS3 <- merge(KSS1, countsKSStableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
KSS3 <- KSS3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
KSS3$todayLessThanLag7 <- ifelse(KSS3$today2lag7>1, 0,1)

KSS3$cumulativeSumTodayLessThanLag7 <- cumsum(KSS3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countKSS11 <- KSS3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countKSS11 <- as.data.frame(countKSS11)
countKSS11 <- countKSS11[,-3]
colnames(countKSS11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countKSS11$incrDaysThisCycle <- countKSS11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countKSS11b <- countKSS11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countKSS11b <- as.data.frame(countKSS11b)
countKSS11b <- countKSS11b[,-3]
colnames(countKSS11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsKSStableIncr <- merge(countKSS11, countKSS11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
KSS4 <- merge(KSS3, countsKSStableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



KSS5 <- KSS4[,c(2:16,1,18,17,19)]
KSS5
```

***


```{r}
LUV1 <- subset(df52, df52$stockName=='LUV')
LUV1 <- LUV1[complete.cases(LUV1),]


#assign a 1 to increasing values
LUV1$todayGrtrThanLag7 <- ifelse(LUV1$today2lag7>1, 1,0)

LUV1$cumulativeSumTodayGrtrThanLag7 <- cumsum(LUV1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countLUV10 <- LUV1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countLUV10 <- as.data.frame(countLUV10)
countLUV10 <- countLUV10[,-3]
colnames(countLUV10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countLUV10$decrDaysThisCycle <- countLUV10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countLUV10b <- countLUV10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countLUV10b <- as.data.frame(countLUV10b)
countLUV10b <- countLUV10b[,-3]
colnames(countLUV10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsLUVtableDecr <- merge(countLUV10, countLUV10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
LUV3 <- merge(LUV1, countsLUVtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
LUV3 <- LUV3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
LUV3$todayLessThanLag7 <- ifelse(LUV3$today2lag7>1, 0,1)

LUV3$cumulativeSumTodayLessThanLag7 <- cumsum(LUV3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countLUV11 <- LUV3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countLUV11 <- as.data.frame(countLUV11)
countLUV11 <- countLUV11[,-3]
colnames(countLUV11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countLUV11$incrDaysThisCycle <- countLUV11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countLUV11b <- countLUV11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countLUV11b <- as.data.frame(countLUV11b)
countLUV11b <- countLUV11b[,-3]
colnames(countLUV11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsLUVtableIncr <- merge(countLUV11, countLUV11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
LUV4 <- merge(LUV3, countsLUVtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



LUV5 <- LUV4[,c(2:16,1,18,17,19)]
LUV5
```

***


```{r}
M1 <- subset(df52, df52$stockName=='M')
M1 <- M1[complete.cases(M1),]


#assign a 1 to increasing values
M1$todayGrtrThanLag7 <- ifelse(M1$today2lag7>1, 1,0)

M1$cumulativeSumTodayGrtrThanLag7 <- cumsum(M1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countM10 <- M1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countM10 <- as.data.frame(countM10)
countM10 <- countM10[,-3]
colnames(countM10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countM10$decrDaysThisCycle <- countM10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countM10b <- countM10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countM10b <- as.data.frame(countM10b)
countM10b <- countM10b[,-3]
colnames(countM10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsMtableDecr <- merge(countM10, countM10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
M3 <- merge(M1, countsMtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
M3 <- M3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
M3$todayLessThanLag7 <- ifelse(M3$today2lag7>1, 0,1)

M3$cumulativeSumTodayLessThanLag7 <- cumsum(M3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countM11 <- M3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countM11 <- as.data.frame(countM11)
countM11 <- countM11[,-3]
colnames(countM11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countM11$incrDaysThisCycle <- countM11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countM11b <- countM11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countM11b <- as.data.frame(countM11b)
countM11b <- countM11b[,-3]
colnames(countM11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsMtableIncr <- merge(countM11, countM11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
M4 <- merge(M3, countsMtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



M5 <- M4[,c(2:16,1,18,17,19)]
M5
```

***


```{r}
MGM1 <- subset(df52, df52$stockName=='MGM')
MGM1 <- MGM1[complete.cases(MGM1),]


#assign a 1 to increasing values
MGM1$todayGrtrThanLag7 <- ifelse(MGM1$today2lag7>1, 1,0)

MGM1$cumulativeSumTodayGrtrThanLag7 <- cumsum(MGM1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countMGM10 <- MGM1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countMGM10 <- as.data.frame(countMGM10)
countMGM10 <- countMGM10[,-3]
colnames(countMGM10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countMGM10$decrDaysThisCycle <- countMGM10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countMGM10b <- countMGM10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countMGM10b <- as.data.frame(countMGM10b)
countMGM10b <- countMGM10b[,-3]
colnames(countMGM10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsMGMtableDecr <- merge(countMGM10, countMGM10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
MGM3 <- merge(MGM1, countsMGMtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
MGM3 <- MGM3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
MGM3$todayLessThanLag7 <- ifelse(MGM3$today2lag7>1, 0,1)

MGM3$cumulativeSumTodayLessThanLag7 <- cumsum(MGM3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countMGM11 <- MGM3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countMGM11 <- as.data.frame(countMGM11)
countMGM11 <- countMGM11[,-3]
colnames(countMGM11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countMGM11$incrDaysThisCycle <- countMGM11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countMGM11b <- countMGM11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countMGM11b <- as.data.frame(countMGM11b)
countMGM11b <- countMGM11b[,-3]
colnames(countMGM11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsMGMtableIncr <- merge(countMGM11, countMGM11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
MGM4 <- merge(MGM3, countsMGMtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



MGM5 <- MGM4[,c(2:16,1,18,17,19)]
MGM5
```

***


```{r}
MSFT1 <- subset(df52, df52$stockName=='MSFT')
MSFT1 <- MSFT1[complete.cases(MSFT1),]


#assign a 1 to increasing values
MSFT1$todayGrtrThanLag7 <- ifelse(MSFT1$today2lag7>1, 1,0)

MSFT1$cumulativeSumTodayGrtrThanLag7 <- cumsum(MSFT1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countMSFT10 <- MSFT1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countMSFT10 <- as.data.frame(countMSFT10)
countMSFT10 <- countMSFT10[,-3]
colnames(countMSFT10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countMSFT10$decrDaysThisCycle <- countMSFT10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countMSFT10b <- countMSFT10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countMSFT10b <- as.data.frame(countMSFT10b)
countMSFT10b <- countMSFT10b[,-3]
colnames(countMSFT10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsMSFTtableDecr <- merge(countMSFT10, countMSFT10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
MSFT3 <- merge(MSFT1, countsMSFTtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
MSFT3 <- MSFT3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
MSFT3$todayLessThanLag7 <- ifelse(MSFT3$today2lag7>1, 0,1)

MSFT3$cumulativeSumTodayLessThanLag7 <- cumsum(MSFT3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countMSFT11 <- MSFT3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countMSFT11 <- as.data.frame(countMSFT11)
countMSFT11 <- countMSFT11[,-3]
colnames(countMSFT11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countMSFT11$incrDaysThisCycle <- countMSFT11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countMSFT11b <- countMSFT11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countMSFT11b <- as.data.frame(countMSFT11b)
countMSFT11b <- countMSFT11b[,-3]
colnames(countMSFT11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsMSFTtableIncr <- merge(countMSFT11, countMSFT11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
MSFT4 <- merge(MSFT3, countsMSFTtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



MSFT5 <- MSFT4[,c(2:16,1,18,17,19)]
MSFT5
```

***


```{r}
NFLX1 <- subset(df52, df52$stockName=='NFLX')
NFLX1 <- NFLX1[complete.cases(NFLX1),]


#assign a 1 to increasing values
NFLX1$todayGrtrThanLag7 <- ifelse(NFLX1$today2lag7>1, 1,0)

NFLX1$cumulativeSumTodayGrtrThanLag7 <- cumsum(NFLX1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countNFLX10 <- NFLX1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countNFLX10 <- as.data.frame(countNFLX10)
countNFLX10 <- countNFLX10[,-3]
colnames(countNFLX10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countNFLX10$decrDaysThisCycle <- countNFLX10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countNFLX10b <- countNFLX10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countNFLX10b <- as.data.frame(countNFLX10b)
countNFLX10b <- countNFLX10b[,-3]
colnames(countNFLX10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsNFLXtableDecr <- merge(countNFLX10, countNFLX10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
NFLX3 <- merge(NFLX1, countsNFLXtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
NFLX3 <- NFLX3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
NFLX3$todayLessThanLag7 <- ifelse(NFLX3$today2lag7>1, 0,1)

NFLX3$cumulativeSumTodayLessThanLag7 <- cumsum(NFLX3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countNFLX11 <- NFLX3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countNFLX11 <- as.data.frame(countNFLX11)
countNFLX11 <- countNFLX11[,-3]
colnames(countNFLX11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countNFLX11$incrDaysThisCycle <- countNFLX11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countNFLX11b <- countNFLX11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countNFLX11b <- as.data.frame(countNFLX11b)
countNFLX11b <- countNFLX11b[,-3]
colnames(countNFLX11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsNFLXtableIncr <- merge(countNFLX11, countNFLX11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
NFLX4 <- merge(NFLX3, countsNFLXtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



NFLX5 <- NFLX4[,c(2:16,1,18,17,19)]
NFLX5
```

***


```{r}
NKE1 <- subset(df52, df52$stockName=='NKE')
NKE1 <- NKE1[complete.cases(NKE1),]


#assign a 1 to increasing values
NKE1$todayGrtrThanLag7 <- ifelse(NKE1$today2lag7>1, 1,0)

NKE1$cumulativeSumTodayGrtrThanLag7 <- cumsum(NKE1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countNKE10 <- NKE1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countNKE10 <- as.data.frame(countNKE10)
countNKE10 <- countNKE10[,-3]
colnames(countNKE10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countNKE10$decrDaysThisCycle <- countNKE10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countNKE10b <- countNKE10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countNKE10b <- as.data.frame(countNKE10b)
countNKE10b <- countNKE10b[,-3]
colnames(countNKE10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsNKEtableDecr <- merge(countNKE10, countNKE10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
NKE3 <- merge(NKE1, countsNKEtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
NKE3 <- NKE3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
NKE3$todayLessThanLag7 <- ifelse(NKE3$today2lag7>1, 0,1)

NKE3$cumulativeSumTodayLessThanLag7 <- cumsum(NKE3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countNKE11 <- NKE3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countNKE11 <- as.data.frame(countNKE11)
countNKE11 <- countNKE11[,-3]
colnames(countNKE11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countNKE11$incrDaysThisCycle <- countNKE11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countNKE11b <- countNKE11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countNKE11b <- as.data.frame(countNKE11b)
countNKE11b <- countNKE11b[,-3]
colnames(countNKE11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsNKEtableIncr <- merge(countNKE11, countNKE11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
NKE4 <- merge(NKE3, countsNKEtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



NKE5 <- NKE4[,c(2:16,1,18,17,19)]
NKE5
```

***


```{r}
NSANY1 <- subset(df52, df52$stockName=='NSANY')
NSANY1 <- NSANY1[complete.cases(NSANY1),]


#assign a 1 to increasing values
NSANY1$todayGrtrThanLag7 <- ifelse(NSANY1$today2lag7>1, 1,0)

NSANY1$cumulativeSumTodayGrtrThanLag7 <- cumsum(NSANY1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countNSANY10 <- NSANY1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countNSANY10 <- as.data.frame(countNSANY10)
countNSANY10 <- countNSANY10[,-3]
colnames(countNSANY10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countNSANY10$decrDaysThisCycle <- countNSANY10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countNSANY10b <- countNSANY10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countNSANY10b <- as.data.frame(countNSANY10b)
countNSANY10b <- countNSANY10b[,-3]
colnames(countNSANY10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsNSANYtableDecr <- merge(countNSANY10, countNSANY10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
NSANY3 <- merge(NSANY1, countsNSANYtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
NSANY3 <- NSANY3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
NSANY3$todayLessThanLag7 <- ifelse(NSANY3$today2lag7>1, 0,1)

NSANY3$cumulativeSumTodayLessThanLag7 <- cumsum(NSANY3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countNSANY11 <- NSANY3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countNSANY11 <- as.data.frame(countNSANY11)
countNSANY11 <- countNSANY11[,-3]
colnames(countNSANY11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countNSANY11$incrDaysThisCycle <- countNSANY11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countNSANY11b <- countNSANY11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countNSANY11b <- as.data.frame(countNSANY11b)
countNSANY11b <- countNSANY11b[,-3]
colnames(countNSANY11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsNSANYtableIncr <- merge(countNSANY11, countNSANY11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
NSANY4 <- merge(NSANY3, countsNSANYtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



NSANY5 <- NSANY4[,c(2:16,1,18,17,19)]
NSANY5
```

***


```{r}
NUS1 <- subset(df52, df52$stockName=='NUS')
NUS1 <- NUS1[complete.cases(NUS1),]


#assign a 1 to increasing values
NUS1$todayGrtrThanLag7 <- ifelse(NUS1$today2lag7>1, 1,0)

NUS1$cumulativeSumTodayGrtrThanLag7 <- cumsum(NUS1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countNUS10 <- NUS1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countNUS10 <- as.data.frame(countNUS10)
countNUS10 <- countNUS10[,-3]
colnames(countNUS10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countNUS10$decrDaysThisCycle <- countNUS10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countNUS10b <- countNUS10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countNUS10b <- as.data.frame(countNUS10b)
countNUS10b <- countNUS10b[,-3]
colnames(countNUS10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsNUStableDecr <- merge(countNUS10, countNUS10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
NUS3 <- merge(NUS1, countsNUStableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
NUS3 <- NUS3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
NUS3$todayLessThanLag7 <- ifelse(NUS3$today2lag7>1, 0,1)

NUS3$cumulativeSumTodayLessThanLag7 <- cumsum(NUS3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countNUS11 <- NUS3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countNUS11 <- as.data.frame(countNUS11)
countNUS11 <- countNUS11[,-3]
colnames(countNUS11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countNUS11$incrDaysThisCycle <- countNUS11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countNUS11b <- countNUS11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countNUS11b <- as.data.frame(countNUS11b)
countNUS11b <- countNUS11b[,-3]
colnames(countNUS11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsNUStableIncr <- merge(countNUS11, countNUS11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
NUS4 <- merge(NUS3, countsNUStableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



NUS5 <- NUS4[,c(2:16,1,18,17,19)]
NUS5
```

***


```{r}
ONCY1 <- subset(df52, df52$stockName=='ONCY')
ONCY1 <- ONCY1[complete.cases(ONCY1),]


#assign a 1 to increasing values
ONCY1$todayGrtrThanLag7 <- ifelse(ONCY1$today2lag7>1, 1,0)

ONCY1$cumulativeSumTodayGrtrThanLag7 <- cumsum(ONCY1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countONCY10 <- ONCY1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countONCY10 <- as.data.frame(countONCY10)
countONCY10 <- countONCY10[,-3]
colnames(countONCY10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countONCY10$decrDaysThisCycle <- countONCY10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countONCY10b <- countONCY10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countONCY10b <- as.data.frame(countONCY10b)
countONCY10b <- countONCY10b[,-3]
colnames(countONCY10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsONCYtableDecr <- merge(countONCY10, countONCY10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
ONCY3 <- merge(ONCY1, countsONCYtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
ONCY3 <- ONCY3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
ONCY3$todayLessThanLag7 <- ifelse(ONCY3$today2lag7>1, 0,1)

ONCY3$cumulativeSumTodayLessThanLag7 <- cumsum(ONCY3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countONCY11 <- ONCY3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countONCY11 <- as.data.frame(countONCY11)
countONCY11 <- countONCY11[,-3]
colnames(countONCY11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countONCY11$incrDaysThisCycle <- countONCY11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countONCY11b <- countONCY11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countONCY11b <- as.data.frame(countONCY11b)
countONCY11b <- countONCY11b[,-3]
colnames(countONCY11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsONCYtableIncr <- merge(countONCY11, countONCY11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
ONCY4 <- merge(ONCY3, countsONCYtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



ONCY5 <- ONCY4[,c(2:16,1,18,17,19)]
ONCY5
```

***


```{r}
PCG1 <- subset(df52, df52$stockName=='PCG')
PCG1 <- PCG1[complete.cases(PCG1),]


#assign a 1 to increasing values
PCG1$todayGrtrThanLag7 <- ifelse(PCG1$today2lag7>1, 1,0)

PCG1$cumulativeSumTodayGrtrThanLag7 <- cumsum(PCG1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countPCG10 <- PCG1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countPCG10 <- as.data.frame(countPCG10)
countPCG10 <- countPCG10[,-3]
colnames(countPCG10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countPCG10$decrDaysThisCycle <- countPCG10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countPCG10b <- countPCG10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countPCG10b <- as.data.frame(countPCG10b)
countPCG10b <- countPCG10b[,-3]
colnames(countPCG10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsPCGtableDecr <- merge(countPCG10, countPCG10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
PCG3 <- merge(PCG1, countsPCGtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
PCG3 <- PCG3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
PCG3$todayLessThanLag7 <- ifelse(PCG3$today2lag7>1, 0,1)

PCG3$cumulativeSumTodayLessThanLag7 <- cumsum(PCG3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countPCG11 <- PCG3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countPCG11 <- as.data.frame(countPCG11)
countPCG11 <- countPCG11[,-3]
colnames(countPCG11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countPCG11$incrDaysThisCycle <- countPCG11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countPCG11b <- countPCG11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countPCG11b <- as.data.frame(countPCG11b)
countPCG11b <- countPCG11b[,-3]
colnames(countPCG11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsPCGtableIncr <- merge(countPCG11, countPCG11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
PCG4 <- merge(PCG3, countsPCGtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



PCG5 <- PCG4[,c(2:16,1,18,17,19)]
PCG5
```

***


```{r}
ROST1 <- subset(df52, df52$stockName=='ROST')
ROST1 <- ROST1[complete.cases(ROST1),]


#assign a 1 to increasing values
ROST1$todayGrtrThanLag7 <- ifelse(ROST1$today2lag7>1, 1,0)

ROST1$cumulativeSumTodayGrtrThanLag7 <- cumsum(ROST1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countROST10 <- ROST1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countROST10 <- as.data.frame(countROST10)
countROST10 <- countROST10[,-3]
colnames(countROST10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countROST10$decrDaysThisCycle <- countROST10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countROST10b <- countROST10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countROST10b <- as.data.frame(countROST10b)
countROST10b <- countROST10b[,-3]
colnames(countROST10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsROSTtableDecr <- merge(countROST10, countROST10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
ROST3 <- merge(ROST1, countsROSTtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
ROST3 <- ROST3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
ROST3$todayLessThanLag7 <- ifelse(ROST3$today2lag7>1, 0,1)

ROST3$cumulativeSumTodayLessThanLag7 <- cumsum(ROST3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countROST11 <- ROST3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countROST11 <- as.data.frame(countROST11)
countROST11 <- countROST11[,-3]
colnames(countROST11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countROST11$incrDaysThisCycle <- countROST11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countROST11b <- countROST11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countROST11b <- as.data.frame(countROST11b)
countROST11b <- countROST11b[,-3]
colnames(countROST11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsROSTtableIncr <- merge(countROST11, countROST11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
ROST4 <- merge(ROST3, countsROSTtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



ROST5 <- ROST4[,c(2:16,1,18,17,19)]
ROST5
```

***


```{r}
RRGB1 <- subset(df52, df52$stockName=='RRGB')
RRGB1 <- RRGB1[complete.cases(RRGB1),]


#assign a 1 to increasing values
RRGB1$todayGrtrThanLag7 <- ifelse(RRGB1$today2lag7>1, 1,0)

RRGB1$cumulativeSumTodayGrtrThanLag7 <- cumsum(RRGB1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countRRGB10 <- RRGB1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countRRGB10 <- as.data.frame(countRRGB10)
countRRGB10 <- countRRGB10[,-3]
colnames(countRRGB10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countRRGB10$decrDaysThisCycle <- countRRGB10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countRRGB10b <- countRRGB10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countRRGB10b <- as.data.frame(countRRGB10b)
countRRGB10b <- countRRGB10b[,-3]
colnames(countRRGB10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsRRGBtableDecr <- merge(countRRGB10, countRRGB10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
RRGB3 <- merge(RRGB1, countsRRGBtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
RRGB3 <- RRGB3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
RRGB3$todayLessThanLag7 <- ifelse(RRGB3$today2lag7>1, 0,1)

RRGB3$cumulativeSumTodayLessThanLag7 <- cumsum(RRGB3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countRRGB11 <- RRGB3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countRRGB11 <- as.data.frame(countRRGB11)
countRRGB11 <- countRRGB11[,-3]
colnames(countRRGB11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countRRGB11$incrDaysThisCycle <- countRRGB11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countRRGB11b <- countRRGB11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countRRGB11b <- as.data.frame(countRRGB11b)
countRRGB11b <- countRRGB11b[,-3]
colnames(countRRGB11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsRRGBtableIncr <- merge(countRRGB11, countRRGB11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
RRGB4 <- merge(RRGB3, countsRRGBtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



RRGB5 <- RRGB4[,c(2:16,1,18,17,19)]
RRGB5
```

***


```{r}
S1 <- subset(df52, df52$stockName=='S')
S1 <- S1[complete.cases(S1),]


#assign a 1 to increasing values
S1$todayGrtrThanLag7 <- ifelse(S1$today2lag7>1, 1,0)

S1$cumulativeSumTodayGrtrThanLag7 <- cumsum(S1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countS10 <- S1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countS10 <- as.data.frame(countS10)
countS10 <- countS10[,-3]
colnames(countS10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countS10$decrDaysThisCycle <- countS10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countS10b <- countS10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countS10b <- as.data.frame(countS10b)
countS10b <- countS10b[,-3]
colnames(countS10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsStableDecr <- merge(countS10, countS10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
S3 <- merge(S1, countsStableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
S3 <- S3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
S3$todayLessThanLag7 <- ifelse(S3$today2lag7>1, 0,1)

S3$cumulativeSumTodayLessThanLag7 <- cumsum(S3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countS11 <- S3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countS11 <- as.data.frame(countS11)
countS11 <- countS11[,-3]
colnames(countS11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countS11$incrDaysThisCycle <- countS11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countS11b <- countS11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countS11b <- as.data.frame(countS11b)
countS11b <- countS11b[,-3]
colnames(countS11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsStableIncr <- merge(countS11, countS11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
S4 <- merge(S3, countsStableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



S5 <- S4[,c(2:16,1,18,17,19)]
S5
```

***


```{r}
SIG1 <- subset(df52, df52$stockName=='SIG')
SIG1 <- SIG1[complete.cases(SIG1),]


#assign a 1 to increasing values
SIG1$todayGrtrThanLag7 <- ifelse(SIG1$today2lag7>1, 1,0)

SIG1$cumulativeSumTodayGrtrThanLag7 <- cumsum(SIG1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countSIG10 <- SIG1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countSIG10 <- as.data.frame(countSIG10)
countSIG10 <- countSIG10[,-3]
colnames(countSIG10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countSIG10$decrDaysThisCycle <- countSIG10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countSIG10b <- countSIG10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countSIG10b <- as.data.frame(countSIG10b)
countSIG10b <- countSIG10b[,-3]
colnames(countSIG10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsSIGtableDecr <- merge(countSIG10, countSIG10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
SIG3 <- merge(SIG1, countsSIGtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
SIG3 <- SIG3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
SIG3$todayLessThanLag7 <- ifelse(SIG3$today2lag7>1, 0,1)

SIG3$cumulativeSumTodayLessThanLag7 <- cumsum(SIG3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countSIG11 <- SIG3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countSIG11 <- as.data.frame(countSIG11)
countSIG11 <- countSIG11[,-3]
colnames(countSIG11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countSIG11$incrDaysThisCycle <- countSIG11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countSIG11b <- countSIG11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countSIG11b <- as.data.frame(countSIG11b)
countSIG11b <- countSIG11b[,-3]
colnames(countSIG11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsSIGtableIncr <- merge(countSIG11, countSIG11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
SIG4 <- merge(SIG3, countsSIGtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



SIG5 <- SIG4[,c(2:16,1,18,17,19)]
SIG5
```

***


```{r}
T1 <- subset(df52, df52$stockName=='T')
T1 <- T1[complete.cases(T1),]


#assign a 1 to increasing values
T1$todayGrtrThanLag7 <- ifelse(T1$today2lag7>1, 1,0)

T1$cumulativeSumTodayGrtrThanLag7 <- cumsum(T1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countT10 <- T1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countT10 <- as.data.frame(countT10)
countT10 <- countT10[,-3]
colnames(countT10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countT10$decrDaysThisCycle <- countT10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countT10b <- countT10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countT10b <- as.data.frame(countT10b)
countT10b <- countT10b[,-3]
colnames(countT10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsTtableDecr <- merge(countT10, countT10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
T3 <- merge(T1, countsTtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
T3 <- T3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
T3$todayLessThanLag7 <- ifelse(T3$today2lag7>1, 0,1)

T3$cumulativeSumTodayLessThanLag7 <- cumsum(T3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countT11 <- T3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countT11 <- as.data.frame(countT11)
countT11 <- countT11[,-3]
colnames(countT11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countT11$incrDaysThisCycle <- countT11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countT11b <- countT11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countT11b <- as.data.frame(countT11b)
countT11b <- countT11b[,-3]
colnames(countT11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsTtableIncr <- merge(countT11, countT11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
T4 <- merge(T3, countsTtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



T5 <- T4[,c(2:16,1,18,17,19)]
T5
```

***


```{r}
TEVA1 <- subset(df52, df52$stockName=='TEVA')
TEVA1 <- TEVA1[complete.cases(TEVA1),]


#assign a 1 to increasing values
TEVA1$todayGrtrThanLag7 <- ifelse(TEVA1$today2lag7>1, 1,0)

TEVA1$cumulativeSumTodayGrtrThanLag7 <- cumsum(TEVA1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countTEVA10 <- TEVA1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countTEVA10 <- as.data.frame(countTEVA10)
countTEVA10 <- countTEVA10[,-3]
colnames(countTEVA10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countTEVA10$decrDaysThisCycle <- countTEVA10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countTEVA10b <- countTEVA10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countTEVA10b <- as.data.frame(countTEVA10b)
countTEVA10b <- countTEVA10b[,-3]
colnames(countTEVA10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsTEVAtableDecr <- merge(countTEVA10, countTEVA10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
TEVA3 <- merge(TEVA1, countsTEVAtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
TEVA3 <- TEVA3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
TEVA3$todayLessThanLag7 <- ifelse(TEVA3$today2lag7>1, 0,1)

TEVA3$cumulativeSumTodayLessThanLag7 <- cumsum(TEVA3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countTEVA11 <- TEVA3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countTEVA11 <- as.data.frame(countTEVA11)
countTEVA11 <- countTEVA11[,-3]
colnames(countTEVA11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countTEVA11$incrDaysThisCycle <- countTEVA11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countTEVA11b <- countTEVA11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countTEVA11b <- as.data.frame(countTEVA11b)
countTEVA11b <- countTEVA11b[,-3]
colnames(countTEVA11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsTEVAtableIncr <- merge(countTEVA11, countTEVA11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
TEVA4 <- merge(TEVA3, countsTEVAtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



TEVA5 <- TEVA4[,c(2:16,1,18,17,19)]
TEVA5
```

***


```{r}
TGT1 <- subset(df52, df52$stockName=='TGT')
TGT1 <- TGT1[complete.cases(TGT1),]


#assign a 1 to increasing values
TGT1$todayGrtrThanLag7 <- ifelse(TGT1$today2lag7>1, 1,0)

TGT1$cumulativeSumTodayGrtrThanLag7 <- cumsum(TGT1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countTGT10 <- TGT1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countTGT10 <- as.data.frame(countTGT10)
countTGT10 <- countTGT10[,-3]
colnames(countTGT10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countTGT10$decrDaysThisCycle <- countTGT10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countTGT10b <- countTGT10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countTGT10b <- as.data.frame(countTGT10b)
countTGT10b <- countTGT10b[,-3]
colnames(countTGT10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsTGTtableDecr <- merge(countTGT10, countTGT10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
TGT3 <- merge(TGT1, countsTGTtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
TGT3 <- TGT3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
TGT3$todayLessThanLag7 <- ifelse(TGT3$today2lag7>1, 0,1)

TGT3$cumulativeSumTodayLessThanLag7 <- cumsum(TGT3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countTGT11 <- TGT3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countTGT11 <- as.data.frame(countTGT11)
countTGT11 <- countTGT11[,-3]
colnames(countTGT11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countTGT11$incrDaysThisCycle <- countTGT11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countTGT11b <- countTGT11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countTGT11b <- as.data.frame(countTGT11b)
countTGT11b <- countTGT11b[,-3]
colnames(countTGT11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsTGTtableIncr <- merge(countTGT11, countTGT11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
TGT4 <- merge(TGT3, countsTGTtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



TGT5 <- TGT4[,c(2:16,1,18,17,19)]
TGT5
```

***


```{r}
TJX1 <- subset(df52, df52$stockName=='TJX')
TJX1 <- TJX1[complete.cases(TJX1),]


#assign a 1 to increasing values
TJX1$todayGrtrThanLag7 <- ifelse(TJX1$today2lag7>1, 1,0)

TJX1$cumulativeSumTodayGrtrThanLag7 <- cumsum(TJX1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countTJX10 <- TJX1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countTJX10 <- as.data.frame(countTJX10)
countTJX10 <- countTJX10[,-3]
colnames(countTJX10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countTJX10$decrDaysThisCycle <- countTJX10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countTJX10b <- countTJX10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countTJX10b <- as.data.frame(countTJX10b)
countTJX10b <- countTJX10b[,-3]
colnames(countTJX10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsTJXtableDecr <- merge(countTJX10, countTJX10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
TJX3 <- merge(TJX1, countsTJXtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
TJX3 <- TJX3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
TJX3$todayLessThanLag7 <- ifelse(TJX3$today2lag7>1, 0,1)

TJX3$cumulativeSumTodayLessThanLag7 <- cumsum(TJX3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countTJX11 <- TJX3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countTJX11 <- as.data.frame(countTJX11)
countTJX11 <- countTJX11[,-3]
colnames(countTJX11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countTJX11$incrDaysThisCycle <- countTJX11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countTJX11b <- countTJX11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countTJX11b <- as.data.frame(countTJX11b)
countTJX11b <- countTJX11b[,-3]
colnames(countTJX11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsTJXtableIncr <- merge(countTJX11, countTJX11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
TJX4 <- merge(TJX3, countsTJXtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



TJX5 <- TJX4[,c(2:16,1,18,17,19)]
TJX5
```

***


```{r}
TM1 <- subset(df52, df52$stockName=='TM')
TM1 <- TM1[complete.cases(TM1),]


#assign a 1 to increasing values
TM1$todayGrtrThanLag7 <- ifelse(TM1$today2lag7>1, 1,0)

TM1$cumulativeSumTodayGrtrThanLag7 <- cumsum(TM1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countTM10 <- TM1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countTM10 <- as.data.frame(countTM10)
countTM10 <- countTM10[,-3]
colnames(countTM10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countTM10$decrDaysThisCycle <- countTM10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countTM10b <- countTM10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countTM10b <- as.data.frame(countTM10b)
countTM10b <- countTM10b[,-3]
colnames(countTM10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsTMtableDecr <- merge(countTM10, countTM10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
TM3 <- merge(TM1, countsTMtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
TM3 <- TM3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
TM3$todayLessThanLag7 <- ifelse(TM3$today2lag7>1, 0,1)

TM3$cumulativeSumTodayLessThanLag7 <- cumsum(TM3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countTM11 <- TM3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countTM11 <- as.data.frame(countTM11)
countTM11 <- countTM11[,-3]
colnames(countTM11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countTM11$incrDaysThisCycle <- countTM11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countTM11b <- countTM11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countTM11b <- as.data.frame(countTM11b)
countTM11b <- countTM11b[,-3]
colnames(countTM11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsTMtableIncr <- merge(countTM11, countTM11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
TM4 <- merge(TM3, countsTMtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



TM5 <- TM4[,c(2:16,1,18,17,19)]
TM5
```

***


```{r}
UBSI1 <- subset(df52, df52$stockName=='UBSI')
UBSI1 <- UBSI1[complete.cases(UBSI1),]


#assign a 1 to increasing values
UBSI1$todayGrtrThanLag7 <- ifelse(UBSI1$today2lag7>1, 1,0)

UBSI1$cumulativeSumTodayGrtrThanLag7 <- cumsum(UBSI1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countUBSI10 <- UBSI1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countUBSI10 <- as.data.frame(countUBSI10)
countUBSI10 <- countUBSI10[,-3]
colnames(countUBSI10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countUBSI10$decrDaysThisCycle <- countUBSI10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countUBSI10b <- countUBSI10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countUBSI10b <- as.data.frame(countUBSI10b)
countUBSI10b <- countUBSI10b[,-3]
colnames(countUBSI10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsUBSItableDecr <- merge(countUBSI10, countUBSI10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
UBSI3 <- merge(UBSI1, countsUBSItableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
UBSI3 <- UBSI3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
UBSI3$todayLessThanLag7 <- ifelse(UBSI3$today2lag7>1, 0,1)

UBSI3$cumulativeSumTodayLessThanLag7 <- cumsum(UBSI3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countUBSI11 <- UBSI3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countUBSI11 <- as.data.frame(countUBSI11)
countUBSI11 <- countUBSI11[,-3]
colnames(countUBSI11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countUBSI11$incrDaysThisCycle <- countUBSI11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countUBSI11b <- countUBSI11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countUBSI11b <- as.data.frame(countUBSI11b)
countUBSI11b <- countUBSI11b[,-3]
colnames(countUBSI11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsUBSItableIncr <- merge(countUBSI11, countUBSI11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
UBSI4 <- merge(UBSI3, countsUBSItableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



UBSI5 <- UBSI4[,c(2:16,1,18,17,19)]
UBSI5
```

***


```{r}
VZ1 <- subset(df52, df52$stockName=='VZ')
VZ1 <- VZ1[complete.cases(VZ1),]


#assign a 1 to increasing values
VZ1$todayGrtrThanLag7 <- ifelse(VZ1$today2lag7>1, 1,0)

VZ1$cumulativeSumTodayGrtrThanLag7 <- cumsum(VZ1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countVZ10 <- VZ1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countVZ10 <- as.data.frame(countVZ10)
countVZ10 <- countVZ10[,-3]
colnames(countVZ10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countVZ10$decrDaysThisCycle <- countVZ10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countVZ10b <- countVZ10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countVZ10b <- as.data.frame(countVZ10b)
countVZ10b <- countVZ10b[,-3]
colnames(countVZ10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsVZtableDecr <- merge(countVZ10, countVZ10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
VZ3 <- merge(VZ1, countsVZtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
VZ3 <- VZ3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
VZ3$todayLessThanLag7 <- ifelse(VZ3$today2lag7>1, 0,1)

VZ3$cumulativeSumTodayLessThanLag7 <- cumsum(VZ3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countVZ11 <- VZ3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countVZ11 <- as.data.frame(countVZ11)
countVZ11 <- countVZ11[,-3]
colnames(countVZ11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countVZ11$incrDaysThisCycle <- countVZ11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countVZ11b <- countVZ11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countVZ11b <- as.data.frame(countVZ11b)
countVZ11b <- countVZ11b[,-3]
colnames(countVZ11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsVZtableIncr <- merge(countVZ11, countVZ11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
VZ4 <- merge(VZ3, countsVZtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



VZ5 <- VZ4[,c(2:16,1,18,17,19)]
VZ5
```

***


```{r}
WFC1 <- subset(df52, df52$stockName=='WFC')
WFC1 <- WFC1[complete.cases(WFC1),]


#assign a 1 to increasing values
WFC1$todayGrtrThanLag7 <- ifelse(WFC1$today2lag7>1, 1,0)

WFC1$cumulativeSumTodayGrtrThanLag7 <- cumsum(WFC1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countWFC10 <- WFC1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countWFC10 <- as.data.frame(countWFC10)
countWFC10 <- countWFC10[,-3]
colnames(countWFC10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countWFC10$decrDaysThisCycle <- countWFC10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countWFC10b <- countWFC10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countWFC10b <- as.data.frame(countWFC10b)
countWFC10b <- countWFC10b[,-3]
colnames(countWFC10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsWFCtableDecr <- merge(countWFC10, countWFC10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
WFC3 <- merge(WFC1, countsWFCtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
WFC3 <- WFC3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
WFC3$todayLessThanLag7 <- ifelse(WFC3$today2lag7>1, 0,1)

WFC3$cumulativeSumTodayLessThanLag7 <- cumsum(WFC3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countWFC11 <- WFC3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countWFC11 <- as.data.frame(countWFC11)
countWFC11 <- countWFC11[,-3]
colnames(countWFC11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countWFC11$incrDaysThisCycle <- countWFC11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countWFC11b <- countWFC11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countWFC11b <- as.data.frame(countWFC11b)
countWFC11b <- countWFC11b[,-3]
colnames(countWFC11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsWFCtableIncr <- merge(countWFC11, countWFC11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
WFC4 <- merge(WFC3, countsWFCtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



WFC5 <- WFC4[,c(2:16,1,18,17,19)]
WFC5
```

***


```{r}
WM1 <- subset(df52, df52$stockName=='WM')
WM1 <- WM1[complete.cases(WM1),]


#assign a 1 to increasing values
WM1$todayGrtrThanLag7 <- ifelse(WM1$today2lag7>1, 1,0)

WM1$cumulativeSumTodayGrtrThanLag7 <- cumsum(WM1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countWM10 <- WM1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countWM10 <- as.data.frame(countWM10)
countWM10 <- countWM10[,-3]
colnames(countWM10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countWM10$decrDaysThisCycle <- countWM10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countWM10b <- countWM10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countWM10b <- as.data.frame(countWM10b)
countWM10b <- countWM10b[,-3]
colnames(countWM10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsWMtableDecr <- merge(countWM10, countWM10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
WM3 <- merge(WM1, countsWMtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
WM3 <- WM3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
WM3$todayLessThanLag7 <- ifelse(WM3$today2lag7>1, 0,1)

WM3$cumulativeSumTodayLessThanLag7 <- cumsum(WM3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countWM11 <- WM3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countWM11 <- as.data.frame(countWM11)
countWM11 <- countWM11[,-3]
colnames(countWM11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countWM11$incrDaysThisCycle <- countWM11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countWM11b <- countWM11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countWM11b <- as.data.frame(countWM11b)
countWM11b <- countWM11b[,-3]
colnames(countWM11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsWMtableIncr <- merge(countWM11, countWM11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
WM4 <- merge(WM3, countsWMtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



WM5 <- WM4[,c(2:16,1,18,17,19)]
WM5
```

***


```{r}
WMT1 <- subset(df52, df52$stockName=='WMT')
WMT1 <- WMT1[complete.cases(WMT1),]


#assign a 1 to increasing values
WMT1$todayGrtrThanLag7 <- ifelse(WMT1$today2lag7>1, 1,0)

WMT1$cumulativeSumTodayGrtrThanLag7 <- cumsum(WMT1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countWMT10 <- WMT1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countWMT10 <- as.data.frame(countWMT10)
countWMT10 <- countWMT10[,-3]
colnames(countWMT10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countWMT10$decrDaysThisCycle <- countWMT10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countWMT10b <- countWMT10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countWMT10b <- as.data.frame(countWMT10b)
countWMT10b <- countWMT10b[,-3]
colnames(countWMT10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsWMTtableDecr <- merge(countWMT10, countWMT10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
WMT3 <- merge(WMT1, countsWMTtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
WMT3 <- WMT3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
WMT3$todayLessThanLag7 <- ifelse(WMT3$today2lag7>1, 0,1)

WMT3$cumulativeSumTodayLessThanLag7 <- cumsum(WMT3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countWMT11 <- WMT3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countWMT11 <- as.data.frame(countWMT11)
countWMT11 <- countWMT11[,-3]
colnames(countWMT11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countWMT11$incrDaysThisCycle <- countWMT11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countWMT11b <- countWMT11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countWMT11b <- as.data.frame(countWMT11b)
countWMT11b <- countWMT11b[,-3]
colnames(countWMT11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsWMTtableIncr <- merge(countWMT11, countWMT11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
WMT4 <- merge(WMT3, countsWMTtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



WMT5 <- WMT4[,c(2:16,1,18,17,19)]
WMT5
```

***


```{r}
WWE1 <- subset(df52, df52$stockName=='WWE')
WWE1 <- WWE1[complete.cases(WWE1),]


#assign a 1 to increasing values
WWE1$todayGrtrThanLag7 <- ifelse(WWE1$today2lag7>1, 1,0)

WWE1$cumulativeSumTodayGrtrThanLag7 <- cumsum(WWE1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countWWE10 <- WWE1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countWWE10 <- as.data.frame(countWWE10)
countWWE10 <- countWWE10[,-3]
colnames(countWWE10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countWWE10$decrDaysThisCycle <- countWWE10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countWWE10b <- countWWE10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countWWE10b <- as.data.frame(countWWE10b)
countWWE10b <- countWWE10b[,-3]
colnames(countWWE10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsWWEtableDecr <- merge(countWWE10, countWWE10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
WWE3 <- merge(WWE1, countsWWEtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
WWE3 <- WWE3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
WWE3$todayLessThanLag7 <- ifelse(WWE3$today2lag7>1, 0,1)

WWE3$cumulativeSumTodayLessThanLag7 <- cumsum(WWE3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countWWE11 <- WWE3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countWWE11 <- as.data.frame(countWWE11)
countWWE11 <- countWWE11[,-3]
colnames(countWWE11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countWWE11$incrDaysThisCycle <- countWWE11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countWWE11b <- countWWE11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countWWE11b <- as.data.frame(countWWE11b)
countWWE11b <- countWWE11b[,-3]
colnames(countWWE11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsWWEtableIncr <- merge(countWWE11, countWWE11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
WWE4 <- merge(WWE3, countsWWEtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



WWE5 <- WWE4[,c(2:16,1,18,17,19)]
WWE5
```

***



```{r}
XOM1 <- subset(df52, df52$stockName=='XOM')
XOM1 <- XOM1[complete.cases(XOM1),]


#assign a 1 to increasing values
XOM1$todayGrtrThanLag7 <- ifelse(XOM1$today2lag7>1, 1,0)

XOM1$cumulativeSumTodayGrtrThanLag7 <- cumsum(XOM1$todayGrtrThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively decreasing
# those cumulative counts that don't repeat, are counting increasing days.
# These are stock values for today's value to 7 days prior value.
countXOM10 <- XOM1 %>% group_by(cumulativeSumTodayGrtrThanLag7) %>% count(n=n())
countXOM10 <- as.data.frame(countXOM10)
countXOM10 <- countXOM10[,-3]
colnames(countXOM10)[2] <- 'nRepeatsTodayGrtrThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countXOM10$decrDaysThisCycle <- countXOM10$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countXOM10b <- countXOM10 %>% group_by(decrDaysThisCycle) %>% count(n=n())
countXOM10b <- as.data.frame(countXOM10b)
countXOM10b <- countXOM10b[,-3]
colnames(countXOM10b)[2] <- 'nTimesDecrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsXOMtableDecr <- merge(countXOM10, countXOM10b, by.x='decrDaysThisCycle',
                             by.y='decrDaysThisCycle')

#combine the counts to the stock subset
XOM3 <- merge(XOM1, countsXOMtableDecr, by.x='cumulativeSumTodayGrtrThanLag7',
               by.y='cumulativeSumTodayGrtrThanLag7')
XOM3 <- XOM3[,c(2:11,1,13,12,14)]


#assign a 1 to decreasing values
XOM3$todayLessThanLag7 <- ifelse(XOM3$today2lag7>1, 0,1)

XOM3$cumulativeSumTodayLessThanLag7 <- cumsum(XOM3$todayLessThanLag7)

# get the count of how many instances repeat, 
# those counts repeating are counts that measure the days cumulatively increasing
# those cumulative counts that don't repeat, are counting decreasing days.
# These are stock values for today's value to 7 days prior value.
countXOM11 <- XOM3 %>% group_by(cumulativeSumTodayLessThanLag7) %>% count(n=n())
countXOM11 <- as.data.frame(countXOM11)
countXOM11 <- countXOM11[,-3]
colnames(countXOM11)[2] <- 'nRepeatsTodayLessThanLag7'

# Count the REPEATS of each number (minus the initial start) 
countXOM11$incrDaysThisCycle <- countXOM11$n-1

# Count the number of times the cycle count repeats in this time span exactly that many days
countXOM11b <- countXOM11 %>% group_by(incrDaysThisCycle) %>% count(n=n())
countXOM11b <- as.data.frame(countXOM11b)
countXOM11b <- countXOM11b[,-3]
colnames(countXOM11b)[2] <- 'nTimesIncrDayCountsOccurs'

#combine these two count matrices of decreasing days
countsXOMtableIncr <- merge(countXOM11, countXOM11b, by.x='incrDaysThisCycle',
                             by.y='incrDaysThisCycle')

#combine the counts to the stock subset
XOM4 <- merge(XOM3, countsXOMtableIncr, by.x='cumulativeSumTodayLessThanLag7',
               by.y='cumulativeSumTodayLessThanLag7')



XOM5 <- XOM4[,c(2:16,1,18,17,19)]
XOM5
```

***


Now row bind the 52 count tables of stocks.
```{r}

stockCounts52 <- rbind(AAL5,AAP5,ADDYY5,AMZN5,ARWR5,C5,COST5,CVX5,DLTR5,EPD5,F5,
                       FFIN5,FTR5,GOOG5,HD5,HMC5,HOFT5,HRB5,HST5,INO5,JBLU5,JNJ5,
                       JPM5,JWN5,KGJI5,KSS5,LUV5,M5,MGM5,MSFT5,NFLX5,NKE5,NSANY5,
                       NUS5,ONCY5,PCG5,ROST5,RRGB5,S5,SIG5,T5,TEVA5,TGT5,TJX5,
                       TM5,UBSI5,VZ5,WFC5,WM5,WMT5,WWE5,XOM5)
STOCK_COUNTS_52 <- merge(stockNames,stockCounts52, by.x='stock',by.y='stockName')
STOCK_COUNTS_52 <- STOCK_COUNTS_52[order(STOCK_COUNTS_52$Date),]
row.names(STOCK_COUNTS_52) <- NULL
stockCompleteSet <- merge(comp,STOCK_COUNTS_52, by.x='stockName', by.y='stock')
```

Save this file to csv.
```{r}
colnames(STOCK_COUNTS_52) <- gsub('lag7',lagN, colnames(STOCK_COUNTS_52))
colnames(STOCK_COUNTS_52) <- gsub('Lag7',lagN, colnames(STOCK_COUNTS_52))
colnames(stockCompleteSet) <- gsub('lag7',lagN, colnames(stockCompleteSet))
colnames(stockCompleteSet) <- gsub('Lag7',lagN, colnames(stockCompleteSet))

stockCompleteSet <- stockCompleteSet[with(stockCompleteSet,order(stockName,Date)),]
STOCK_COUNTS_52 <- STOCK_COUNTS_52[with(STOCK_COUNTS_52,order(stock,Date)),]

write.csv(stockCompleteSet, 
          paste(paste(paste('stocksFullDateREQS',
                      date,sep='_'),
                      lagN,sep='_'),
                      'csv', sep='.'), 
          row.names=FALSE)

write.csv(STOCK_COUNTS_52,
          paste(paste(paste('STOCK_COUNTS_52',date,sep='_'),lagN,sep='_'),'csv',sep='.')
          , row.names=FALSE)
```


These are the stocks that didn't have values for many of the dates in the date request.
```{r}

colnames(inCompREQ_stocks)
```

These are the stocks that had all dates in the request.
```{r}

colnames(stockCompleteSet)
```

And these stocks had almost all the dates requested but not quite.
```{r}

colnames(STOCK_COUNTS_52)
```


