---
title: "subset years of ROI on Hand Picked Stocks 2007-2020"
author: "Janis Corona"
date: 'March 2020'
output:
  html_document: default
  word_document: default
---

This program will take the 2012 year as a subset of data from 52 hand picked stocks from a portfolio of 65, where 53 originally had 2007-2020 data, but one was omitted due to not finding the factor error until thousands of dependent objects and lines of code later. 

This script depends on a few of the tables the ROI_HandPickedStocks.Rmd file produced and is almost entirely the same script with modifications to table outputs to fit this year subset.Change the two fields below to the start date and end date you want the subset to include. The dates for this script are for the year, and any dates after the START_DATE0 and before the END_DATE0 settings will be used.

```{r, echo=FALSE, error=FALSE, message=FALSE, warning=FALSE}
library(lubridate)
library(tidyr)
library(dplyr)

START_DATE0 <- '2011-12-31'
END_DATE0 <- '2013-01-01'

```

```{r}

Close2 <- read.csv('ROI_UE_2007_2020.csv', sep=',', header=TRUE, na.strings=c('',' '))
```

```{r}
Close17_dow <- read.csv('Close17_dow_lags.csv', sep=',', header=TRUE,
                        na.strings=c('',' '))
Close17_dow$Date <- as.Date(Close17_dow$Date)
```

Modified to subset by dates for a final table.
```{r}
Close17_dow <- subset(Close17_dow, Close17_dow$Date > START_DATE0 &
                        Close17_dow$Date < END_DATE0)
```


```{r}
dROI17 <- Close17_dow %>% group_by(DOW_down_median) %>%
  summarise_at(vars(stockValue), mean)
colnames(dROI17)[2] <- 'avgStockValue'

start17 <- subset(Close17_dow, Close17_dow$Date==Close17_dow$Date[1])
final17 <- subset(Close17_dow,
                  Close17_dow$Date==Close17_dow$Date[length(Close17_dow$Date)])


start17 <- start17[order(start17$DOW_down_median),]
final17 <- final17[order(final17$DOW_down_median),]
dROI17 <- dROI17[order(dROI17$DOW_down_median),]

DOW_ROI <- as.data.frame(final17$DOW_Close/start17$DOW_Close)
colnames(DOW_ROI) <- 'DOW_ROI'

colnames(start17)[6] <- 'startValue'
colnames(final17)[6] <- 'finalValue'

dROI17$startValue <- start17$startValue
dROI17$finalValue <- final17$finalValue
dROI17$DOW_ROI <- DOW_ROI$DOW_ROI
dROI17$stock_ROI <- dROI17$finalValue/dROI17$startValue
dROI17
```

```{r}
stockNames <- read.csv('yahooStockBasket.csv', header=TRUE, sep=',', na.strings=c('',' '))

```


```{r}

START_DATE <- Close17_dow$Date[1]
END_DATE <- Close17_dow$Date[length(Close17_dow$Date)]
```

```{r}
dROI17$stockBeatsDOW <- ifelse(dROI17$stock_ROI > dROI17$DOW_ROI, 'Yes', 'No')
dROI17[,c(1,7)]
```

Now create the ratios of current day's stock value to the lag day stock value. This will allow us to see how these stocks compare to previous days, and get median and average fold change values or ratios. 
```{r}
Close17_dow$today2lag7 <- as.numeric(paste(Close17_dow$lag7))/Close17_dow$stockValue
Close17_dow$today2lag30 <- as.numeric(paste(Close17_dow$lag30))/Close17_dow$stockValue
Close17_dow$today2lag60 <- as.numeric(paste(Close17_dow$lag60))/Close17_dow$stockValue
Close17_dow$today2lag90 <- as.numeric(paste(Close17_dow$lag90))/Close17_dow$stockValue
Close17_dow$today2lag120 <- as.numeric(paste(Close17_dow$lag120))/Close17_dow$stockValue
Close17_dow$today2lag150 <- as.numeric(paste(Close17_dow$lag150))/Close17_dow$stockValue
Close17_dow$today2lag180 <- as.numeric(paste(Close17_dow$lag180))/Close17_dow$stockValue

```
```{r}
medianStockROI <- median(dROI17$stock_ROI)
medianStockROI

listROI_middle <- dROI17[order(dROI17$stock_ROI)[7:11],]
listROI_middle$DOW_down_median
```

```{r}
listROI_middle
```

Lets look again at our 17 stock that were in the best performing subset with return on investment in dollars filtered by those that had positive median daily change stock values when the DOW was down and unemployment higher than the last month. This was in our dROI17 table.
```{r}

listROI <- dROI17[order(dROI17$stock_ROI),]

listROI_low <- listROI[1:6,]
listROI_middle <- listROI[7:11,]
listROI_high <- listROI[12:17,]

listROI
```


The low median return on investment ratios of final/start values:
```{r}
listROI_low
```


The middle median return on investment ratios of final/start values that we only evaluated a seven day lag with for number of increasing and decreasing days in this time span of 2007-2020:
```{r}
listROI_middle
```

The high median return on investment ratios of final/start values:
```{r}
listROI_high
```


Now we can add to these tables the number of increasing and decreasing days in this life cycle for each stock by their median number of increasing and decreasing days by lag 7. Lets do this only for lag 7. Later we will do this for lags 30-180 for each stock, to fill in some of those questions we wanted answers to for predicting the return on a stock based on those feature characteristics for each stock. We will know the return on investment and use the remaining stock in our 53 total stocks to categorize the return as low if at least the value of our median ROI of 6.02 as a ratio of final/start values. The other stocks above that value will be high. This will give two classes to predict if the stock will be a low or high stock return buy. For now, lets massage the data enough to get this additional data, then we can wrestle with it into our machine learning data model. 

***

We need to now get the number of days that each of the other stock increased and decreased as a median value and for the 7 day lag.Lets make this table with default values set before adding each result as we get it for each stock. Lets also add the 3rd quantile to these stock for the top 75% of cumulative sums value in comparing lag 7 fold change of today's stock value to 7 days ago.
```{r}
dROI17_lag7 <- dROI17
dROI17_lag7$medn_cSum_decr_L7 <- 'median cSum down L7'
dROI17_lag7$Q3_cSum_decr_L7 <- '3rd Qntl cSum down L7'
dROI17_lag7$max_cSum_decr_L7 <- 'max cSum down L7'
dROI17_lag7$medn_cSum_incr_L7 <- 'median cSum up L7'
dROI17_lag7$Q3_cSum_incr_L7 <- '3rd Qntl cSum up L7'
dROI17_lag7$max_cSum_incr_L7 <- 'max cSum up L7'
```

Lets make count variables of these stock and get the values and counts for each time the stock went above or below its price 7, 30, 60, 90, 120, 150, and 180 days prior, and the same for the counts each stock was above those prices. Lets just use the Close17_dow, instead of the added median, mean, min, and max lag value ratios.

```{r}
FFIN <- subset(Close17_dow, Close17_dow$DOW_down_median=='FFIN')

ffin7 <- ifelse(FFIN$today2lag7>1, 1,0)
ffin30 <- ifelse(FFIN$today2lag30>1,1,0)
ffin60 <- ifelse(FFIN$today2lag60>1,1,0)
ffin90 <- ifelse(FFIN$today2lag90>1,1,0)
ffin120 <- ifelse(FFIN$today2lag120>1,1,0)
ffin150 <- ifelse(FFIN$today2lag150>1,1,0)
ffin180 <- ifelse(FFIN$today2lag180>1,1,0)

neg7 <- sum(ffin7==0, na.rm=T)
pos7 <- sum(ffin7==1, na.rm=T)

neg30 <- sum(ffin30==0, na.rm=T)
pos30 <- sum(ffin30==1, na.rm=T)

neg60 <- sum(ffin60==0, na.rm=T)
pos60 <- sum(ffin60==1, na.rm=T)

neg90 <- sum(ffin90==0, na.rm=T)
pos90 <- sum(ffin90==1, na.rm=T)

neg120 <- sum(ffin120==0, na.rm=T)
pos120 <- sum(ffin120==1, na.rm=T)

neg150 <- sum(ffin150==0, na.rm=T)
pos150 <- sum(ffin150==1, na.rm=T)

neg180 <- sum(ffin180==0, na.rm=T)
pos180 <- sum(ffin180==1, na.rm=T)

ffin_counts0 <- as.data.frame(c(neg7,neg30,neg60,neg90,neg120,neg150,neg180))
ffin_counts1  <- as.data.frame(c(pos7,pos30,pos60,pos90,pos120,pos150,pos180))
ffin_counts <- cbind(ffin_counts0, ffin_counts1)
row.names(ffin_counts) <- c('lag7','lag30','lag60','lag90','lag120','lag150','lag180')
colnames(ffin_counts) <- c('sum_neg_lags','sum_pos_lags')

ffin_counts
```

From the above chart on the number of days the current value was lower than 7, 30, 60, 90, 120, 150, or 180 days prior to todays's stock value, there were more in each lag than in those days the stocks was higher. There are the fewest number of days the stock increases from 180 days prior's stock value for FFIN stock shown above. This means you have more days to buy low and fewer to sell high. 

We should add a cumulative field or make a cumulative sum variable for each of these seven groups of lags in stock value. This way we can know how many cumulative days there are for each positive or negative value. Are there more frequent days that the stock stays lower in value to its lag price before increasing and how many days does the stock increase before starting to decrease.


```{r}
length(ffin7)

#rm nas or all nas as output from the today2lag7 stock ratio values
ffin7_a <- ffin7[-c(1:7)]

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for ffin7 <- <- ifelse(FFIN$today2lag7>1, 1,0)
ffin7_ab <- cumsum(ffin7_a)

ffin7_abc <- as.data.frame(as.factor(ffin7_ab))
colnames(ffin7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countFFIN <- ffin7_abc %>% group_by(cSum) %>% count(n=n())
countFFIN <- as.data.frame(countFFIN)
countFFIN <- countFFIN[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countFFIN$decr_Days <- countFFIN$n-1
countFFIN <- countFFIN[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countFFIN2 <- subset(countFFIN, countFFIN$decr_Days>0)
summary(countFFIN2$decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
decr_Days_grouped <- countFFIN2 %>% group_by(decr_Days) %>% count(n=n())
decr_Days_grouped <- decr_Days_grouped[,-3]
```


The above table countFFIN2 gives the number of days in a row the stock value decreased starting at the cSum variable value. 

The decr_Days_grouped table shows the number of days in a row the stock decreased from 2007-2020, and how many times the stock decreased that many days in a row.
```{r}
decr_Days_grouped
```

From the above chart on the FFIN stock from 2007-2020, it decreased for one day before increasing, exactly 96 times, and it had 10 consecutive days of decreasing exactly 12 times. 
```{r}

median(decr_Days_grouped$decr_Days)
```
The median number of days it decreased consecutively was 12. And the chart above shows it did this exactly three times from 2007-2020. Meaning there were three intervals where this stock, FFIN, decreased for 12 days before increasing. This could be a feature for evaluating whether to buy the stock once, it has decreased for 12 days. We will test it later.



Now, it would be nice to wrap a way around getting the number of consecutive days the FFIN stock value of each instance compared to the value seven days prior increased. So that we could compare number of days and sets of increasing days to that of the decreasing days. We should be able to do this by changing the original variable that assigned 1 to increasing and instead assigned 1 to decreasing to calculate the days increasing with the same method we used above.
```{r}

#assign a 1 to decreasing values
ffin7_b <- ifelse(FFIN$today2lag7>1, 0,1)

#rm NAs
ffin7_b1 <- ffin7_b[-c(1:7)] 

#counts the 
ffin7_b2 <- cumsum(ffin7_b1)

ffin7_b3 <- as.data.frame(as.factor(ffin7_b2))
colnames(ffin7_b3) <- 'cSum'

countFFIN1 <- ffin7_b3 %>% group_by(cSum) %>% count(n=n())
countFFIN1 <- as.data.frame(countFFIN1)
countFFIN1 <- countFFIN1[,-3]

countFFIN1$incr_Days <- countFFIN1$n-1
countFFIN1 <- countFFIN1[,-2]

countFFIN3 <- subset(countFFIN1, countFFIN1$incr_Days>0)
summary(countFFIN3$incr_Days)

incr_Days_grouped <- countFFIN3 %>% group_by(incr_Days) %>% count(n=n())
incr_Days_grouped <- incr_Days_grouped[,-3]
```

There were 26 consecutive days that the stock compared to seven days prior increased, and the median number of consecutive days the stock increased was 3 days in a row. The number of groups or times in this times series from 2007-2020 for FFIN that the stock increased consecutively is shown next.
```{r}
incr_Days_grouped
```

The above chart shows that the stock had 21 sets of consecutive days it increased. FFIN had 10 consecutive days it increased compared to the value 7 days ago, and this happened ten times from 2007-2020. 


```{r}
median(incr_Days_grouped$incr_Days)
```
The median number of consecutive days the FFIN stock increased is 11 days, and from the previous chart we know this happened six times from 2007-2020.


Lets run the FFIN (First Financial Bankshares) stock again, save the variables, grep it from the last table dROI17_lag7, fill in with our values, and find and replace the stock name with the new stock moving forward.
```{r}
FFIN <- subset(Close17_dow, Close17_dow$DOW_down_median=='FFIN')

#assign a 1 to increasing values
ffin7 <- ifelse(FFIN$today2lag7>1, 1,0)

ffin7_a <- na.omit(ffin7)

ffin7_ab <- cumsum(ffin7_a)

ffin7_abc <- as.data.frame(as.factor(ffin7_ab))
colnames(ffin7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countFFIN <- ffin7_abc %>% group_by(cSum) %>% count(n=n())
countFFIN <- as.data.frame(countFFIN)
countFFIN <- countFFIN[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countFFIN$decr_Days <- countFFIN$n-1
countFFIN <- countFFIN[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countFFIN1 <- subset(countFFIN, countFFIN$decr_Days>0)
summary(countFFIN1$decr_Days)

mxffin_d <- max(countFFIN1$decr_Days)
mdnffin_d <- median(countFFIN1$decr_Days)
q3ffin_d <- as.numeric(as.character(summary(countFFIN1$decr_Days)["3rd Qu."]))
```

```{r}
#assign a 1 to decreasing values
ffin7_b <- ifelse(FFIN$today2lag7>1, 0,1)

#rm NAs
ffin7_b1 <- na.omit(ffin7_b) 

#counts the 
ffin7_b2 <- cumsum(ffin7_b1)

ffin7_b3 <- as.data.frame(as.factor(ffin7_b2))
colnames(ffin7_b3) <- 'cSum'

countFFIN2 <- ffin7_b3 %>% group_by(cSum) %>% count(n=n())
countFFIN2 <- as.data.frame(countFFIN2)
countFFIN2 <- countFFIN2[,-3]

countFFIN2$incr_Days <- countFFIN2$n-1
countFFIN2 <- countFFIN2[,-2]

countFFIN3 <- subset(countFFIN2, countFFIN2$incr_Days>0)
summary(countFFIN3$incr_Days)

mxffin_i <- max(countFFIN3$incr_Days)
mdnffin_i <- median(countFFIN3$incr_Days)
q3ffin_i <- as.numeric(as.character(summary(countFFIN3$incr_Days)["3rd Qu."]))


```

Add these statistics to their respective stock instance in the dROI17_lag7 table.
```{r}
ffin_g <- grep('FFIN',dROI17_lag7$DOW_down_median)

dROI17_lag7[ffin_g,8:13] <- c(mdnffin_d,q3ffin_d,mxffin_d,mdnffin_i,q3ffin_i,mxffin_i)

```


GOOG (Google) stats:
```{r}
GOOG <- subset(Close17_dow, Close17_dow$DOW_down_median=='GOOG')

#assign a 1 to increasing values
goog7<- ifelse(GOOG$today2lag7>1, 1,0)

goog7_a <- na.omit(goog7)

goog7_ab <- cumsum(goog7_a)

goog7_abc <- as.data.frame(as.factor(goog7_ab))
colnames(goog7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countGOOG <- goog7_abc %>% group_by(cSum) %>% count(n=n())
countGOOG <- as.data.frame(countGOOG)
countGOOG <- countGOOG[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countGOOG$decr_Days <- countGOOG$n-1
countGOOG <- countGOOG[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countGOOG1 <- subset(countGOOG, countGOOG$decr_Days>0)
print('Decreasing Consecutive Days');summary(countGOOG1$decr_Days)
print('*****************************************************************')

mxgoog_d <- max(countGOOG1$decr_Days)
mdngoog_d <- median(countGOOG1$decr_Days)
q3goog_d <- as.numeric(as.character(summary(countGOOG1$decr_Days)["3rd Qu."]))

#assign a 1 to decreasing values
goog7_b <- ifelse(GOOG$today2lag7>1, 0,1)

goog7_b1 <- na.omit(goog7_b)

#counts the 
goog7_b2 <- cumsum(goog7_b1)

goog7_b3 <- as.data.frame(as.factor(goog7_b2))
colnames(goog7_b3) <- 'cSum'

countGOOG2 <- goog7_b3 %>% group_by(cSum) %>% count(n=n())
countGOOG2 <- as.data.frame(countGOOG2)
countGOOG2 <- countGOOG2[,-3]

countGOOG2$incr_Days <- countGOOG2$n-1
countGOOG2 <- countGOOG2[,-2]

countGOOG3 <- subset(countGOOG2, countGOOG2$incr_Days>0)
print('Increasing Consecutive Days');summary(countGOOG3$incr_Days)

mxgoog_i <- max(countGOOG3$incr_Days)
mdngoog_i <- median(countGOOG3$incr_Days)
q3goog_i <- as.numeric(as.character(summary(countGOOG3$incr_Days)["3rd Qu."]))


goog_g <- grep('GOOG',dROI17_lag7$DOW_down_median)

dROI17_lag7[goog_g,8:13] <- c(mdngoog_d,q3goog_d,mxgoog_d,mdngoog_i,q3goog_i,mxgoog_i)

```

HD-Home Depot:
```{r}
HD <- subset(Close17_dow, Close17_dow$DOW_down_median=='HD')

#assign a 1 to increasing values
hd7<- ifelse(HD$today2lag7>1, 1,0)

hd7_a <- na.omit(hd7)

hd7_ab <- cumsum(hd7_a)

hd7_abc <- as.data.frame(as.factor(hd7_ab))
colnames(hd7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countHD <- hd7_abc %>% group_by(cSum) %>% count(n=n())
countHD <- as.data.frame(countHD)
countHD <- countHD[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countHD$decr_Days <- countHD$n-1
countHD <- countHD[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countHD1 <- subset(countHD, countHD$decr_Days>0)
print('Decreasing Consecutive Days');summary(countHD1$decr_Days)
print('*****************************************************************')

mxhd_d <- max(countHD1$decr_Days)
mdnhd_d <- median(countHD1$decr_Days)
q3hd_d <- as.numeric(as.character(summary(countHD1$decr_Days)["3rd Qu."]))

#assign a 1 to decreasing values
hd7_b <- ifelse(HD$today2lag7>1, 0,1)

hd7_b1 <- na.omit(hd7_b)

#counts the 
hd7_b2 <- cumsum(hd7_b1)

hd7_b3 <- as.data.frame(as.factor(hd7_b2))
colnames(hd7_b3) <- 'cSum'

countHD2 <- hd7_b3 %>% group_by(cSum) %>% count(n=n())
countHD2 <- as.data.frame(countHD2)
countHD2 <- countHD2[,-3]

countHD2$incr_Days <- countHD2$n-1
countHD2 <- countHD2[,-2]

countHD3 <- subset(countHD2, countHD2$incr_Days>0)
print('Increasing Consecutive Days');summary(countHD3$incr_Days)

mxhd_i <- max(countHD3$incr_Days)
mdnhd_i <- median(countHD3$incr_Days)
q3hd_i <- as.numeric(as.character(summary(countHD3$incr_Days)["3rd Qu."]))


hd_g <- grep('HD',dROI17_lag7$DOW_down_median)

dROI17_lag7[hd_g,8:13] <- c(mdnhd_d,q3hd_d,mxhd_d,mdnhd_i,q3hd_i,mxhd_i)

```

JNJ, Johnson & Johnson:
```{r}
JNJ <- subset(Close17_dow, Close17_dow$DOW_down_median=='JNJ')

#assign a 1 to increasing values
jnj7<- ifelse(JNJ$today2lag7>1, 1,0)

jnj7_a <- na.omit(jnj7)

jnj7_ab <- cumsum(jnj7_a)

jnj7_abc <- as.data.frame(as.factor(jnj7_ab))
colnames(jnj7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countJNJ <- jnj7_abc %>% group_by(cSum) %>% count(n=n())
countJNJ <- as.data.frame(countJNJ)
countJNJ <- countJNJ[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countJNJ$decr_Days <- countJNJ$n-1
countJNJ <- countJNJ[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countJNJ1 <- subset(countJNJ, countJNJ$decr_Days>0)
print('Decreasing Consecutive Days');summary(countJNJ1$decr_Days)
print('*****************************************************************')

mxjnj_d <- max(countJNJ1$decr_Days)
mdnjnj_d <- median(countJNJ1$decr_Days)
q3jnj_d <- as.numeric(as.character(summary(countJNJ1$decr_Days)["3rd Qu."]))

#assign a 1 to decreasing values
jnj7_b <- ifelse(JNJ$today2lag7>1, 0,1)

jnj7_b1 <- na.omit(jnj7_b)

#counts the 
jnj7_b2 <- cumsum(jnj7_b1)

jnj7_b3 <- as.data.frame(as.factor(jnj7_b2))
colnames(jnj7_b3) <- 'cSum'

countJNJ2 <- jnj7_b3 %>% group_by(cSum) %>% count(n=n())
countJNJ2 <- as.data.frame(countJNJ2)
countJNJ2 <- countJNJ2[,-3]

countJNJ2$incr_Days <- countJNJ2$n-1
countJNJ2 <- countJNJ2[,-2]

countJNJ3 <- subset(countJNJ2, countJNJ2$incr_Days>0)
print('Increasing Consecutive Days');summary(countJNJ3$incr_Days)

mxjnj_i <- max(countJNJ3$incr_Days)
mdnjnj_i <- median(countJNJ3$incr_Days)
q3jnj_i <- as.numeric(as.character(summary(countJNJ3$incr_Days)["3rd Qu."]))


jnj_g <- grep('JNJ',dROI17_lag7$DOW_down_median)

dROI17_lag7[jnj_g,8:13] <- c(mdnjnj_d,q3jnj_d,mxjnj_d,mdnjnj_i,q3jnj_i,mxjnj_i)

```

NFLX, Netflix stats:
```{r}
NFLX <- subset(Close17_dow, Close17_dow$DOW_down_median=='NFLX')

#assign a 1 to increasing values
nflx7<- ifelse(NFLX$today2lag7>1, 1,0)

nflx7_a <- na.omit(nflx7)

nflx7_ab <- cumsum(nflx7_a)

nflx7_abc <- as.data.frame(as.factor(nflx7_ab))
colnames(nflx7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countNFLX <- nflx7_abc %>% group_by(cSum) %>% count(n=n())
countNFLX <- as.data.frame(countNFLX)
countNFLX <- countNFLX[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countNFLX$decr_Days <- countNFLX$n-1
countNFLX <- countNFLX[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countNFLX1 <- subset(countNFLX, countNFLX$decr_Days>0)
print('Decreasing Consecutive Days');summary(countNFLX1$decr_Days)
print('*****************************************************************')

mxnflx_d <- max(countNFLX1$decr_Days)
mdnnflx_d <- median(countNFLX1$decr_Days)
q3nflx_d <- as.numeric(as.character(summary(countNFLX1$decr_Days)["3rd Qu."]))

#assign a 1 to decreasing values
nflx7_b <- ifelse(NFLX$today2lag7>1, 0,1)

nflx7_b1 <- na.omit(nflx7_b)

#counts the 
nflx7_b2 <- cumsum(nflx7_b1)

nflx7_b3 <- as.data.frame(as.factor(nflx7_b2))
colnames(nflx7_b3) <- 'cSum'

countNFLX2 <- nflx7_b3 %>% group_by(cSum) %>% count(n=n())
countNFLX2 <- as.data.frame(countNFLX2)
countNFLX2 <- countNFLX2[,-3]

countNFLX2$incr_Days <- countNFLX2$n-1
countNFLX2 <- countNFLX2[,-2]

countNFLX3 <- subset(countNFLX2, countNFLX2$incr_Days>0)
print('Increasing Consecutive Days');summary(countNFLX3$incr_Days)

mxnflx_i <- max(countNFLX3$incr_Days)
mdnnflx_i <- median(countNFLX3$incr_Days)
q3nflx_i <- as.numeric(as.character(summary(countNFLX3$incr_Days)["3rd Qu."]))


nflx_g <- grep('NFLX',dROI17_lag7$DOW_down_median)

dROI17_lag7[nflx_g,8:13] <- c(mdnnflx_d,q3nflx_d,mxnflx_d,mdnnflx_i,q3nflx_i,mxnflx_i)

```


NKE, Nike stats:
```{r}
NKE <- subset(Close17_dow, Close17_dow$DOW_down_median=='NKE')

#assign a 1 to increasing values
nke7<- ifelse(NKE$today2lag7>1, 1,0)

nke7_a <- na.omit(nke7)

nke7_ab <- cumsum(nke7_a)

nke7_abc <- as.data.frame(as.factor(nke7_ab))
colnames(nke7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countNKE <- nke7_abc %>% group_by(cSum) %>% count(n=n())
countNKE <- as.data.frame(countNKE)
countNKE <- countNKE[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countNKE$decr_Days <- countNKE$n-1
countNKE <- countNKE[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countNKE1 <- subset(countNKE, countNKE$decr_Days>0)
print('Decreasing Consecutive Days');summary(countNKE1$decr_Days)
print('*****************************************************************')

mxnke_d <- max(countNKE1$decr_Days)
mdnnke_d <- median(countNKE1$decr_Days)
q3nke_d <- as.numeric(as.character(summary(countNKE1$decr_Days)["3rd Qu."]))

#assign a 1 to decreasing values
nke7_b <- ifelse(NKE$today2lag7>1, 0,1)

nke7_b1 <- na.omit(nke7_b)

#counts the 
nke7_b2 <- cumsum(nke7_b1)

nke7_b3 <- as.data.frame(as.factor(nke7_b2))
colnames(nke7_b3) <- 'cSum'

countNKE2 <- nke7_b3 %>% group_by(cSum) %>% count(n=n())
countNKE2 <- as.data.frame(countNKE2)
countNKE2 <- countNKE2[,-3]

countNKE2$incr_Days <- countNKE2$n-1
countNKE2 <- countNKE2[,-2]

countNKE3 <- subset(countNKE2, countNKE2$incr_Days>0)
print('Increasing Consecutive Days');summary(countNKE3$incr_Days)

mxnke_i <- max(countNKE3$incr_Days)
mdnnke_i <- median(countNKE3$incr_Days)
q3nke_i <- as.numeric(as.character(summary(countNKE3$incr_Days)["3rd Qu."]))


nke_g <- grep('NKE',dROI17_lag7$DOW_down_median)

dROI17_lag7[nke_g,8:13] <- c(mdnnke_d,q3nke_d,mxnke_d,mdnnke_i,q3nke_i,mxnke_i)

```

PCG, Pacific Gas and Electric stats:
```{r}
PCG <- subset(Close17_dow, Close17_dow$DOW_down_median=='PCG')

#assign a 1 to increasing values
pcg7<- ifelse(PCG$today2lag7>1, 1,0)

pcg7_a <- na.omit(pcg7)

pcg7_ab <- cumsum(pcg7_a)

pcg7_abc <- as.data.frame(as.factor(pcg7_ab))
colnames(pcg7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countPCG <- pcg7_abc %>% group_by(cSum) %>% count(n=n())
countPCG <- as.data.frame(countPCG)
countPCG <- countPCG[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countPCG$decr_Days <- countPCG$n-1
countPCG <- countPCG[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countPCG1 <- subset(countPCG, countPCG$decr_Days>0)
print('Decreasing Consecutive Days');summary(countPCG1$decr_Days)
print('*****************************************************************')

mxpcg_d <- max(countPCG1$decr_Days)
mdnpcg_d <- median(countPCG1$decr_Days)
q3pcg_d <- as.numeric(as.character(summary(countPCG1$decr_Days)["3rd Qu."]))

#assign a 1 to decreasing values
pcg7_b <- ifelse(PCG$today2lag7>1, 0,1)

pcg7_b1 <- na.omit(pcg7_b)

#counts the 
pcg7_b2 <- cumsum(pcg7_b1)

pcg7_b3 <- as.data.frame(as.factor(pcg7_b2))
colnames(pcg7_b3) <- 'cSum'

countPCG2 <- pcg7_b3 %>% group_by(cSum) %>% count(n=n())
countPCG2 <- as.data.frame(countPCG2)
countPCG2 <- countPCG2[,-3]

countPCG2$incr_Days <- countPCG2$n-1
countPCG2 <- countPCG2[,-2]

countPCG3 <- subset(countPCG2, countPCG2$incr_Days>0)
print('Increasing Consecutive Days');summary(countPCG3$incr_Days)

mxpcg_i <- max(countPCG3$incr_Days)
mdnpcg_i <- median(countPCG3$incr_Days)
q3pcg_i <- as.numeric(as.character(summary(countPCG3$incr_Days)["3rd Qu."]))


pcg_g <- grep('PCG',dROI17_lag7$DOW_down_median)

dROI17_lag7[pcg_g,8:13] <- c(mdnpcg_d,q3pcg_d,mxpcg_d,mdnpcg_i,q3pcg_i,mxpcg_i)

```


ROST, Ross stores stats:
```{r}
ROST <- subset(Close17_dow, Close17_dow$DOW_down_median=='ROST')

#assign a 1 to increasing values
rost7<- ifelse(ROST$today2lag7>1, 1,0)

rost7_a <- na.omit(rost7)

rost7_ab <- cumsum(rost7_a)

rost7_abc <- as.data.frame(as.factor(rost7_ab))
colnames(rost7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countROST <- rost7_abc %>% group_by(cSum) %>% count(n=n())
countROST <- as.data.frame(countROST)
countROST <- countROST[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countROST$decr_Days <- countROST$n-1
countROST <- countROST[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countROST1 <- subset(countROST, countROST$decr_Days>0)
print('Decreasing Consecutive Days');summary(countROST1$decr_Days)
print('*****************************************************************')

mxrost_d <- max(countROST1$decr_Days)
mdnrost_d <- median(countROST1$decr_Days)
q3rost_d <- as.numeric(as.character(summary(countROST1$decr_Days)["3rd Qu."]))

#assign a 1 to decreasing values
rost7_b <- ifelse(ROST$today2lag7>1, 0,1)

rost7_b1 <- na.omit(rost7_b)

#counts the 
rost7_b2 <- cumsum(rost7_b1)

rost7_b3 <- as.data.frame(as.factor(rost7_b2))
colnames(rost7_b3) <- 'cSum'

countROST2 <- rost7_b3 %>% group_by(cSum) %>% count(n=n())
countROST2 <- as.data.frame(countROST2)
countROST2 <- countROST2[,-3]

countROST2$incr_Days <- countROST2$n-1
countROST2 <- countROST2[,-2]

countROST3 <- subset(countROST2, countROST2$incr_Days>0)
print('Increasing Consecutive Days');summary(countROST3$incr_Days)

mxrost_i <- max(countROST3$incr_Days)
mdnrost_i <- median(countROST3$incr_Days)
q3rost_i <- as.numeric(as.character(summary(countROST3$incr_Days)["3rd Qu."]))


rost_g <- grep('ROST',dROI17_lag7$DOW_down_median)

dROI17_lag7[rost_g,8:13] <- c(mdnrost_d,q3rost_d,mxrost_d,mdnrost_i,q3rost_i,mxrost_i)

```


TEVA, TEVA Pharmaceuticals stats:
```{r}
TEVA <- subset(Close17_dow, Close17_dow$DOW_down_median=='TEVA')

#assign a 1 to increasing values
teva7<- ifelse(TEVA$today2lag7>1, 1,0)

teva7_a <- na.omit(teva7)

teva7_ab <- cumsum(teva7_a)

teva7_abc <- as.data.frame(as.factor(teva7_ab))
colnames(teva7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countTEVA <- teva7_abc %>% group_by(cSum) %>% count(n=n())
countTEVA <- as.data.frame(countTEVA)
countTEVA <- countTEVA[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countTEVA$decr_Days <- countTEVA$n-1
countTEVA <- countTEVA[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countTEVA1 <- subset(countTEVA, countTEVA$decr_Days>0)
print('Decreasing Consecutive Days');summary(countTEVA1$decr_Days)
print('*****************************************************************')

mxteva_d <- max(countTEVA1$decr_Days)
mdnteva_d <- median(countTEVA1$decr_Days)
q3teva_d <- as.numeric(as.character(summary(countTEVA1$decr_Days)["3rd Qu."]))

#assign a 1 to decreasing values
teva7_b <- ifelse(TEVA$today2lag7>1, 0,1)

teva7_b1 <- na.omit(teva7_b)

#counts the 
teva7_b2 <- cumsum(teva7_b1)

teva7_b3 <- as.data.frame(as.factor(teva7_b2))
colnames(teva7_b3) <- 'cSum'

countTEVA2 <- teva7_b3 %>% group_by(cSum) %>% count(n=n())
countTEVA2 <- as.data.frame(countTEVA2)
countTEVA2 <- countTEVA2[,-3]

countTEVA2$incr_Days <- countTEVA2$n-1
countTEVA2 <- countTEVA2[,-2]

countTEVA3 <- subset(countTEVA2, countTEVA2$incr_Days>0)
print('Increasing Consecutive Days');summary(countTEVA3$incr_Days)

mxteva_i <- max(countTEVA3$incr_Days)
mdnteva_i <- median(countTEVA3$incr_Days)
q3teva_i <- as.numeric(as.character(summary(countTEVA3$incr_Days)["3rd Qu."]))


teva_g <- grep('TEVA',dROI17_lag7$DOW_down_median)

dROI17_lag7[teva_g,8:13] <- c(mdnteva_d,q3teva_d,mxteva_d,mdnteva_i,q3teva_i,mxteva_i)

```

TJX, TJ Maxx stores stats:
```{r}
TJX <- subset(Close17_dow, Close17_dow$DOW_down_median=='TJX')

#assign a 1 to increasing values
tjx7<- ifelse(TJX$today2lag7>1, 1,0)

tjx7_a <- na.omit(tjx7)

tjx7_ab <- cumsum(tjx7_a)

tjx7_abc <- as.data.frame(as.factor(tjx7_ab))
colnames(tjx7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countTJX <- tjx7_abc %>% group_by(cSum) %>% count(n=n())
countTJX <- as.data.frame(countTJX)
countTJX <- countTJX[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countTJX$decr_Days <- countTJX$n-1
countTJX <- countTJX[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countTJX1 <- subset(countTJX, countTJX$decr_Days>0)
print('Decreasing Consecutive Days');summary(countTJX1$decr_Days)
print('*****************************************************************')

mxtjx_d <- max(countTJX1$decr_Days)
mdntjx_d <- median(countTJX1$decr_Days)
q3tjx_d <- as.numeric(as.character(summary(countTJX1$decr_Days)["3rd Qu."]))

#assign a 1 to decreasing values
tjx7_b <- ifelse(TJX$today2lag7>1, 0,1)

tjx7_b1 <- na.omit(tjx7_b)

#counts the 
tjx7_b2 <- cumsum(tjx7_b1)

tjx7_b3 <- as.data.frame(as.factor(tjx7_b2))
colnames(tjx7_b3) <- 'cSum'

countTJX2 <- tjx7_b3 %>% group_by(cSum) %>% count(n=n())
countTJX2 <- as.data.frame(countTJX2)
countTJX2 <- countTJX2[,-3]

countTJX2$incr_Days <- countTJX2$n-1
countTJX2 <- countTJX2[,-2]

countTJX3 <- subset(countTJX2, countTJX2$incr_Days>0)
print('Increasing Consecutive Days');summary(countTJX3$incr_Days)

mxtjx_i <- max(countTJX3$incr_Days)
mdntjx_i <- median(countTJX3$incr_Days)
q3tjx_i <- as.numeric(as.character(summary(countTJX3$incr_Days)["3rd Qu."]))


tjx_g <- grep('TJX',dROI17_lag7$DOW_down_median)

dROI17_lag7[tjx_g,8:13] <- c(mdntjx_d,q3tjx_d,mxtjx_d,mdntjx_i,q3tjx_i,mxtjx_i)

```


WMT, Walmart Stores:
```{r}
WMT <- subset(Close17_dow, Close17_dow$DOW_down_median=='WMT')

#assign a 1 to increasing values
wmt7<- ifelse(WMT$today2lag7>1, 1,0)

wmt7_a <- na.omit(wmt7)

wmt7_ab <- cumsum(wmt7_a)

wmt7_abc <- as.data.frame(as.factor(wmt7_ab))
colnames(wmt7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countWMT <- wmt7_abc %>% group_by(cSum) %>% count(n=n())
countWMT <- as.data.frame(countWMT)
countWMT <- countWMT[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countWMT$decr_Days <- countWMT$n-1
countWMT <- countWMT[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countWMT1 <- subset(countWMT, countWMT$decr_Days>0)
print('Decreasing Consecutive Days');summary(countWMT1$decr_Days)
print('*****************************************************************')

mxwmt_d <- max(countWMT1$decr_Days)
mdnwmt_d <- median(countWMT1$decr_Days)
q3wmt_d <- as.numeric(as.character(summary(countWMT1$decr_Days)["3rd Qu."]))

#assign a 1 to decreasing values
wmt7_b <- ifelse(WMT$today2lag7>1, 0,1)

wmt7_b1 <- na.omit(wmt7_b)

#counts the 
wmt7_b2 <- cumsum(wmt7_b1)

wmt7_b3 <- as.data.frame(as.factor(wmt7_b2))
colnames(wmt7_b3) <- 'cSum'

countWMT2 <- wmt7_b3 %>% group_by(cSum) %>% count(n=n())
countWMT2 <- as.data.frame(countWMT2)
countWMT2 <- countWMT2[,-3]

countWMT2$incr_Days <- countWMT2$n-1
countWMT2 <- countWMT2[,-2]

countWMT3 <- subset(countWMT2, countWMT2$incr_Days>0)
print('Increasing Consecutive Days');summary(countWMT3$incr_Days)

mxwmt_i <- max(countWMT3$incr_Days)
mdnwmt_i <- median(countWMT3$incr_Days)
q3wmt_i <- as.numeric(as.character(summary(countWMT3$incr_Days)["3rd Qu."]))


wmt_g <- grep('WMT',dROI17_lag7$DOW_down_median)

dROI17_lag7[wmt_g,8:13] <- c(mdnwmt_d,q3wmt_d,mxwmt_d,mdnwmt_i,q3wmt_i,mxwmt_i)

```


XOM, Exxon Mobile gas:
```{r}
XOM <- subset(Close17_dow, Close17_dow$DOW_down_median=='XOM')

#assign a 1 to increasing values
xom7<- ifelse(XOM$today2lag7>1, 1,0)

xom7_a <- na.omit(xom7)

xom7_ab <- cumsum(xom7_a)

xom7_abc <- as.data.frame(as.factor(xom7_ab))
colnames(xom7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countXOM <- xom7_abc %>% group_by(cSum) %>% count(n=n())
countXOM <- as.data.frame(countXOM)
countXOM <- countXOM[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countXOM$decr_Days <- countXOM$n-1
countXOM <- countXOM[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countXOM1 <- subset(countXOM, countXOM$decr_Days>0)
print('Decreasing Consecutive Days');summary(countXOM1$decr_Days)
print('*****************************************************************')

mxxom_d <- max(countXOM1$decr_Days)
mdnxom_d <- median(countXOM1$decr_Days)
q3xom_d <- as.numeric(as.character(summary(countXOM1$decr_Days)["3rd Qu."]))

#assign a 1 to decreasing values
xom7_b <- ifelse(XOM$today2lag7>1, 0,1)

xom7_b1 <- na.omit(xom7_b)

#counts the 
xom7_b2 <- cumsum(xom7_b1)

xom7_b3 <- as.data.frame(as.factor(xom7_b2))
colnames(xom7_b3) <- 'cSum'

countXOM2 <- xom7_b3 %>% group_by(cSum) %>% count(n=n())
countXOM2 <- as.data.frame(countXOM2)
countXOM2 <- countXOM2[,-3]

countXOM2$incr_Days <- countXOM2$n-1
countXOM2 <- countXOM2[,-2]

countXOM3 <- subset(countXOM2, countXOM2$incr_Days>0)
print('Increasing Consecutive Days');summary(countXOM3$incr_Days)

mxxom_i <- max(countXOM3$incr_Days)
mdnxom_i <- median(countXOM3$incr_Days)
q3xom_i <- as.numeric(as.character(summary(countXOM3$incr_Days)["3rd Qu."]))


xom_g <- grep('XOM',dROI17_lag7$DOW_down_median)

dROI17_lag7[xom_g,8:13] <- c(mdnxom_d,q3xom_d,mxxom_d,mdnxom_i,q3xom_i,mxxom_i)

```



AAP, Advance Auto Parts:
```{r}
AAP <- subset(Close17_dow, Close17_dow$DOW_down_median=='AAP')

#assign a 1 to increasing values
aap7<- ifelse(AAP$today2lag7>1, 1,0)

aap7_a <- na.omit(aap7)

aap7_ab <- cumsum(aap7_a)

aap7_abc <- as.data.frame(as.factor(aap7_ab))
colnames(aap7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countAAP <- aap7_abc %>% group_by(cSum) %>% count(n=n())
countAAP <- as.data.frame(countAAP)
countAAP <- countAAP[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countAAP$decr_Days <- countAAP$n-1
countAAP <- countAAP[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countAAP1 <- subset(countAAP, countAAP$decr_Days>0)
print('Decreasing Consecutive Days');summary(countAAP1$decr_Days)
print('*****************************************************************')

mxaap_d <- max(countAAP1$decr_Days)
mdnaap_d <- median(countAAP1$decr_Days)
q3aap_d <- as.numeric(as.character(summary(countAAP1$decr_Days)["3rd Qu."]))

#assign a 1 to decreasing values
aap7_b <- ifelse(AAP$today2lag7>1, 0,1)

aap7_b1 <- na.omit(aap7_b)

#counts the 
aap7_b2 <- cumsum(aap7_b1)

aap7_b3 <- as.data.frame(as.factor(aap7_b2))
colnames(aap7_b3) <- 'cSum'

countAAP2 <- aap7_b3 %>% group_by(cSum) %>% count(n=n())
countAAP2 <- as.data.frame(countAAP2)
countAAP2 <- countAAP2[,-3]

countAAP2$incr_Days <- countAAP2$n-1
countAAP2 <- countAAP2[,-2]

countAAP3 <- subset(countAAP2, countAAP2$incr_Days>0)
print('Increasing Consecutive Days');summary(countAAP3$incr_Days)

mxaap_i <- max(countAAP3$incr_Days)
mdnaap_i <- median(countAAP3$incr_Days)
q3aap_i <- as.numeric(as.character(summary(countAAP3$incr_Days)["3rd Qu."]))


aap_g <- grep('AAP',dROI17_lag7$DOW_down_median)

dROI17_lag7[aap_g,8:13] <- c(mdnaap_d,q3aap_d,mxaap_d,mdnaap_i,q3aap_i,mxaap_i)

```


ADDYY, Adidas Sports Attire and shoes:
```{r}
ADDYY <- subset(Close17_dow, Close17_dow$DOW_down_median=='ADDYY')

#assign a 1 to increasing values
addyy7<- ifelse(ADDYY$today2lag7>1, 1,0)

addyy7_a <- na.omit(addyy7)

addyy7_ab <- cumsum(addyy7_a)

addyy7_abc <- as.data.frame(as.factor(addyy7_ab))
colnames(addyy7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countADDYY <- addyy7_abc %>% group_by(cSum) %>% count(n=n())
countADDYY <- as.data.frame(countADDYY)
countADDYY <- countADDYY[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countADDYY$decr_Days <- countADDYY$n-1
countADDYY <- countADDYY[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countADDYY1 <- subset(countADDYY, countADDYY$decr_Days>0)
print('Decreasing Consecutive Days');summary(countADDYY1$decr_Days)
print('*****************************************************************')

mxaddyy_d <- max(countADDYY1$decr_Days)
mdnaddyy_d <- median(countADDYY1$decr_Days)
q3addyy_d <- as.numeric(as.character(summary(countADDYY1$decr_Days)["3rd Qu."]))

#assign a 1 to decreasing values
addyy7_b <- ifelse(ADDYY$today2lag7>1, 0,1)

addyy7_b1 <- na.omit(addyy7_b)

#counts the 
addyy7_b2 <- cumsum(addyy7_b1)

addyy7_b3 <- as.data.frame(as.factor(addyy7_b2))
colnames(addyy7_b3) <- 'cSum'

countADDYY2 <- addyy7_b3 %>% group_by(cSum) %>% count(n=n())
countADDYY2 <- as.data.frame(countADDYY2)
countADDYY2 <- countADDYY2[,-3]

countADDYY2$incr_Days <- countADDYY2$n-1
countADDYY2 <- countADDYY2[,-2]

countADDYY3 <- subset(countADDYY2, countADDYY2$incr_Days>0)
print('Increasing Consecutive Days');summary(countADDYY3$incr_Days)

mxaddyy_i <- max(countADDYY3$incr_Days)
mdnaddyy_i <- median(countADDYY3$incr_Days)
q3addyy_i <- as.numeric(as.character(summary(countADDYY3$incr_Days)["3rd Qu."]))


addyy_g <- grep('ADDYY',dROI17_lag7$DOW_down_median)

dROI17_lag7[addyy_g,8:13] <- c(mdnaddyy_d,q3addyy_d,mxaddyy_d,mdnaddyy_i,q3addyy_i,mxaddyy_i)

```


AMZN, Amazon:
```{r}
AMZN <- subset(Close17_dow, Close17_dow$DOW_down_median=='AMZN')

#assign a 1 to increasing values
amzn7<- ifelse(AMZN$today2lag7>1, 1,0)

amzn7_a <- na.omit(amzn7)

amzn7_ab <- cumsum(amzn7_a)

amzn7_abc <- as.data.frame(as.factor(amzn7_ab))
colnames(amzn7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countAMZN <- amzn7_abc %>% group_by(cSum) %>% count(n=n())
countAMZN <- as.data.frame(countAMZN)
countAMZN <- countAMZN[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countAMZN$decr_Days <- countAMZN$n-1
countAMZN <- countAMZN[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countAMZN1 <- subset(countAMZN, countAMZN$decr_Days>0)
print('Decreasing Consecutive Days');summary(countAMZN1$decr_Days)
print('*****************************************************************')

mxamzn_d <- max(countAMZN1$decr_Days)
mdnamzn_d <- median(countAMZN1$decr_Days)
q3amzn_d <- as.numeric(as.character(summary(countAMZN1$decr_Days)["3rd Qu."]))

#assign a 1 to decreasing values
amzn7_b <- ifelse(AMZN$today2lag7>1, 0,1)

amzn7_b1 <- na.omit(amzn7_b)

#counts the 
amzn7_b2 <- cumsum(amzn7_b1)

amzn7_b3 <- as.data.frame(as.factor(amzn7_b2))
colnames(amzn7_b3) <- 'cSum'

countAMZN2 <- amzn7_b3 %>% group_by(cSum) %>% count(n=n())
countAMZN2 <- as.data.frame(countAMZN2)
countAMZN2 <- countAMZN2[,-3]

countAMZN2$incr_Days <- countAMZN2$n-1
countAMZN2 <- countAMZN2[,-2]

countAMZN3 <- subset(countAMZN2, countAMZN2$incr_Days>0)
print('Increasing Consecutive Days');summary(countAMZN3$incr_Days)

mxamzn_i <- max(countAMZN3$incr_Days)
mdnamzn_i <- median(countAMZN3$incr_Days)
q3amzn_i <- as.numeric(as.character(summary(countAMZN3$incr_Days)["3rd Qu."]))


amzn_g <- grep('AMZN',dROI17_lag7$DOW_down_median)

dROI17_lag7[amzn_g,8:13] <- c(mdnamzn_d,q3amzn_d,mxamzn_d,mdnamzn_i,q3amzn_i,mxamzn_i)

```


COST, Costco Stores:
```{r}
COST <- subset(Close17_dow, Close17_dow$DOW_down_median=='COST')

#assign a 1 to increasing values
cost7<- ifelse(COST$today2lag7>1, 1,0)

cost7_a <- na.omit(cost7)

cost7_ab <- cumsum(cost7_a)

cost7_abc <- as.data.frame(as.factor(cost7_ab))
colnames(cost7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countCOST <- cost7_abc %>% group_by(cSum) %>% count(n=n())
countCOST <- as.data.frame(countCOST)
countCOST <- countCOST[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countCOST$decr_Days <- countCOST$n-1
countCOST <- countCOST[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countCOST1 <- subset(countCOST, countCOST$decr_Days>0)
print('Decreasing Consecutive Days');summary(countCOST1$decr_Days)
print('*****************************************************************')

mxcost_d <- max(countCOST1$decr_Days)
mdncost_d <- median(countCOST1$decr_Days)
q3cost_d <- as.numeric(as.character(summary(countCOST1$decr_Days)["3rd Qu."]))

#assign a 1 to decreasing values
cost7_b <- ifelse(COST$today2lag7>1, 0,1)

cost7_b1 <- na.omit(cost7_b)

#counts the 
cost7_b2 <- cumsum(cost7_b1)

cost7_b3 <- as.data.frame(as.factor(cost7_b2))
colnames(cost7_b3) <- 'cSum'

countCOST2 <- cost7_b3 %>% group_by(cSum) %>% count(n=n())
countCOST2 <- as.data.frame(countCOST2)
countCOST2 <- countCOST2[,-3]

countCOST2$incr_Days <- countCOST2$n-1
countCOST2 <- countCOST2[,-2]

countCOST3 <- subset(countCOST2, countCOST2$incr_Days>0)
print('Increasing Consecutive Days');summary(countCOST3$incr_Days)

mxcost_i <- max(countCOST3$incr_Days)
mdncost_i <- median(countCOST3$incr_Days)
q3cost_i <- as.numeric(as.character(summary(countCOST3$incr_Days)["3rd Qu."]))


cost_g <- grep('COST',dROI17_lag7$DOW_down_median)

dROI17_lag7[cost_g,8:13] <- c(mdncost_d,q3cost_d,mxcost_d,mdncost_i,q3cost_i,mxcost_i)

```


DLTR, Dollar Tree Stores:
```{r}
DLTR <- subset(Close17_dow, Close17_dow$DOW_down_median=='DLTR')

#assign a 1 to increasing values
dltr7<- ifelse(DLTR$today2lag7>1, 1,0)

dltr7_a <- na.omit(dltr7)

dltr7_ab <- cumsum(dltr7_a)

dltr7_abc <- as.data.frame(as.factor(dltr7_ab))
colnames(dltr7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countDLTR <- dltr7_abc %>% group_by(cSum) %>% count(n=n())
countDLTR <- as.data.frame(countDLTR)
countDLTR <- countDLTR[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countDLTR$decr_Days <- countDLTR$n-1
countDLTR <- countDLTR[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countDLTR1 <- subset(countDLTR, countDLTR$decr_Days>0)
print('Decreasing Consecutive Days');summary(countDLTR1$decr_Days)
print('*****************************************************************')

mxdltr_d <- max(countDLTR1$decr_Days)
mdndltr_d <- median(countDLTR1$decr_Days)
q3dltr_d <- as.numeric(as.character(summary(countDLTR1$decr_Days)["3rd Qu."]))

#assign a 1 to decreasing values
dltr7_b <- ifelse(DLTR$today2lag7>1, 0,1)

dltr7_b1 <- na.omit(dltr7_b)

#counts the 
dltr7_b2 <- cumsum(dltr7_b1)

dltr7_b3 <- as.data.frame(as.factor(dltr7_b2))
colnames(dltr7_b3) <- 'cSum'

countDLTR2 <- dltr7_b3 %>% group_by(cSum) %>% count(n=n())
countDLTR2 <- as.data.frame(countDLTR2)
countDLTR2 <- countDLTR2[,-3]

countDLTR2$incr_Days <- countDLTR2$n-1
countDLTR2 <- countDLTR2[,-2]

countDLTR3 <- subset(countDLTR2, countDLTR2$incr_Days>0)
print('Increasing Consecutive Days');summary(countDLTR3$incr_Days)

mxdltr_i <- max(countDLTR3$incr_Days)
mdndltr_i <- median(countDLTR3$incr_Days)
q3dltr_i <- as.numeric(as.character(summary(countDLTR3$incr_Days)["3rd Qu."]))


dltr_g <- grep('DLTR',dROI17_lag7$DOW_down_median)

dROI17_lag7[dltr_g,8:13] <- c(mdndltr_d,q3dltr_d,mxdltr_d,mdndltr_i,q3dltr_i,mxdltr_i)

```

Now that we have our cumulative number of days in lag7 stock value prices that the stock decreases or increases in our best performing stock portfolio of 17 stocks that had positive median stock values when the DOW was down and unemployment up, lets add a field to classify whether the stock is low or high based on the Costco stock ROI of 6.02, which was the median stock ROI of this portfolio.
```{r}
dROI17_lag7$ROI_Low_High <- ifelse(dROI17_lag7$stock_ROI <= 6.02, 'Low', 'High')
dROI17_lag7
```

The table we extracted these stock is from the Close2 table.This table has all the dates because it wasn't combined with the UE table rates that also kept complete cases. 
```{r}
colnames(Close2)

```


There are 36 more stock in our entire portfolio of stocks with values from 2007-2020 that we could also get these feature characteristics for. But for now lets just add a field to the table we derived these 17 stock from by stock closing value, take the overall return on investment for each of the remaining 36 stocks, and add in the ROI class of 'Low' or 'High' to that table. Then separate into training and testing sets and use machine learning to predict the outcome of the stock being low or high in ROI ratio of start value to final value of the stock according to the initial and final prices of each stock in our time series.

Lets keep only the date field and all the stocks in our Close2 table.
```{r}
Close53 <- Close2[,-c(1,55:58,60:63)]

colnames(Close53) <- gsub('.Close','', colnames(Close53))
colnames(Close53) <- gsub('.PB', '', colnames(Close53))
colnames(Close53)
```

Make a mini table of start and final values to get our ROI for each stock.
```{r}
Close53$Date <- as.Date(Close53$Date)
row.names(Close53) <- Close53$Date

start <- subset(Close53, Close53$Date==START_DATE)
row.names(start) <- 'startValueYear'
end <- subset(Close53, Close53$Date==END_DATE)
row.names(end) <- 'endValueYear'

Close53_roi <- rbind(start,end)

Close53_roi_t <- as.data.frame(t(Close53_roi[1:53]))

Close53_roi_t$stock_ROI_Year <-
  round(Close53_roi_t$endValueYear/Close53_roi_t$startValueYear,2)

Close53_roi_t$ROI_Low_High_Year <- ifelse(Close53_roi_t$stock_ROI_Year <= 2, 'Low', 'High')

Close53_roi_t$stockName <- as.factor(row.names(Close53_roi_t))

colnames(Close53_roi_t) <- gsub('Year', year(as.Date(START_DATE)), colnames(Close53_roi_t))

Close53_b <- Close53_roi_t[,-c(1:2)]

Close53_g <- gather(Close53, 'stockName','stockDayValue',1:53)

Close53_g$stockName <- as.factor(Close53_g$stockName)

Close53_r <- merge(Close53_g, Close53_b, by.x='stockName', by.y='stockName')
Close53_r2 <- merge(Close53_g, Close53_roi_t, by.x='stockName', by.y='stockName')

write.csv(Close53_roi_t, paste(paste('Close53_roi'
                                     ,year(as.Date(START_DATE)),sep='_'),'csv',sep='.'),
                               row.names=TRUE)

```



```{r}
dROI17_lag7$medn_cSum_decr_L7 <- as.numeric(dROI17_lag7$medn_cSum_decr_L7)
dROI17_lag7$Q3_cSum_decr_L7 <- as.numeric(dROI17_lag7$Q3_cSum_decr_L7)
dROI17_lag7$max_cSum_decr_L7 <- as.numeric(dROI17_lag7$max_cSum_decr_L7)
dROI17_lag7$medn_cSum_incr_L7 <- as.numeric(dROI17_lag7$medn_cSum_incr_L7)
dROI17_lag7$Q3_cSum_incr_L7 <- as.numeric(dROI17_lag7$Q3_cSum_incr_L7)
dROI17_lag7$max_cSum_incr_L7 <- as.numeric(dROI17_lag7$max_cSum_incr_L7)

dROI17_lag7$DOW_down_median <- as.factor(dROI17_lag7$DOW_down_median)
dROI17_lag7$ROI_Low_High <- as.factor(dROI17_lag7$ROI_Low_High)

```


This is a mixed data table of numeric and factor features. Lets remove the stockBeatsDow feature.
```{r}
dROI17_lag7_b <- dROI17_lag7[,-7]
dROI17_lag7_b
```


Lets make the row names of the dROI17_lag7_b table the DOW_down_median factor type feature, then remove that field from the table.
```{r, warning=FALSE}
names <- as.character(dROI17_lag7_b$DOW_down_median)
dROI17_lag7_c <- dROI17_lag7_b[,-1]
row.names(dROI17_lag7_c) <- names 

dROI17_lag7_d <- round(dROI17_lag7_c[1:11],2)
row.names(dROI17_lag7_d) <- names
ROI_17 <- cbind(dROI17_lag7_d, dROI17_lag7_c[12])
ROI_17
```




Lets start by making a list of those stocks we already have lag values for.
```{r}
colnames(Close53)
```

```{r}
row.names(dROI17_lag7_d)
```

The remaining stocks we need to add lagfields to, and then get the lag7 information for each stock as we did above on our machine learning data set of the 17 stocks in the best performing portfolio of stocks that had positive median daily value changes when the DOW was down and unemployment was up from the previous month.
```{r}
remaining <- colnames(Close53)[c(1:3,5,7:9,11:15,18:22,24:26,28:31,34,40,41,43:46,49:53)]
remaining

```


```{r}
#this is the list of stocks that we need, and we need to drop the 17 we already analyzed
Remaining <- as.data.frame(remaining)
colnames(Remaining) <- 'stockName'

#make all the stock name columns one field of stock names
df36 <- gather(Close53, 'stockName','stockDayValue',1:53)

#merge the names of the remaining stock and the total stocks to keep only the ones needed
DF_36 <- merge(Remaining,df36, by.x='stockName', by.y='stockName')

#spread out the stock names into columns after getting only the stocks needed for adding stats
#from the 53 total, and 17 completed.
remaining36 <- spread(DF_36,'stockName','stockDayValue')

#order by date
remaining36 <- remaining36[order(remaining36$Date),]

```



***
***
***


Add the 7 day lag then add the ratio of each day's stock value to the lag. Then get the counts of cumulative days the ratio increased and decreased. Then add the max, median, and 3rd quantile stats of those cumulative day counts for increased and decreased.

```{r}
remaining36_g <- gather(remaining36, 'stockName','stockDayValue',2:37) 
```

```{r}
remaining36_g <- remaining36_g[with(remaining36_g, order(stockName, Date)),]

Laal <- subset(remaining36_g, remaining36_g$stockName=='AAL')
Larwr <- subset(remaining36_g, remaining36_g$stockName=='ARWR')
Lc <- subset(remaining36_g, remaining36_g$stockName=='C')
Lcvx <- subset(remaining36_g, remaining36_g$stockName=='CVX')
Lepd <- subset(remaining36_g, remaining36_g$stockName=='EPD')
Lf <- subset(remaining36_g, remaining36_g$stockName=='F')
Lftr <- subset(remaining36_g, remaining36_g$stockName=='FTR')
Lhmc <- subset(remaining36_g, remaining36_g$stockName=='HMC')
Lhoft <- subset(remaining36_g, remaining36_g$stockName=='HOFT')
Lhrb <- subset(remaining36_g, remaining36_g$stockName=='HRB')
Lhst <- subset(remaining36_g, remaining36_g$stockName=='HST')
Lino <- subset(remaining36_g, remaining36_g$stockName=='INO')
Ljblu <- subset(remaining36_g, remaining36_g$stockName=='JBLU')
Ljpm <- subset(remaining36_g, remaining36_g$stockName=='JPM')
Ljwn <- subset(remaining36_g, remaining36_g$stockName=='JWN')
Lkgji <- subset(remaining36_g, remaining36_g$stockName=='KGJI')
Lkss <- subset(remaining36_g, remaining36_g$stockName=='KSS')
Lluv <- subset(remaining36_g, remaining36_g$stockName=='LUV')
Lm <- subset(remaining36_g, remaining36_g$stockName=='M')
Lmgm <- subset(remaining36_g, remaining36_g$stockName=='MGM')
Lmsft <- subset(remaining36_g, remaining36_g$stockName=='MSFT')
Lnsany <- subset(remaining36_g, remaining36_g$stockName=='NSANY')
Lnus <- subset(remaining36_g, remaining36_g$stockName=='NUS')
Loncy <- subset(remaining36_g, remaining36_g$stockName=='ONCY')
Lrrgb <- subset(remaining36_g, remaining36_g$stockName=='RRGB')
Ls <- subset(remaining36_g, remaining36_g$stockName=='S')
Lsce <- subset(remaining36_g, remaining36_g$stockName=='SCE')
Lsig <- subset(remaining36_g, remaining36_g$stockName=='SIG')
Lt <- subset(remaining36_g, remaining36_g$stockName=='T')
Ltgt <- subset(remaining36_g, remaining36_g$stockName=='TGT')
Ltm <- subset(remaining36_g, remaining36_g$stockName=='TM')
Lubsi <- subset(remaining36_g, remaining36_g$stockName=='UBSI')
Lvz <- subset(remaining36_g, remaining36_g$stockName=='VZ')
Lwfc <- subset(remaining36_g, remaining36_g$stockName=='WFC')
Lwm <- subset(remaining36_g, remaining36_g$stockName=='WM')
Lwwe <- subset(remaining36_g, remaining36_g$stockName=='WWE')

aalL7 <- lag(Laal$stockDayValue,7)
arwrL7 <- lag(Larwr$stockDayValue,7)
cL7 <- lag(Lc$stockDayValue,7)
cvxL7 <- lag(Lcvx$stockDayValue,7)
epdL7 <- lag(Lepd$stockDayValue,7)
fL7 <- lag(Lf$stockDayValue,7)
ftrL7 <- lag(Lftr$stockDayValue,7)
hmcL7 <- lag(Lhmc$stockDayValue,7)
hoftL7 <- lag(Lhoft$stockDayValue,7)
hrbL7 <- lag(Lhrb$stockDayValue,7)
hstL7 <- lag(Lhst$stockDayValue,7)
inoL7 <- lag(Lino$stockDayValue,7)
jbluL7 <- lag(Ljblu$stockDayValue,7)
jpmL7 <- lag(Ljpm$stockDayValue,7)
jwnL7 <- lag(Ljwn$stockDayValue,7)
kgjiL7 <- lag(Lkgji$stockDayValue,7)
kssL7 <- lag(Lkss$stockDayValue,7)
luvL7 <- lag(Lluv$stockDayValue,7)
mL7 <- lag(Lm$stockDayValue,7)
mgmL7 <- lag(Lmgm$stockDayValue,7)
msftL7 <- lag(Lmsft$stockDayValue,7)
nsanyL7 <- lag(Lnsany$stockDayValue,7)
nusL7 <- lag(Lnus$stockDayValue,7)
oncyL7 <- lag(Loncy$stockDayValue,7)
rrgbL7 <- lag(Lrrgb$stockDayValue,7)
sL7 <- lag(Ls$stockDayValue,7)
sceL7 <- lag(Lsce$stockDayValue,7)
sigL7 <- lag(Lsig$stockDayValue,7)
tL7 <- lag(Lt$stockDayValue,7)
tgtL7 <- lag(Ltgt$stockDayValue,7)
tmL7 <- lag(Ltm$stockDayValue,7)
ubsiL7 <- lag(Lubsi$stockDayValue,7)
vzL7 <- lag(Lvz$stockDayValue,7)
wfcL7 <- lag(Lwfc$stockDayValue,7)
wmL7 <- lag(Lwm$stockDayValue,7)
wweL7 <- lag(Lwwe$stockDayValue,7)

remaining36_g$lag7 <- c(aalL7,arwrL7,cL7,cvxL7,epdL7,fL7,ftrL7,
                                  hmcL7,hoftL7,hrbL7,hstL7,inoL7,jbluL7,jpmL7,
                                  jwnL7,kgjiL7,kssL7,luvL7,mL7,mgmL7,msftL7,nsanyL7,nusL7,oncyL7,
                                  rrgbL7,sL7,sceL7,sigL7,tL7,tgtL7,tmL7,
                                  ubsiL7,vzL7,wfcL7,wmL7,wweL7)
#the dataset is ordered by stock then by date, so this works with matching,
#NAs are present when no data in dataset before that date, and the today2lag7
#will also have NAs in those instances
remaining36_g$today2lag7 <- remaining36_g$lag7/remaining36_g$stockDayValue

```

***

```{r}
AAL <- subset(remaining36_g, remaining36_g$stockName=='AAL')

AAL <- AAL[complete.cases(AAL),]

aal7_a <- ifelse(AAL$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for aal7 <- <- ifelse(AAL$today2lag7>1, 1,0)
aal7_ab <- cumsum(aal7_a)

aal7_abc <- as.data.frame(as.factor(aal7_ab))
colnames(aal7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countAAL <- aal7_abc %>% group_by(cSum) %>% count(n=n())
countAAL <- as.data.frame(countAAL)
countAAL <- countAAL[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countAAL$aal7_decr_Days <- countAAL$n-1
countAAL <- countAAL[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countAAL2 <- subset(countAAL, countAAL$aal7_decr_Days>0)
summary(countAAL2$aal7_decr_Days)


# this table shows how many sets of cumulative days decreasing there were in lag 7
aal7_decr_Days_grouped <- countAAL2 %>% group_by(aal7_decr_Days) %>% count(n=n())
aal7_decr_Days_grouped <- aal7_decr_Days_grouped[,-3]
```

```{r}
aal7_decr_Days_grouped
```

```{r}

median(aal7_decr_Days_grouped$aal7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
aal7_b1 <- ifelse(AAL$today2lag7>1, 0,1)


aal7_b2 <- cumsum(aal7_b1)

aal7_b3 <- as.data.frame(as.factor(aal7_b2))
colnames(aal7_b3) <- 'cSum'

countAAL1 <- aal7_b3 %>% group_by(cSum) %>% count(n=n())
countAAL1 <- as.data.frame(countAAL1)
countAAL1 <- countAAL1[,-3]

countAAL1$aal7_incr_Days <- countAAL1$n-1
countAAL1 <- countAAL1[,-2]

countAAL3 <- subset(countAAL1, countAAL1$aal7_incr_Days>0)
summary(countAAL3$aal7_incr_Days)

aal7_incr_Days_grouped <- countAAL3 %>% group_by(aal7_incr_Days) %>% count(n=n())
aal7_incr_Days_grouped <- aal7_incr_Days_grouped[,-3]
```

```{r}
aal7_incr_Days_grouped
```

```{r}
median(aal7_incr_Days_grouped$aal7_incr_Days)
```


***



```{r}
ARWR <- subset(remaining36_g, remaining36_g$stockName=='ARWR')

ARWR <- ARWR[complete.cases(ARWR),]

arwr7_a <- ifelse(ARWR$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for arwr7 <- <- ifelse(ARWR$today2lag7>1, 1,0)
arwr7_ab <- cumsum(arwr7_a)

arwr7_abc <- as.data.frame(as.factor(arwr7_ab))
colnames(arwr7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countARWR <- arwr7_abc %>% group_by(cSum) %>% count(n=n())
countARWR <- as.data.frame(countARWR)
countARWR <- countARWR[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countARWR$arwr7_decr_Days <- countARWR$n-1
countARWR <- countARWR[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countARWR2 <- subset(countARWR, countARWR$arwr7_decr_Days>0)
summary(countARWR2$arwr7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
arwr7_decr_Days_grouped <- countARWR2 %>% group_by(arwr7_decr_Days) %>% count(n=n())
arwr7_decr_Days_grouped <- arwr7_decr_Days_grouped[,-3]
```

```{r}
arwr7_decr_Days_grouped
```

```{r}

median(arwr7_decr_Days_grouped$arwr7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
arwr7_b1 <- ifelse(ARWR$today2lag7>1, 0,1)


arwr7_b2 <- cumsum(arwr7_b1)

arwr7_b3 <- as.data.frame(as.factor(arwr7_b2))
colnames(arwr7_b3) <- 'cSum'

countARWR1 <- arwr7_b3 %>% group_by(cSum) %>% count(n=n())
countARWR1 <- as.data.frame(countARWR1)
countARWR1 <- countARWR1[,-3]

countARWR1$arwr7_incr_Days <- countARWR1$n-1
countARWR1 <- countARWR1[,-2]

countARWR3 <- subset(countARWR1, countARWR1$arwr7_incr_Days>0)
summary(countARWR3$arwr7_incr_Days)

arwr7_incr_Days_grouped <- countARWR3 %>% group_by(arwr7_incr_Days) %>% count(n=n())
arwr7_incr_Days_grouped <- arwr7_incr_Days_grouped[,-3]
```

```{r}
arwr7_incr_Days_grouped
```

```{r}
median(arwr7_incr_Days_grouped$arwr7_incr_Days)
```


***
 
```{r}
C <- subset(remaining36_g, remaining36_g$stockName=='C')

C <- C[complete.cases(C),]

c7_a <- ifelse(C$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for c7 <- <- ifelse(C$today2lag7>1, 1,0)
c7_ab <- cumsum(c7_a)

c7_abc <- as.data.frame(as.factor(c7_ab))
colnames(c7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countC <- c7_abc %>% group_by(cSum) %>% count(n=n())
countC <- as.data.frame(countC)
countC <- countC[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countC$c7_decr_Days <- countC$n-1
countC <- countC[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countC2 <- subset(countC, countC$c7_decr_Days>0)
summary(countC2$c7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
c7_decr_Days_grouped <- countC2 %>% group_by(c7_decr_Days) %>% count(n=n())
c7_decr_Days_grouped <- c7_decr_Days_grouped[,-3]
```

```{r}
c7_decr_Days_grouped
```

```{r}

median(c7_decr_Days_grouped$c7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
c7_b1 <- ifelse(C$today2lag7>1, 0,1)


c7_b2 <- cumsum(c7_b1)

c7_b3 <- as.data.frame(as.factor(c7_b2))
colnames(c7_b3) <- 'cSum'

countC1 <- c7_b3 %>% group_by(cSum) %>% count(n=n())
countC1 <- as.data.frame(countC1)
countC1 <- countC1[,-3]

countC1$c7_incr_Days <- countC1$n-1
countC1 <- countC1[,-2]

countC3 <- subset(countC1, countC1$c7_incr_Days>0)
summary(countC3$c7_incr_Days)

c7_incr_Days_grouped <- countC3 %>% group_by(c7_incr_Days) %>% count(n=n())
c7_incr_Days_grouped <- c7_incr_Days_grouped[,-3]
```

```{r}
c7_incr_Days_grouped
```

```{r}
median(c7_incr_Days_grouped$c7_incr_Days)
```
 
***

```{r}
CVX <- subset(remaining36_g, remaining36_g$stockName=='CVX')

CVX <- CVX[complete.cases(CVX),]

cvx7_a <- ifelse(CVX$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for cvx7 <- <- ifelse(CVX$today2lag7>1, 1,0)
cvx7_ab <- cumsum(cvx7_a)

cvx7_abc <- as.data.frame(as.factor(cvx7_ab))
colnames(cvx7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countCVX <- cvx7_abc %>% group_by(cSum) %>% count(n=n())
countCVX <- as.data.frame(countCVX)
countCVX <- countCVX[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countCVX$cvx7_decr_Days <- countCVX$n-1
countCVX <- countCVX[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countCVX2 <- subset(countCVX, countCVX$cvx7_decr_Days>0)
summary(countCVX2$cvx7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
cvx7_decr_Days_grouped <- countCVX2 %>% group_by(cvx7_decr_Days) %>% count(n=n())
cvx7_decr_Days_grouped <- cvx7_decr_Days_grouped[,-3]
```

```{r}
cvx7_decr_Days_grouped
```

```{r}

median(cvx7_decr_Days_grouped$cvx7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
cvx7_b1 <- ifelse(CVX$today2lag7>1, 0,1)


cvx7_b2 <- cumsum(cvx7_b1)

cvx7_b3 <- as.data.frame(as.factor(cvx7_b2))
colnames(cvx7_b3) <- 'cSum'

countCVX1 <- cvx7_b3 %>% group_by(cSum) %>% count(n=n())
countCVX1 <- as.data.frame(countCVX1)
countCVX1 <- countCVX1[,-3]

countCVX1$cvx7_incr_Days <- countCVX1$n-1
countCVX1 <- countCVX1[,-2]

countCVX3 <- subset(countCVX1, countCVX1$cvx7_incr_Days>0)
summary(countCVX3$cvx7_incr_Days)

cvx7_incr_Days_grouped <- countCVX3 %>% group_by(cvx7_incr_Days) %>% count(n=n())
cvx7_incr_Days_grouped <- cvx7_incr_Days_grouped[,-3]
```

```{r}
cvx7_incr_Days_grouped
```

```{r}
median(cvx7_incr_Days_grouped$cvx7_incr_Days)
```

***


```{r}
EPD <- subset(remaining36_g, remaining36_g$stockName=='EPD')

EPD <- EPD[complete.cases(EPD),]

epd7_a <- ifelse(EPD$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for epd7 <- <- ifelse(EPD$today2lag7>1, 1,0)
epd7_ab <- cumsum(epd7_a)

epd7_abc <- as.data.frame(as.factor(epd7_ab))
colnames(epd7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countEPD <- epd7_abc %>% group_by(cSum) %>% count(n=n())
countEPD <- as.data.frame(countEPD)
countEPD <- countEPD[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countEPD$epd7_decr_Days <- countEPD$n-1
countEPD <- countEPD[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countEPD2 <- subset(countEPD, countEPD$epd7_decr_Days>0)
summary(countEPD2$epd7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
epd7_decr_Days_grouped <- countEPD2 %>% group_by(epd7_decr_Days) %>% count(n=n())
epd7_decr_Days_grouped <- epd7_decr_Days_grouped[,-3]
```

```{r}
epd7_decr_Days_grouped
```

```{r}

median(epd7_decr_Days_grouped$epd7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
epd7_b1 <- ifelse(EPD$today2lag7>1, 0,1)


epd7_b2 <- cumsum(epd7_b1)

epd7_b3 <- as.data.frame(as.factor(epd7_b2))
colnames(epd7_b3) <- 'cSum'

countEPD1 <- epd7_b3 %>% group_by(cSum) %>% count(n=n())
countEPD1 <- as.data.frame(countEPD1)
countEPD1 <- countEPD1[,-3]

countEPD1$epd7_incr_Days <- countEPD1$n-1
countEPD1 <- countEPD1[,-2]

countEPD3 <- subset(countEPD1, countEPD1$epd7_incr_Days>0)
summary(countEPD3$epd7_incr_Days)

epd7_incr_Days_grouped <- countEPD3 %>% group_by(epd7_incr_Days) %>% count(n=n())
epd7_incr_Days_grouped <- epd7_incr_Days_grouped[,-3]
```

```{r}
epd7_incr_Days_grouped
```

```{r}
median(epd7_incr_Days_grouped$epd7_incr_Days)
```


***


```{r}
F <- subset(remaining36_g, remaining36_g$stockName=='F')

F <- F[complete.cases(F),]

f7_a <- ifelse(F$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for f7 <- <- ifelse(F$today2lag7>1, 1,0)
f7_ab <- cumsum(f7_a)

f7_abc <- as.data.frame(as.factor(f7_ab))
colnames(f7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countF <- f7_abc %>% group_by(cSum) %>% count(n=n())
countF <- as.data.frame(countF)
countF <- countF[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countF$f7_decr_Days <- countF$n-1
countF <- countF[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countF2 <- subset(countF, countF$f7_decr_Days>0)
summary(countF2$f7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
f7_decr_Days_grouped <- countF2 %>% group_by(f7_decr_Days) %>% count(n=n())
f7_decr_Days_grouped <- f7_decr_Days_grouped[,-3]
```

```{r}
f7_decr_Days_grouped
```

```{r}

median(f7_decr_Days_grouped$f7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
f7_b1 <- ifelse(F$today2lag7>1, 0,1)


f7_b2 <- cumsum(f7_b1)

f7_b3 <- as.data.frame(as.factor(f7_b2))
colnames(f7_b3) <- 'cSum'

countF1 <- f7_b3 %>% group_by(cSum) %>% count(n=n())
countF1 <- as.data.frame(countF1)
countF1 <- countF1[,-3]

countF1$f7_incr_Days <- countF1$n-1
countF1 <- countF1[,-2]

countF3 <- subset(countF1, countF1$f7_incr_Days>0)
summary(countF3$f7_incr_Days)

f7_incr_Days_grouped <- countF3 %>% group_by(f7_incr_Days) %>% count(n=n())
f7_incr_Days_grouped <- f7_incr_Days_grouped[,-3]
```

```{r}
f7_incr_Days_grouped
```

```{r}
median(f7_incr_Days_grouped$f7_incr_Days)
```


***


```{r}
FTR <- subset(remaining36_g, remaining36_g$stockName=='FTR')

FTR <- FTR[complete.cases(FTR),]

ftr7_a <- ifelse(FTR$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for ftr7 <- <- ifelse(FTR$today2lag7>1, 1,0)
ftr7_ab <- cumsum(ftr7_a)

ftr7_abc <- as.data.frame(as.factor(ftr7_ab))
colnames(ftr7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countFTR <- ftr7_abc %>% group_by(cSum) %>% count(n=n())
countFTR <- as.data.frame(countFTR)
countFTR <- countFTR[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countFTR$ftr7_decr_Days <- countFTR$n-1
countFTR <- countFTR[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countFTR2 <- subset(countFTR, countFTR$ftr7_decr_Days>0)
summary(countFTR2$ftr7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
ftr7_decr_Days_grouped <- countFTR2 %>% group_by(ftr7_decr_Days) %>% count(n=n())
ftr7_decr_Days_grouped <- ftr7_decr_Days_grouped[,-3]
```

```{r}
ftr7_decr_Days_grouped
```

```{r}

median(ftr7_decr_Days_grouped$ftr7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
ftr7_b1 <- ifelse(FTR$today2lag7>1, 0,1)


ftr7_b2 <- cumsum(ftr7_b1)

ftr7_b3 <- as.data.frame(as.factor(ftr7_b2))
colnames(ftr7_b3) <- 'cSum'

countFTR1 <- ftr7_b3 %>% group_by(cSum) %>% count(n=n())
countFTR1 <- as.data.frame(countFTR1)
countFTR1 <- countFTR1[,-3]

countFTR1$ftr7_incr_Days <- countFTR1$n-1
countFTR1 <- countFTR1[,-2]

countFTR3 <- subset(countFTR1, countFTR1$ftr7_incr_Days>0)
summary(countFTR3$ftr7_incr_Days)

ftr7_incr_Days_grouped <- countFTR3 %>% group_by(ftr7_incr_Days) %>% count(n=n())
ftr7_incr_Days_grouped <- ftr7_incr_Days_grouped[,-3]
```

```{r}
ftr7_incr_Days_grouped
```

```{r}
median(ftr7_incr_Days_grouped$ftr7_incr_Days)
```


***

```{r}
HMC <- subset(remaining36_g, remaining36_g$stockName=='HMC')

HMC <- HMC[complete.cases(HMC),]

hmc7_a <- ifelse(HMC$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for hmc7 <- <- ifelse(HMC$today2lag7>1, 1,0)
hmc7_ab <- cumsum(hmc7_a)

hmc7_abc <- as.data.frame(as.factor(hmc7_ab))
colnames(hmc7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countHMC <- hmc7_abc %>% group_by(cSum) %>% count(n=n())
countHMC <- as.data.frame(countHMC)
countHMC <- countHMC[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countHMC$hmc7_decr_Days <- countHMC$n-1
countHMC <- countHMC[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countHMC2 <- subset(countHMC, countHMC$hmc7_decr_Days>0)
summary(countHMC2$hmc7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
hmc7_decr_Days_grouped <- countHMC2 %>% group_by(hmc7_decr_Days) %>% count(n=n())
hmc7_decr_Days_grouped <- hmc7_decr_Days_grouped[,-3]
```

```{r}
hmc7_decr_Days_grouped
```

```{r}

median(hmc7_decr_Days_grouped$hmc7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
hmc7_b1 <- ifelse(HMC$today2lag7>1, 0,1)


hmc7_b2 <- cumsum(hmc7_b1)

hmc7_b3 <- as.data.frame(as.factor(hmc7_b2))
colnames(hmc7_b3) <- 'cSum'

countHMC1 <- hmc7_b3 %>% group_by(cSum) %>% count(n=n())
countHMC1 <- as.data.frame(countHMC1)
countHMC1 <- countHMC1[,-3]

countHMC1$hmc7_incr_Days <- countHMC1$n-1
countHMC1 <- countHMC1[,-2]

countHMC3 <- subset(countHMC1, countHMC1$hmc7_incr_Days>0)
summary(countHMC3$hmc7_incr_Days)

hmc7_incr_Days_grouped <- countHMC3 %>% group_by(hmc7_incr_Days) %>% count(n=n())
hmc7_incr_Days_grouped <- hmc7_incr_Days_grouped[,-3]
```

```{r}
hmc7_incr_Days_grouped
```

```{r}
median(hmc7_incr_Days_grouped$hmc7_incr_Days)
```

***


```{r}
HOFT <- subset(remaining36_g, remaining36_g$stockName=='HOFT')

HOFT <- HOFT[complete.cases(HOFT),]

hoft7_a <- ifelse(HOFT$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for hoft7 <- <- ifelse(HOFT$today2lag7>1, 1,0)
hoft7_ab <- cumsum(hoft7_a)

hoft7_abc <- as.data.frame(as.factor(hoft7_ab))
colnames(hoft7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countHOFT <- hoft7_abc %>% group_by(cSum) %>% count(n=n())
countHOFT <- as.data.frame(countHOFT)
countHOFT <- countHOFT[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countHOFT$hoft7_decr_Days <- countHOFT$n-1
countHOFT <- countHOFT[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countHOFT2 <- subset(countHOFT, countHOFT$hoft7_decr_Days>0)
summary(countHOFT2$hoft7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
hoft7_decr_Days_grouped <- countHOFT2 %>% group_by(hoft7_decr_Days) %>% count(n=n())
hoft7_decr_Days_grouped <- hoft7_decr_Days_grouped[,-3]
```

```{r}
hoft7_decr_Days_grouped
```

```{r}

median(hoft7_decr_Days_grouped$hoft7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
hoft7_b1 <- ifelse(HOFT$today2lag7>1, 0,1)


hoft7_b2 <- cumsum(hoft7_b1)

hoft7_b3 <- as.data.frame(as.factor(hoft7_b2))
colnames(hoft7_b3) <- 'cSum'

countHOFT1 <- hoft7_b3 %>% group_by(cSum) %>% count(n=n())
countHOFT1 <- as.data.frame(countHOFT1)
countHOFT1 <- countHOFT1[,-3]

countHOFT1$hoft7_incr_Days <- countHOFT1$n-1
countHOFT1 <- countHOFT1[,-2]

countHOFT3 <- subset(countHOFT1, countHOFT1$hoft7_incr_Days>0)
summary(countHOFT3$hoft7_incr_Days)

hoft7_incr_Days_grouped <- countHOFT3 %>% group_by(hoft7_incr_Days) %>% count(n=n())
hoft7_incr_Days_grouped <- hoft7_incr_Days_grouped[,-3]
```

```{r}
hoft7_incr_Days_grouped
```

```{r}
median(hoft7_incr_Days_grouped$hoft7_incr_Days)
```

***


```{r}
HRB <- subset(remaining36_g, remaining36_g$stockName=='HRB')

HRB <- HRB[complete.cases(HRB),]

hrb7_a <- ifelse(HRB$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for hrb7 <- <- ifelse(HRB$today2lag7>1, 1,0)
hrb7_ab <- cumsum(hrb7_a)

hrb7_abc <- as.data.frame(as.factor(hrb7_ab))
colnames(hrb7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countHRB <- hrb7_abc %>% group_by(cSum) %>% count(n=n())
countHRB <- as.data.frame(countHRB)
countHRB <- countHRB[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countHRB$hrb7_decr_Days <- countHRB$n-1
countHRB <- countHRB[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countHRB2 <- subset(countHRB, countHRB$hrb7_decr_Days>0)
summary(countHRB2$hrb7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
hrb7_decr_Days_grouped <- countHRB2 %>% group_by(hrb7_decr_Days) %>% count(n=n())
hrb7_decr_Days_grouped <- hrb7_decr_Days_grouped[,-3]
```

```{r}
hrb7_decr_Days_grouped
```

```{r}

median(hrb7_decr_Days_grouped$hrb7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
hrb7_b1 <- ifelse(HRB$today2lag7>1, 0,1)


hrb7_b2 <- cumsum(hrb7_b1)

hrb7_b3 <- as.data.frame(as.factor(hrb7_b2))
colnames(hrb7_b3) <- 'cSum'

countHRB1 <- hrb7_b3 %>% group_by(cSum) %>% count(n=n())
countHRB1 <- as.data.frame(countHRB1)
countHRB1 <- countHRB1[,-3]

countHRB1$hrb7_incr_Days <- countHRB1$n-1
countHRB1 <- countHRB1[,-2]

countHRB3 <- subset(countHRB1, countHRB1$hrb7_incr_Days>0)
summary(countHRB3$hrb7_incr_Days)

hrb7_incr_Days_grouped <- countHRB3 %>% group_by(hrb7_incr_Days) %>% count(n=n())
hrb7_incr_Days_grouped <- hrb7_incr_Days_grouped[,-3]
```

```{r}
hrb7_incr_Days_grouped
```

```{r}
median(hrb7_incr_Days_grouped$hrb7_incr_Days)
```


***

```{r}
HST <- subset(remaining36_g, remaining36_g$stockName=='HST')

HST <- HST[complete.cases(HST),]

hst7_a <- ifelse(HST$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for hst7 <- <- ifelse(HST$today2lag7>1, 1,0)
hst7_ab <- cumsum(hst7_a)

hst7_abc <- as.data.frame(as.factor(hst7_ab))
colnames(hst7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countHST <- hst7_abc %>% group_by(cSum) %>% count(n=n())
countHST <- as.data.frame(countHST)
countHST <- countHST[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countHST$hst7_decr_Days <- countHST$n-1
countHST <- countHST[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countHST2 <- subset(countHST, countHST$hst7_decr_Days>0)
summary(countHST2$hst7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
hst7_decr_Days_grouped <- countHST2 %>% group_by(hst7_decr_Days) %>% count(n=n())
hst7_decr_Days_grouped <- hst7_decr_Days_grouped[,-3]
```

```{r}
hst7_decr_Days_grouped
```

```{r}

median(hst7_decr_Days_grouped$hst7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
hst7_b1 <- ifelse(HST$today2lag7>1, 0,1)


hst7_b2 <- cumsum(hst7_b1)

hst7_b3 <- as.data.frame(as.factor(hst7_b2))
colnames(hst7_b3) <- 'cSum'

countHST1 <- hst7_b3 %>% group_by(cSum) %>% count(n=n())
countHST1 <- as.data.frame(countHST1)
countHST1 <- countHST1[,-3]

countHST1$hst7_incr_Days <- countHST1$n-1
countHST1 <- countHST1[,-2]

countHST3 <- subset(countHST1, countHST1$hst7_incr_Days>0)
summary(countHST3$hst7_incr_Days)

hst7_incr_Days_grouped <- countHST3 %>% group_by(hst7_incr_Days) %>% count(n=n())
hst7_incr_Days_grouped <- hst7_incr_Days_grouped[,-3]
```

```{r}
hst7_incr_Days_grouped
```

```{r}
median(hst7_incr_Days_grouped$hst7_incr_Days)
```

***


```{r}
INO <- subset(remaining36_g, remaining36_g$stockName=='INO')

INO <- INO[complete.cases(INO),]

ino7_a <- ifelse(INO$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for ino7 <- <- ifelse(INO$today2lag7>1, 1,0)
ino7_ab <- cumsum(ino7_a)

ino7_abc <- as.data.frame(as.factor(ino7_ab))
colnames(ino7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countINO <- ino7_abc %>% group_by(cSum) %>% count(n=n())
countINO <- as.data.frame(countINO)
countINO <- countINO[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countINO$ino7_decr_Days <- countINO$n-1
countINO <- countINO[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countINO2 <- subset(countINO, countINO$ino7_decr_Days>0)
summary(countINO2$ino7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
ino7_decr_Days_grouped <- countINO2 %>% group_by(ino7_decr_Days) %>% count(n=n())
ino7_decr_Days_grouped <- ino7_decr_Days_grouped[,-3]
```

```{r}
ino7_decr_Days_grouped
```

```{r}

median(ino7_decr_Days_grouped$ino7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
ino7_b1 <- ifelse(INO$today2lag7>1, 0,1)


ino7_b2 <- cumsum(ino7_b1)

ino7_b3 <- as.data.frame(as.factor(ino7_b2))
colnames(ino7_b3) <- 'cSum'

countINO1 <- ino7_b3 %>% group_by(cSum) %>% count(n=n())
countINO1 <- as.data.frame(countINO1)
countINO1 <- countINO1[,-3]

countINO1$ino7_incr_Days <- countINO1$n-1
countINO1 <- countINO1[,-2]

countINO3 <- subset(countINO1, countINO1$ino7_incr_Days>0)
summary(countINO3$ino7_incr_Days)

ino7_incr_Days_grouped <- countINO3 %>% group_by(ino7_incr_Days) %>% count(n=n())
ino7_incr_Days_grouped <- ino7_incr_Days_grouped[,-3]
```

```{r}
ino7_incr_Days_grouped
```

```{r}
median(ino7_incr_Days_grouped$ino7_incr_Days)
```

***

```{r}
JBLU <- subset(remaining36_g, remaining36_g$stockName=='JBLU')

JBLU <- JBLU[complete.cases(JBLU),]

jblu7_a <- ifelse(JBLU$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for jblu7 <- <- ifelse(JBLU$today2lag7>1, 1,0)
jblu7_ab <- cumsum(jblu7_a)

jblu7_abc <- as.data.frame(as.factor(jblu7_ab))
colnames(jblu7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countJBLU <- jblu7_abc %>% group_by(cSum) %>% count(n=n())
countJBLU <- as.data.frame(countJBLU)
countJBLU <- countJBLU[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countJBLU$jblu7_decr_Days <- countJBLU$n-1
countJBLU <- countJBLU[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countJBLU2 <- subset(countJBLU, countJBLU$jblu7_decr_Days>0)
summary(countJBLU2$jblu7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
jblu7_decr_Days_grouped <- countJBLU2 %>% group_by(jblu7_decr_Days) %>% count(n=n())
jblu7_decr_Days_grouped <- jblu7_decr_Days_grouped[,-3]
```

```{r}
jblu7_decr_Days_grouped
```

```{r}

median(jblu7_decr_Days_grouped$jblu7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
jblu7_b1 <- ifelse(JBLU$today2lag7>1, 0,1)


jblu7_b2 <- cumsum(jblu7_b1)

jblu7_b3 <- as.data.frame(as.factor(jblu7_b2))
colnames(jblu7_b3) <- 'cSum'

countJBLU1 <- jblu7_b3 %>% group_by(cSum) %>% count(n=n())
countJBLU1 <- as.data.frame(countJBLU1)
countJBLU1 <- countJBLU1[,-3]

countJBLU1$jblu7_incr_Days <- countJBLU1$n-1
countJBLU1 <- countJBLU1[,-2]

countJBLU3 <- subset(countJBLU1, countJBLU1$jblu7_incr_Days>0)
summary(countJBLU3$jblu7_incr_Days)

jblu7_incr_Days_grouped <- countJBLU3 %>% group_by(jblu7_incr_Days) %>% count(n=n())
jblu7_incr_Days_grouped <- jblu7_incr_Days_grouped[,-3]
```

```{r}
jblu7_incr_Days_grouped
```

```{r}
median(jblu7_incr_Days_grouped$jblu7_incr_Days)
```

***

```{r}
JPM <- subset(remaining36_g, remaining36_g$stockName=='JPM')

JPM <- JPM[complete.cases(JPM),]

jpm7_a <- ifelse(JPM$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for jpm7 <- <- ifelse(JPM$today2lag7>1, 1,0)
jpm7_ab <- cumsum(jpm7_a)

jpm7_abc <- as.data.frame(as.factor(jpm7_ab))
colnames(jpm7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countJPM <- jpm7_abc %>% group_by(cSum) %>% count(n=n())
countJPM <- as.data.frame(countJPM)
countJPM <- countJPM[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countJPM$jpm7_decr_Days <- countJPM$n-1
countJPM <- countJPM[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countJPM2 <- subset(countJPM, countJPM$jpm7_decr_Days>0)
summary(countJPM2$jpm7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
jpm7_decr_Days_grouped <- countJPM2 %>% group_by(jpm7_decr_Days) %>% count(n=n())
jpm7_decr_Days_grouped <- jpm7_decr_Days_grouped[,-3]
```

```{r}
jpm7_decr_Days_grouped
```

```{r}

median(jpm7_decr_Days_grouped$jpm7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
jpm7_b1 <- ifelse(JPM$today2lag7>1, 0,1)


jpm7_b2 <- cumsum(jpm7_b1)

jpm7_b3 <- as.data.frame(as.factor(jpm7_b2))
colnames(jpm7_b3) <- 'cSum'

countJPM1 <- jpm7_b3 %>% group_by(cSum) %>% count(n=n())
countJPM1 <- as.data.frame(countJPM1)
countJPM1 <- countJPM1[,-3]

countJPM1$jpm7_incr_Days <- countJPM1$n-1
countJPM1 <- countJPM1[,-2]

countJPM3 <- subset(countJPM1, countJPM1$jpm7_incr_Days>0)
summary(countJPM3$jpm7_incr_Days)

jpm7_incr_Days_grouped <- countJPM3 %>% group_by(jpm7_incr_Days) %>% count(n=n())
jpm7_incr_Days_grouped <- jpm7_incr_Days_grouped[,-3]
```

```{r}
jpm7_incr_Days_grouped
```

```{r}
median(jpm7_incr_Days_grouped$jpm7_incr_Days)
```

***


```{r}
JWN <- subset(remaining36_g, remaining36_g$stockName=='JWN')

JWN <- JWN[complete.cases(JWN),]

jwn7_a <- ifelse(JWN$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for jwn7 <- <- ifelse(JWN$today2lag7>1, 1,0)
jwn7_ab <- cumsum(jwn7_a)

jwn7_abc <- as.data.frame(as.factor(jwn7_ab))
colnames(jwn7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countJWN <- jwn7_abc %>% group_by(cSum) %>% count(n=n())
countJWN <- as.data.frame(countJWN)
countJWN <- countJWN[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countJWN$jwn7_decr_Days <- countJWN$n-1
countJWN <- countJWN[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countJWN2 <- subset(countJWN, countJWN$jwn7_decr_Days>0)
summary(countJWN2$jwn7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
jwn7_decr_Days_grouped <- countJWN2 %>% group_by(jwn7_decr_Days) %>% count(n=n())
jwn7_decr_Days_grouped <- jwn7_decr_Days_grouped[,-3]
```

```{r}
jwn7_decr_Days_grouped
```

```{r}

median(jwn7_decr_Days_grouped$jwn7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
jwn7_b1 <- ifelse(JWN$today2lag7>1, 0,1)


jwn7_b2 <- cumsum(jwn7_b1)

jwn7_b3 <- as.data.frame(as.factor(jwn7_b2))
colnames(jwn7_b3) <- 'cSum'

countJWN1 <- jwn7_b3 %>% group_by(cSum) %>% count(n=n())
countJWN1 <- as.data.frame(countJWN1)
countJWN1 <- countJWN1[,-3]

countJWN1$jwn7_incr_Days <- countJWN1$n-1
countJWN1 <- countJWN1[,-2]

countJWN3 <- subset(countJWN1, countJWN1$jwn7_incr_Days>0)
summary(countJWN3$jwn7_incr_Days)

jwn7_incr_Days_grouped <- countJWN3 %>% group_by(jwn7_incr_Days) %>% count(n=n())
jwn7_incr_Days_grouped <- jwn7_incr_Days_grouped[,-3]
```

```{r}
jwn7_incr_Days_grouped
```

```{r}
median(jwn7_incr_Days_grouped$jwn7_incr_Days)
```

***


```{r}
KGJI <- subset(remaining36_g, remaining36_g$stockName=='KGJI')

KGJI <- KGJI[complete.cases(KGJI),]

kgji7_a <- ifelse(KGJI$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for kgji7 <- <- ifelse(KGJI$today2lag7>1, 1,0)
kgji7_ab <- cumsum(kgji7_a)

kgji7_abc <- as.data.frame(as.factor(kgji7_ab))
colnames(kgji7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countKGJI <- kgji7_abc %>% group_by(cSum) %>% count(n=n())
countKGJI <- as.data.frame(countKGJI)
countKGJI <- countKGJI[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countKGJI$kgji7_decr_Days <- countKGJI$n-1
countKGJI <- countKGJI[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countKGJI2 <- subset(countKGJI, countKGJI$kgji7_decr_Days>0)
summary(countKGJI2$kgji7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
kgji7_decr_Days_grouped <- countKGJI2 %>% group_by(kgji7_decr_Days) %>% count(n=n())
kgji7_decr_Days_grouped <- kgji7_decr_Days_grouped[,-3]
```

```{r}
kgji7_decr_Days_grouped
```

```{r}

median(kgji7_decr_Days_grouped$kgji7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
kgji7_b1 <- ifelse(KGJI$today2lag7>1, 0,1)


kgji7_b2 <- cumsum(kgji7_b1)

kgji7_b3 <- as.data.frame(as.factor(kgji7_b2))
colnames(kgji7_b3) <- 'cSum'

countKGJI1 <- kgji7_b3 %>% group_by(cSum) %>% count(n=n())
countKGJI1 <- as.data.frame(countKGJI1)
countKGJI1 <- countKGJI1[,-3]

countKGJI1$kgji7_incr_Days <- countKGJI1$n-1
countKGJI1 <- countKGJI1[,-2]

countKGJI3 <- subset(countKGJI1, countKGJI1$kgji7_incr_Days>0)
summary(countKGJI3$kgji7_incr_Days)

kgji7_incr_Days_grouped <- countKGJI3 %>% group_by(kgji7_incr_Days) %>% count(n=n())
kgji7_incr_Days_grouped <- kgji7_incr_Days_grouped[,-3]
```

```{r}
kgji7_incr_Days_grouped
```

```{r}
median(kgji7_incr_Days_grouped$kgji7_incr_Days)
```

***

```{r}
KSS <- subset(remaining36_g, remaining36_g$stockName=='KSS')

KSS <- KSS[complete.cases(KSS),]

kss7_a <- ifelse(KSS$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for kss7 <- <- ifelse(KSS$today2lag7>1, 1,0)
kss7_ab <- cumsum(kss7_a)

kss7_abc <- as.data.frame(as.factor(kss7_ab))
colnames(kss7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countKSS <- kss7_abc %>% group_by(cSum) %>% count(n=n())
countKSS <- as.data.frame(countKSS)
countKSS <- countKSS[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countKSS$kss7_decr_Days <- countKSS$n-1
countKSS <- countKSS[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countKSS2 <- subset(countKSS, countKSS$kss7_decr_Days>0)
summary(countKSS2$kss7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
kss7_decr_Days_grouped <- countKSS2 %>% group_by(kss7_decr_Days) %>% count(n=n())
kss7_decr_Days_grouped <- kss7_decr_Days_grouped[,-3]
```

```{r}
kss7_decr_Days_grouped
```

```{r}

median(kss7_decr_Days_grouped$kss7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
kss7_b1 <- ifelse(KSS$today2lag7>1, 0,1)


kss7_b2 <- cumsum(kss7_b1)

kss7_b3 <- as.data.frame(as.factor(kss7_b2))
colnames(kss7_b3) <- 'cSum'

countKSS1 <- kss7_b3 %>% group_by(cSum) %>% count(n=n())
countKSS1 <- as.data.frame(countKSS1)
countKSS1 <- countKSS1[,-3]

countKSS1$kss7_incr_Days <- countKSS1$n-1
countKSS1 <- countKSS1[,-2]

countKSS3 <- subset(countKSS1, countKSS1$kss7_incr_Days>0)
summary(countKSS3$kss7_incr_Days)

kss7_incr_Days_grouped <- countKSS3 %>% group_by(kss7_incr_Days) %>% count(n=n())
kss7_incr_Days_grouped <- kss7_incr_Days_grouped[,-3]
```

```{r}
kss7_incr_Days_grouped
```

```{r}
median(kss7_incr_Days_grouped$kss7_incr_Days)
```


***


```{r}
LUV <- subset(remaining36_g, remaining36_g$stockName=='LUV')

LUV <- LUV[complete.cases(LUV),]

luv7_a <- ifelse(LUV$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for luv7 <- <- ifelse(LUV$today2lag7>1, 1,0)
luv7_ab <- cumsum(luv7_a)

luv7_abc <- as.data.frame(as.factor(luv7_ab))
colnames(luv7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countLUV <- luv7_abc %>% group_by(cSum) %>% count(n=n())
countLUV <- as.data.frame(countLUV)
countLUV <- countLUV[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countLUV$luv7_decr_Days <- countLUV$n-1
countLUV <- countLUV[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countLUV2 <- subset(countLUV, countLUV$luv7_decr_Days>0)
summary(countLUV2$luv7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
luv7_decr_Days_grouped <- countLUV2 %>% group_by(luv7_decr_Days) %>% count(n=n())
luv7_decr_Days_grouped <- luv7_decr_Days_grouped[,-3]
```

```{r}
luv7_decr_Days_grouped
```

```{r}

median(luv7_decr_Days_grouped$luv7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
luv7_b1 <- ifelse(LUV$today2lag7>1, 0,1)


luv7_b2 <- cumsum(luv7_b1)

luv7_b3 <- as.data.frame(as.factor(luv7_b2))
colnames(luv7_b3) <- 'cSum'

countLUV1 <- luv7_b3 %>% group_by(cSum) %>% count(n=n())
countLUV1 <- as.data.frame(countLUV1)
countLUV1 <- countLUV1[,-3]

countLUV1$luv7_incr_Days <- countLUV1$n-1
countLUV1 <- countLUV1[,-2]

countLUV3 <- subset(countLUV1, countLUV1$luv7_incr_Days>0)
summary(countLUV3$luv7_incr_Days)

luv7_incr_Days_grouped <- countLUV3 %>% group_by(luv7_incr_Days) %>% count(n=n())
luv7_incr_Days_grouped <- luv7_incr_Days_grouped[,-3]
```

```{r}
luv7_incr_Days_grouped
```

```{r}
median(luv7_incr_Days_grouped$luv7_incr_Days)
```

***

```{r}
M <- subset(remaining36_g, remaining36_g$stockName=='M')

M <- M[complete.cases(M),]

m7_a <- ifelse(M$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for m7 <- <- ifelse(M$today2lag7>1, 1,0)
m7_ab <- cumsum(m7_a)

m7_abc <- as.data.frame(as.factor(m7_ab))
colnames(m7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countM <- m7_abc %>% group_by(cSum) %>% count(n=n())
countM <- as.data.frame(countM)
countM <- countM[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countM$m7_decr_Days <- countM$n-1
countM <- countM[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countM2 <- subset(countM, countM$m7_decr_Days>0)
summary(countM2$m7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
m7_decr_Days_grouped <- countM2 %>% group_by(m7_decr_Days) %>% count(n=n())
m7_decr_Days_grouped <- m7_decr_Days_grouped[,-3]
```

```{r}
m7_decr_Days_grouped
```

```{r}

median(m7_decr_Days_grouped$m7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
m7_b1 <- ifelse(M$today2lag7>1, 0,1)


m7_b2 <- cumsum(m7_b1)

m7_b3 <- as.data.frame(as.factor(m7_b2))
colnames(m7_b3) <- 'cSum'

countM1 <- m7_b3 %>% group_by(cSum) %>% count(n=n())
countM1 <- as.data.frame(countM1)
countM1 <- countM1[,-3]

countM1$m7_incr_Days <- countM1$n-1
countM1 <- countM1[,-2]

countM3 <- subset(countM1, countM1$m7_incr_Days>0)
summary(countM3$m7_incr_Days)

m7_incr_Days_grouped <- countM3 %>% group_by(m7_incr_Days) %>% count(n=n())
m7_incr_Days_grouped <- m7_incr_Days_grouped[,-3]
```

```{r}
m7_incr_Days_grouped
```

```{r}
median(m7_incr_Days_grouped$m7_incr_Days)
```


***


```{r}
MGM <- subset(remaining36_g, remaining36_g$stockName=='MGM')

MGM <- MGM[complete.cases(MGM),]

mgm7_a <- ifelse(MGM$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for mgm7 <- <- ifelse(MGM$today2lag7>1, 1,0)
mgm7_ab <- cumsum(mgm7_a)

mgm7_abc <- as.data.frame(as.factor(mgm7_ab))
colnames(mgm7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countMGM <- mgm7_abc %>% group_by(cSum) %>% count(n=n())
countMGM <- as.data.frame(countMGM)
countMGM <- countMGM[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countMGM$mgm7_decr_Days <- countMGM$n-1
countMGM <- countMGM[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countMGM2 <- subset(countMGM, countMGM$mgm7_decr_Days>0)
summary(countMGM2$mgm7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
mgm7_decr_Days_grouped <- countMGM2 %>% group_by(mgm7_decr_Days) %>% count(n=n())
mgm7_decr_Days_grouped <- mgm7_decr_Days_grouped[,-3]
```

```{r}
mgm7_decr_Days_grouped
```

```{r}

median(mgm7_decr_Days_grouped$mgm7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
mgm7_b1 <- ifelse(MGM$today2lag7>1, 0,1)


mgm7_b2 <- cumsum(mgm7_b1)

mgm7_b3 <- as.data.frame(as.factor(mgm7_b2))
colnames(mgm7_b3) <- 'cSum'

countMGM1 <- mgm7_b3 %>% group_by(cSum) %>% count(n=n())
countMGM1 <- as.data.frame(countMGM1)
countMGM1 <- countMGM1[,-3]

countMGM1$mgm7_incr_Days <- countMGM1$n-1
countMGM1 <- countMGM1[,-2]

countMGM3 <- subset(countMGM1, countMGM1$mgm7_incr_Days>0)
summary(countMGM3$mgm7_incr_Days)

mgm7_incr_Days_grouped <- countMGM3 %>% group_by(mgm7_incr_Days) %>% count(n=n())
mgm7_incr_Days_grouped <- mgm7_incr_Days_grouped[,-3]
```

```{r}
mgm7_incr_Days_grouped
```

```{r}
median(mgm7_incr_Days_grouped$mgm7_incr_Days)
```

***


```{r}
MSFT <- subset(remaining36_g, remaining36_g$stockName=='MSFT')

MSFT <- MSFT[complete.cases(MSFT),]

msft7_a <- ifelse(MSFT$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for msft7 <- <- ifelse(MSFT$today2lag7>1, 1,0)
msft7_ab <- cumsum(msft7_a)

msft7_abc <- as.data.frame(as.factor(msft7_ab))
colnames(msft7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countMSFT <- msft7_abc %>% group_by(cSum) %>% count(n=n())
countMSFT <- as.data.frame(countMSFT)
countMSFT <- countMSFT[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countMSFT$msft7_decr_Days <- countMSFT$n-1
countMSFT <- countMSFT[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countMSFT2 <- subset(countMSFT, countMSFT$msft7_decr_Days>0)
summary(countMSFT2$msft7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
msft7_decr_Days_grouped <- countMSFT2 %>% group_by(msft7_decr_Days) %>% count(n=n())
msft7_decr_Days_grouped <- msft7_decr_Days_grouped[,-3]
```

```{r}
msft7_decr_Days_grouped
```

```{r}

median(msft7_decr_Days_grouped$msft7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
msft7_b1 <- ifelse(MSFT$today2lag7>1, 0,1)


msft7_b2 <- cumsum(msft7_b1)

msft7_b3 <- as.data.frame(as.factor(msft7_b2))
colnames(msft7_b3) <- 'cSum'

countMSFT1 <- msft7_b3 %>% group_by(cSum) %>% count(n=n())
countMSFT1 <- as.data.frame(countMSFT1)
countMSFT1 <- countMSFT1[,-3]

countMSFT1$msft7_incr_Days <- countMSFT1$n-1
countMSFT1 <- countMSFT1[,-2]

countMSFT3 <- subset(countMSFT1, countMSFT1$msft7_incr_Days>0)
summary(countMSFT3$msft7_incr_Days)

msft7_incr_Days_grouped <- countMSFT3 %>% group_by(msft7_incr_Days) %>% count(n=n())
msft7_incr_Days_grouped <- msft7_incr_Days_grouped[,-3]
```

```{r}
msft7_incr_Days_grouped
```

```{r}
median(msft7_incr_Days_grouped$msft7_incr_Days)
```

***


```{r}
NSANY <- subset(remaining36_g, remaining36_g$stockName=='NSANY')

NSANY <- NSANY[complete.cases(NSANY),]

nsany7_a <- ifelse(NSANY$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for nsany7 <- <- ifelse(NSANY$today2lag7>1, 1,0)
nsany7_ab <- cumsum(nsany7_a)

nsany7_abc <- as.data.frame(as.factor(nsany7_ab))
colnames(nsany7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countNSANY <- nsany7_abc %>% group_by(cSum) %>% count(n=n())
countNSANY <- as.data.frame(countNSANY)
countNSANY <- countNSANY[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countNSANY$nsany7_decr_Days <- countNSANY$n-1
countNSANY <- countNSANY[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countNSANY2 <- subset(countNSANY, countNSANY$nsany7_decr_Days>0)
summary(countNSANY2$nsany7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
nsany7_decr_Days_grouped <- countNSANY2 %>% group_by(nsany7_decr_Days) %>% count(n=n())
nsany7_decr_Days_grouped <- nsany7_decr_Days_grouped[,-3]
```

```{r}
nsany7_decr_Days_grouped
```

```{r}

median(nsany7_decr_Days_grouped$nsany7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
nsany7_b1 <- ifelse(NSANY$today2lag7>1, 0,1)


nsany7_b2 <- cumsum(nsany7_b1)

nsany7_b3 <- as.data.frame(as.factor(nsany7_b2))
colnames(nsany7_b3) <- 'cSum'

countNSANY1 <- nsany7_b3 %>% group_by(cSum) %>% count(n=n())
countNSANY1 <- as.data.frame(countNSANY1)
countNSANY1 <- countNSANY1[,-3]

countNSANY1$nsany7_incr_Days <- countNSANY1$n-1
countNSANY1 <- countNSANY1[,-2]

countNSANY3 <- subset(countNSANY1, countNSANY1$nsany7_incr_Days>0)
summary(countNSANY3$nsany7_incr_Days)

nsany7_incr_Days_grouped <- countNSANY3 %>% group_by(nsany7_incr_Days) %>% count(n=n())
nsany7_incr_Days_grouped <- nsany7_incr_Days_grouped[,-3]
```

```{r}
nsany7_incr_Days_grouped
```

```{r}
median(nsany7_incr_Days_grouped$nsany7_incr_Days)
```

***


```{r}
NUS <- subset(remaining36_g, remaining36_g$stockName=='NUS')

NUS <- NUS[complete.cases(NUS),]

nus7_a <- ifelse(NUS$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for nus7 <- <- ifelse(NUS$today2lag7>1, 1,0)
nus7_ab <- cumsum(nus7_a)

nus7_abc <- as.data.frame(as.factor(nus7_ab))
colnames(nus7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countNUS <- nus7_abc %>% group_by(cSum) %>% count(n=n())
countNUS <- as.data.frame(countNUS)
countNUS <- countNUS[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countNUS$nus7_decr_Days <- countNUS$n-1
countNUS <- countNUS[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countNUS2 <- subset(countNUS, countNUS$nus7_decr_Days>0)
summary(countNUS2$nus7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
nus7_decr_Days_grouped <- countNUS2 %>% group_by(nus7_decr_Days) %>% count(n=n())
nus7_decr_Days_grouped <- nus7_decr_Days_grouped[,-3]
```

```{r}
nus7_decr_Days_grouped
```

```{r}

median(nus7_decr_Days_grouped$nus7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
nus7_b1 <- ifelse(NUS$today2lag7>1, 0,1)


nus7_b2 <- cumsum(nus7_b1)

nus7_b3 <- as.data.frame(as.factor(nus7_b2))
colnames(nus7_b3) <- 'cSum'

countNUS1 <- nus7_b3 %>% group_by(cSum) %>% count(n=n())
countNUS1 <- as.data.frame(countNUS1)
countNUS1 <- countNUS1[,-3]

countNUS1$nus7_incr_Days <- countNUS1$n-1
countNUS1 <- countNUS1[,-2]

countNUS3 <- subset(countNUS1, countNUS1$nus7_incr_Days>0)
summary(countNUS3$nus7_incr_Days)

nus7_incr_Days_grouped <- countNUS3 %>% group_by(nus7_incr_Days) %>% count(n=n())
nus7_incr_Days_grouped <- nus7_incr_Days_grouped[,-3]
```

```{r}
nus7_incr_Days_grouped
```

```{r}
median(nus7_incr_Days_grouped$nus7_incr_Days)
```


***


```{r}
ONCY <- subset(remaining36_g, remaining36_g$stockName=='ONCY')

ONCY <- ONCY[complete.cases(ONCY),]

oncy7_a <- ifelse(ONCY$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for oncy7 <- <- ifelse(ONCY$today2lag7>1, 1,0)
oncy7_ab <- cumsum(oncy7_a)

oncy7_abc <- as.data.frame(as.factor(oncy7_ab))
colnames(oncy7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countONCY <- oncy7_abc %>% group_by(cSum) %>% count(n=n())
countONCY <- as.data.frame(countONCY)
countONCY <- countONCY[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countONCY$oncy7_decr_Days <- countONCY$n-1
countONCY <- countONCY[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countONCY2 <- subset(countONCY, countONCY$oncy7_decr_Days>0)
summary(countONCY2$oncy7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
oncy7_decr_Days_grouped <- countONCY2 %>% group_by(oncy7_decr_Days) %>% count(n=n())
oncy7_decr_Days_grouped <- oncy7_decr_Days_grouped[,-3]
```

```{r}
oncy7_decr_Days_grouped
```

```{r}

median(oncy7_decr_Days_grouped$oncy7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
oncy7_b1 <- ifelse(ONCY$today2lag7>1, 0,1)


oncy7_b2 <- cumsum(oncy7_b1)

oncy7_b3 <- as.data.frame(as.factor(oncy7_b2))
colnames(oncy7_b3) <- 'cSum'

countONCY1 <- oncy7_b3 %>% group_by(cSum) %>% count(n=n())
countONCY1 <- as.data.frame(countONCY1)
countONCY1 <- countONCY1[,-3]

countONCY1$oncy7_incr_Days <- countONCY1$n-1
countONCY1 <- countONCY1[,-2]

countONCY3 <- subset(countONCY1, countONCY1$oncy7_incr_Days>0)
summary(countONCY3$oncy7_incr_Days)

oncy7_incr_Days_grouped <- countONCY3 %>% group_by(oncy7_incr_Days) %>% count(n=n())
oncy7_incr_Days_grouped <- oncy7_incr_Days_grouped[,-3]
```

```{r}
oncy7_incr_Days_grouped
```

```{r}
median(oncy7_incr_Days_grouped$oncy7_incr_Days)
```

***


```{r}
RRGB <- subset(remaining36_g, remaining36_g$stockName=='RRGB')

RRGB <- RRGB[complete.cases(RRGB),]

rrgb7_a <- ifelse(RRGB$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for rrgb7 <- <- ifelse(RRGB$today2lag7>1, 1,0)
rrgb7_ab <- cumsum(rrgb7_a)

rrgb7_abc <- as.data.frame(as.factor(rrgb7_ab))
colnames(rrgb7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countRRGB <- rrgb7_abc %>% group_by(cSum) %>% count(n=n())
countRRGB <- as.data.frame(countRRGB)
countRRGB <- countRRGB[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countRRGB$rrgb7_decr_Days <- countRRGB$n-1
countRRGB <- countRRGB[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countRRGB2 <- subset(countRRGB, countRRGB$rrgb7_decr_Days>0)
summary(countRRGB2$rrgb7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
rrgb7_decr_Days_grouped <- countRRGB2 %>% group_by(rrgb7_decr_Days) %>% count(n=n())
rrgb7_decr_Days_grouped <- rrgb7_decr_Days_grouped[,-3]
```

```{r}
rrgb7_decr_Days_grouped
```

```{r}

median(rrgb7_decr_Days_grouped$rrgb7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
rrgb7_b1 <- ifelse(RRGB$today2lag7>1, 0,1)


rrgb7_b2 <- cumsum(rrgb7_b1)

rrgb7_b3 <- as.data.frame(as.factor(rrgb7_b2))
colnames(rrgb7_b3) <- 'cSum'

countRRGB1 <- rrgb7_b3 %>% group_by(cSum) %>% count(n=n())
countRRGB1 <- as.data.frame(countRRGB1)
countRRGB1 <- countRRGB1[,-3]

countRRGB1$rrgb7_incr_Days <- countRRGB1$n-1
countRRGB1 <- countRRGB1[,-2]

countRRGB3 <- subset(countRRGB1, countRRGB1$rrgb7_incr_Days>0)
summary(countRRGB3$rrgb7_incr_Days)

rrgb7_incr_Days_grouped <- countRRGB3 %>% group_by(rrgb7_incr_Days) %>% count(n=n())
rrgb7_incr_Days_grouped <- rrgb7_incr_Days_grouped[,-3]
```

```{r}
rrgb7_incr_Days_grouped
```

```{r}
median(rrgb7_incr_Days_grouped$rrgb7_incr_Days)
```


***


```{r}
S <- subset(remaining36_g, remaining36_g$stockName=='S')

S <- S[complete.cases(S),]

s7_a <- ifelse(S$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for s7 <- <- ifelse(S$today2lag7>1, 1,0)
s7_ab <- cumsum(s7_a)

s7_abc <- as.data.frame(as.factor(s7_ab))
colnames(s7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countS <- s7_abc %>% group_by(cSum) %>% count(n=n())
countS <- as.data.frame(countS)
countS <- countS[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countS$s7_decr_Days <- countS$n-1
countS <- countS[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countS2 <- subset(countS, countS$s7_decr_Days>0)
summary(countS2$s7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
s7_decr_Days_grouped <- countS2 %>% group_by(s7_decr_Days) %>% count(n=n())
s7_decr_Days_grouped <- s7_decr_Days_grouped[,-3]
```

```{r}
s7_decr_Days_grouped
```

```{r}

median(s7_decr_Days_grouped$s7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
s7_b1 <- ifelse(S$today2lag7>1, 0,1)


s7_b2 <- cumsum(s7_b1)

s7_b3 <- as.data.frame(as.factor(s7_b2))
colnames(s7_b3) <- 'cSum'

countS1 <- s7_b3 %>% group_by(cSum) %>% count(n=n())
countS1 <- as.data.frame(countS1)
countS1 <- countS1[,-3]

countS1$s7_incr_Days <- countS1$n-1
countS1 <- countS1[,-2]

countS3 <- subset(countS1, countS1$s7_incr_Days>0)
summary(countS3$s7_incr_Days)

s7_incr_Days_grouped <- countS3 %>% group_by(s7_incr_Days) %>% count(n=n())
s7_incr_Days_grouped <- s7_incr_Days_grouped[,-3]
```

```{r}
s7_incr_Days_grouped
```

```{r}
median(s7_incr_Days_grouped$s7_incr_Days)
```

***

```{r}
SCE <- subset(remaining36_g, remaining36_g$stockName=='SCE')

SCE <- SCE[complete.cases(SCE),]

sce7_a <- ifelse(SCE$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for sce7 <- <- ifelse(SCE$today2lag7>1, 1,0)
sce7_ab <- cumsum(sce7_a)

sce7_abc <- as.data.frame(as.factor(sce7_ab))
colnames(sce7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countSCE <- sce7_abc %>% group_by(cSum) %>% count(n=n())
countSCE <- as.data.frame(countSCE)
countSCE <- countSCE[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countSCE$sce7_decr_Days <- countSCE$n-1
countSCE <- countSCE[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countSCE2 <- subset(countSCE, countSCE$sce7_decr_Days>0)
summary(countSCE2$sce7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
sce7_decr_Days_grouped <- countSCE2 %>% group_by(sce7_decr_Days) %>% count(n=n())
sce7_decr_Days_grouped <- sce7_decr_Days_grouped[,-3]
```

```{r}
sce7_decr_Days_grouped
```

```{r}

median(sce7_decr_Days_grouped$sce7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
sce7_b1 <- ifelse(SCE$today2lag7>1, 0,1)


sce7_b2 <- cumsum(sce7_b1)

sce7_b3 <- as.data.frame(as.factor(sce7_b2))
colnames(sce7_b3) <- 'cSum'

countSCE1 <- sce7_b3 %>% group_by(cSum) %>% count(n=n())
countSCE1 <- as.data.frame(countSCE1)
countSCE1 <- countSCE1[,-3]

countSCE1$sce7_incr_Days <- countSCE1$n-1
countSCE1 <- countSCE1[,-2]

countSCE3 <- subset(countSCE1, countSCE1$sce7_incr_Days>0)
summary(countSCE3$sce7_incr_Days)

sce7_incr_Days_grouped <- countSCE3 %>% group_by(sce7_incr_Days) %>% count(n=n())
sce7_incr_Days_grouped <- sce7_incr_Days_grouped[,-3]
```

```{r}
sce7_incr_Days_grouped
```

```{r}
median(sce7_incr_Days_grouped$sce7_incr_Days)
```


***

```{r}
SIG <- subset(remaining36_g, remaining36_g$stockName=='SIG')

SIG <- SIG[complete.cases(SIG),]

sig7_a <- ifelse(SIG$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for sig7 <- <- ifelse(SIG$today2lag7>1, 1,0)
sig7_ab <- cumsum(sig7_a)

sig7_abc <- as.data.frame(as.factor(sig7_ab))
colnames(sig7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countSIG <- sig7_abc %>% group_by(cSum) %>% count(n=n())
countSIG <- as.data.frame(countSIG)
countSIG <- countSIG[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countSIG$sig7_decr_Days <- countSIG$n-1
countSIG <- countSIG[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countSIG2 <- subset(countSIG, countSIG$sig7_decr_Days>0)
summary(countSIG2$sig7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
sig7_decr_Days_grouped <- countSIG2 %>% group_by(sig7_decr_Days) %>% count(n=n())
sig7_decr_Days_grouped <- sig7_decr_Days_grouped[,-3]
```

```{r}
sig7_decr_Days_grouped
```

```{r}

median(sig7_decr_Days_grouped$sig7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
sig7_b1 <- ifelse(SIG$today2lag7>1, 0,1)


sig7_b2 <- cumsum(sig7_b1)

sig7_b3 <- as.data.frame(as.factor(sig7_b2))
colnames(sig7_b3) <- 'cSum'

countSIG1 <- sig7_b3 %>% group_by(cSum) %>% count(n=n())
countSIG1 <- as.data.frame(countSIG1)
countSIG1 <- countSIG1[,-3]

countSIG1$sig7_incr_Days <- countSIG1$n-1
countSIG1 <- countSIG1[,-2]

countSIG3 <- subset(countSIG1, countSIG1$sig7_incr_Days>0)
summary(countSIG3$sig7_incr_Days)

sig7_incr_Days_grouped <- countSIG3 %>% group_by(sig7_incr_Days) %>% count(n=n())
sig7_incr_Days_grouped <- sig7_incr_Days_grouped[,-3]
```

```{r}
sig7_incr_Days_grouped
```

```{r}
median(sig7_incr_Days_grouped$sig7_incr_Days)
```


***

```{r}
T <- subset(remaining36_g, remaining36_g$stockName=='T')

T <- T[complete.cases(T),]

t7_a <- ifelse(T$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for t7 <- <- ifelse(T$today2lag7>1, 1,0)
t7_ab <- cumsum(t7_a)

t7_abc <- as.data.frame(as.factor(t7_ab))
colnames(t7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countT <- t7_abc %>% group_by(cSum) %>% count(n=n())
countT <- as.data.frame(countT)
countT <- countT[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countT$t7_decr_Days <- countT$n-1
countT <- countT[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countT2 <- subset(countT, countT$t7_decr_Days>0)
summary(countT2$t7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
t7_decr_Days_grouped <- countT2 %>% group_by(t7_decr_Days) %>% count(n=n())
t7_decr_Days_grouped <- t7_decr_Days_grouped[,-3]
```

```{r}
t7_decr_Days_grouped
```

```{r}

median(t7_decr_Days_grouped$t7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
t7_b1 <- ifelse(T$today2lag7>1, 0,1)


t7_b2 <- cumsum(t7_b1)

t7_b3 <- as.data.frame(as.factor(t7_b2))
colnames(t7_b3) <- 'cSum'

countT1 <- t7_b3 %>% group_by(cSum) %>% count(n=n())
countT1 <- as.data.frame(countT1)
countT1 <- countT1[,-3]

countT1$t7_incr_Days <- countT1$n-1
countT1 <- countT1[,-2]

countT3 <- subset(countT1, countT1$t7_incr_Days>0)
summary(countT3$t7_incr_Days)

t7_incr_Days_grouped <- countT3 %>% group_by(t7_incr_Days) %>% count(n=n())
t7_incr_Days_grouped <- t7_incr_Days_grouped[,-3]
```

```{r}
t7_incr_Days_grouped
```

```{r}
median(t7_incr_Days_grouped$t7_incr_Days)
```


***


```{r}
TGT <- subset(remaining36_g, remaining36_g$stockName=='TGT')

TGT <- TGT[complete.cases(TGT),]

tgt7_a <- ifelse(TGT$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for tgt7 <- <- ifelse(TGT$today2lag7>1, 1,0)
tgt7_ab <- cumsum(tgt7_a)

tgt7_abc <- as.data.frame(as.factor(tgt7_ab))
colnames(tgt7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countTGT <- tgt7_abc %>% group_by(cSum) %>% count(n=n())
countTGT <- as.data.frame(countTGT)
countTGT <- countTGT[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countTGT$tgt7_decr_Days <- countTGT$n-1
countTGT <- countTGT[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countTGT2 <- subset(countTGT, countTGT$tgt7_decr_Days>0)
summary(countTGT2$tgt7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
tgt7_decr_Days_grouped <- countTGT2 %>% group_by(tgt7_decr_Days) %>% count(n=n())
tgt7_decr_Days_grouped <- tgt7_decr_Days_grouped[,-3]
```

```{r}
tgt7_decr_Days_grouped
```

```{r}

median(tgt7_decr_Days_grouped$tgt7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
tgt7_b1 <- ifelse(TGT$today2lag7>1, 0,1)


tgt7_b2 <- cumsum(tgt7_b1)

tgt7_b3 <- as.data.frame(as.factor(tgt7_b2))
colnames(tgt7_b3) <- 'cSum'

countTGT1 <- tgt7_b3 %>% group_by(cSum) %>% count(n=n())
countTGT1 <- as.data.frame(countTGT1)
countTGT1 <- countTGT1[,-3]

countTGT1$tgt7_incr_Days <- countTGT1$n-1
countTGT1 <- countTGT1[,-2]

countTGT3 <- subset(countTGT1, countTGT1$tgt7_incr_Days>0)
summary(countTGT3$tgt7_incr_Days)

tgt7_incr_Days_grouped <- countTGT3 %>% group_by(tgt7_incr_Days) %>% count(n=n())
tgt7_incr_Days_grouped <- tgt7_incr_Days_grouped[,-3]
```

```{r}
tgt7_incr_Days_grouped
```

```{r}
median(tgt7_incr_Days_grouped$tgt7_incr_Days)
```


***


```{r}
TM <- subset(remaining36_g, remaining36_g$stockName=='TM')

TM <- TM[complete.cases(TM),]

tm7_a <- ifelse(TM$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for tm7 <- <- ifelse(TM$today2lag7>1, 1,0)
tm7_ab <- cumsum(tm7_a)

tm7_abc <- as.data.frame(as.factor(tm7_ab))
colnames(tm7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countTM <- tm7_abc %>% group_by(cSum) %>% count(n=n())
countTM <- as.data.frame(countTM)
countTM <- countTM[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countTM$tm7_decr_Days <- countTM$n-1
countTM <- countTM[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countTM2 <- subset(countTM, countTM$tm7_decr_Days>0)
summary(countTM2$tm7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
tm7_decr_Days_grouped <- countTM2 %>% group_by(tm7_decr_Days) %>% count(n=n())
tm7_decr_Days_grouped <- tm7_decr_Days_grouped[,-3]
```

```{r}
tm7_decr_Days_grouped
```

```{r}

median(tm7_decr_Days_grouped$tm7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
tm7_b1 <- ifelse(TM$today2lag7>1, 0,1)


tm7_b2 <- cumsum(tm7_b1)

tm7_b3 <- as.data.frame(as.factor(tm7_b2))
colnames(tm7_b3) <- 'cSum'

countTM1 <- tm7_b3 %>% group_by(cSum) %>% count(n=n())
countTM1 <- as.data.frame(countTM1)
countTM1 <- countTM1[,-3]

countTM1$tm7_incr_Days <- countTM1$n-1
countTM1 <- countTM1[,-2]

countTM3 <- subset(countTM1, countTM1$tm7_incr_Days>0)
summary(countTM3$tm7_incr_Days)

tm7_incr_Days_grouped <- countTM3 %>% group_by(tm7_incr_Days) %>% count(n=n())
tm7_incr_Days_grouped <- tm7_incr_Days_grouped[,-3]
```

```{r}
tm7_incr_Days_grouped
```

```{r}
median(tm7_incr_Days_grouped$tm7_incr_Days)
```


***


```{r}
UBSI <- subset(remaining36_g, remaining36_g$stockName=='UBSI')

UBSI <- UBSI[complete.cases(UBSI),]

ubsi7_a <- ifelse(UBSI$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for ubsi7 <- <- ifelse(UBSI$today2lag7>1, 1,0)
ubsi7_ab <- cumsum(ubsi7_a)

ubsi7_abc <- as.data.frame(as.factor(ubsi7_ab))
colnames(ubsi7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countUBSI <- ubsi7_abc %>% group_by(cSum) %>% count(n=n())
countUBSI <- as.data.frame(countUBSI)
countUBSI <- countUBSI[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countUBSI$ubsi7_decr_Days <- countUBSI$n-1
countUBSI <- countUBSI[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countUBSI2 <- subset(countUBSI, countUBSI$ubsi7_decr_Days>0)
summary(countUBSI2$ubsi7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
ubsi7_decr_Days_grouped <- countUBSI2 %>% group_by(ubsi7_decr_Days) %>% count(n=n())
ubsi7_decr_Days_grouped <- ubsi7_decr_Days_grouped[,-3]
```

```{r}
ubsi7_decr_Days_grouped
```

```{r}

median(ubsi7_decr_Days_grouped$ubsi7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
ubsi7_b1 <- ifelse(UBSI$today2lag7>1, 0,1)


ubsi7_b2 <- cumsum(ubsi7_b1)

ubsi7_b3 <- as.data.frame(as.factor(ubsi7_b2))
colnames(ubsi7_b3) <- 'cSum'

countUBSI1 <- ubsi7_b3 %>% group_by(cSum) %>% count(n=n())
countUBSI1 <- as.data.frame(countUBSI1)
countUBSI1 <- countUBSI1[,-3]

countUBSI1$ubsi7_incr_Days <- countUBSI1$n-1
countUBSI1 <- countUBSI1[,-2]

countUBSI3 <- subset(countUBSI1, countUBSI1$ubsi7_incr_Days>0)
summary(countUBSI3$ubsi7_incr_Days)

ubsi7_incr_Days_grouped <- countUBSI3 %>% group_by(ubsi7_incr_Days) %>% count(n=n())
ubsi7_incr_Days_grouped <- ubsi7_incr_Days_grouped[,-3]
```

```{r}
ubsi7_incr_Days_grouped
```

```{r}
median(ubsi7_incr_Days_grouped$ubsi7_incr_Days)
```

***




```{r}
VZ <- subset(remaining36_g, remaining36_g$stockName=='VZ')

VZ <- VZ[complete.cases(VZ),]

vz7_a <- ifelse(VZ$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for vz7 <- <- ifelse(VZ$today2lag7>1, 1,0)
vz7_ab <- cumsum(vz7_a)

vz7_abc <- as.data.frame(as.factor(vz7_ab))
colnames(vz7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countVZ <- vz7_abc %>% group_by(cSum) %>% count(n=n())
countVZ <- as.data.frame(countVZ)
countVZ <- countVZ[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countVZ$vz7_decr_Days <- countVZ$n-1
countVZ <- countVZ[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countVZ2 <- subset(countVZ, countVZ$vz7_decr_Days>0)
summary(countVZ2$vz7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
vz7_decr_Days_grouped <- countVZ2 %>% group_by(vz7_decr_Days) %>% count(n=n())
vz7_decr_Days_grouped <- vz7_decr_Days_grouped[,-3]
```

```{r}
vz7_decr_Days_grouped
```

```{r}

median(vz7_decr_Days_grouped$vz7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
vz7_b1 <- ifelse(VZ$today2lag7>1, 0,1)


vz7_b2 <- cumsum(vz7_b1)

vz7_b3 <- as.data.frame(as.factor(vz7_b2))
colnames(vz7_b3) <- 'cSum'

countVZ1 <- vz7_b3 %>% group_by(cSum) %>% count(n=n())
countVZ1 <- as.data.frame(countVZ1)
countVZ1 <- countVZ1[,-3]

countVZ1$vz7_incr_Days <- countVZ1$n-1
countVZ1 <- countVZ1[,-2]

countVZ3 <- subset(countVZ1, countVZ1$vz7_incr_Days>0)
summary(countVZ3$vz7_incr_Days)

vz7_incr_Days_grouped <- countVZ3 %>% group_by(vz7_incr_Days) %>% count(n=n())
vz7_incr_Days_grouped <- vz7_incr_Days_grouped[,-3]
```

```{r}
vz7_incr_Days_grouped
```

```{r}
median(vz7_incr_Days_grouped$vz7_incr_Days)
```


***




```{r}
WFC <- subset(remaining36_g, remaining36_g$stockName=='WFC')

WFC <- WFC[complete.cases(WFC),]

wfc7_a <- ifelse(WFC$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for wfc7 <- <- ifelse(WFC$today2lag7>1, 1,0)
wfc7_ab <- cumsum(wfc7_a)

wfc7_abc <- as.data.frame(as.factor(wfc7_ab))
colnames(wfc7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countWFC <- wfc7_abc %>% group_by(cSum) %>% count(n=n())
countWFC <- as.data.frame(countWFC)
countWFC <- countWFC[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countWFC$wfc7_decr_Days <- countWFC$n-1
countWFC <- countWFC[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countWFC2 <- subset(countWFC, countWFC$wfc7_decr_Days>0)
summary(countWFC2$wfc7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
wfc7_decr_Days_grouped <- countWFC2 %>% group_by(wfc7_decr_Days) %>% count(n=n())
wfc7_decr_Days_grouped <- wfc7_decr_Days_grouped[,-3]
```

```{r}
wfc7_decr_Days_grouped
```

```{r}

median(wfc7_decr_Days_grouped$wfc7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
wfc7_b1 <- ifelse(WFC$today2lag7>1, 0,1)


wfc7_b2 <- cumsum(wfc7_b1)

wfc7_b3 <- as.data.frame(as.factor(wfc7_b2))
colnames(wfc7_b3) <- 'cSum'

countWFC1 <- wfc7_b3 %>% group_by(cSum) %>% count(n=n())
countWFC1 <- as.data.frame(countWFC1)
countWFC1 <- countWFC1[,-3]

countWFC1$wfc7_incr_Days <- countWFC1$n-1
countWFC1 <- countWFC1[,-2]

countWFC3 <- subset(countWFC1, countWFC1$wfc7_incr_Days>0)
summary(countWFC3$wfc7_incr_Days)

wfc7_incr_Days_grouped <- countWFC3 %>% group_by(wfc7_incr_Days) %>% count(n=n())
wfc7_incr_Days_grouped <- wfc7_incr_Days_grouped[,-3]
```

```{r}
wfc7_incr_Days_grouped
```

```{r}
median(wfc7_incr_Days_grouped$wfc7_incr_Days)
```


***




```{r}
WM <- subset(remaining36_g, remaining36_g$stockName=='WM')

WM <- WM[complete.cases(WM),]

wm7_a <- ifelse(WM$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for wm7 <- <- ifelse(WM$today2lag7>1, 1,0)
wm7_ab <- cumsum(wm7_a)

wm7_abc <- as.data.frame(as.factor(wm7_ab))
colnames(wm7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countWM <- wm7_abc %>% group_by(cSum) %>% count(n=n())
countWM <- as.data.frame(countWM)
countWM <- countWM[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countWM$wm7_decr_Days <- countWM$n-1
countWM <- countWM[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countWM2 <- subset(countWM, countWM$wm7_decr_Days>0)
summary(countWM2$wm7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
wm7_decr_Days_grouped <- countWM2 %>% group_by(wm7_decr_Days) %>% count(n=n())
wm7_decr_Days_grouped <- wm7_decr_Days_grouped[,-3]
```

```{r}
wm7_decr_Days_grouped
```

```{r}

median(wm7_decr_Days_grouped$wm7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
wm7_b1 <- ifelse(WM$today2lag7>1, 0,1)


wm7_b2 <- cumsum(wm7_b1)

wm7_b3 <- as.data.frame(as.factor(wm7_b2))
colnames(wm7_b3) <- 'cSum'

countWM1 <- wm7_b3 %>% group_by(cSum) %>% count(n=n())
countWM1 <- as.data.frame(countWM1)
countWM1 <- countWM1[,-3]

countWM1$wm7_incr_Days <- countWM1$n-1
countWM1 <- countWM1[,-2]

countWM3 <- subset(countWM1, countWM1$wm7_incr_Days>0)
summary(countWM3$wm7_incr_Days)

wm7_incr_Days_grouped <- countWM3 %>% group_by(wm7_incr_Days) %>% count(n=n())
wm7_incr_Days_grouped <- wm7_incr_Days_grouped[,-3]
```

```{r}
wm7_incr_Days_grouped
```

```{r}
median(wm7_incr_Days_grouped$wm7_incr_Days)
```

***




```{r}
WWE <- subset(remaining36_g, remaining36_g$stockName=='WWE')

WWE <- WWE[complete.cases(WWE),]

wwe7_a <- ifelse(WWE$today2lag7>1, 1,0)

# get cumulative sum of the number of times today's stock increased from 7 days ago,
# the day will be repeated if it didn't increase. For example '10' is repeated 21 times, this 
# counts the number of times the value decreased when setting the variable in the previous 
# code block for wwe7 <- <- ifelse(WWE$today2lag7>1, 1,0)
wwe7_ab <- cumsum(wwe7_a)

wwe7_abc <- as.data.frame(as.factor(wwe7_ab))
colnames(wwe7_abc) <- 'cSum'

# get the count of how many instances or days there are, the more counts, the more 
# days that were decreasing stock values for today's value to 7 days prior value.
countWWE <- wwe7_abc %>% group_by(cSum) %>% count(n=n())
countWWE <- as.data.frame(countWWE)
countWWE <- countWWE[,-3]

# remove this additional day, so that the number of days in a row decreasing is measured
countWWE$wwe7_decr_Days <- countWWE$n-1
countWWE <- countWWE[,-2]

#this is a set of only those days decreasing at least one day in the lag 7 comparison
countWWE2 <- subset(countWWE, countWWE$wwe7_decr_Days>0)
summary(countWWE2$wwe7_decr_Days)

# this table shows how many sets of cumulative days decreasing there were in lag 7
wwe7_decr_Days_grouped <- countWWE2 %>% group_by(wwe7_decr_Days) %>% count(n=n())
wwe7_decr_Days_grouped <- wwe7_decr_Days_grouped[,-3]
```

```{r}
wwe7_decr_Days_grouped
```

```{r}

median(wwe7_decr_Days_grouped$wwe7_decr_Days)
```

```{r}

#assign a 1 to decreasing values
wwe7_b1 <- ifelse(WWE$today2lag7>1, 0,1)


wwe7_b2 <- cumsum(wwe7_b1)

wwe7_b3 <- as.data.frame(as.factor(wwe7_b2))
colnames(wwe7_b3) <- 'cSum'

countWWE1 <- wwe7_b3 %>% group_by(cSum) %>% count(n=n())
countWWE1 <- as.data.frame(countWWE1)
countWWE1 <- countWWE1[,-3]

countWWE1$wwe7_incr_Days <- countWWE1$n-1
countWWE1 <- countWWE1[,-2]

countWWE3 <- subset(countWWE1, countWWE1$wwe7_incr_Days>0)
summary(countWWE3$wwe7_incr_Days)

wwe7_incr_Days_grouped <- countWWE3 %>% group_by(wwe7_incr_Days) %>% count(n=n())
wwe7_incr_Days_grouped <- wwe7_incr_Days_grouped[,-3]
```

```{r}
wwe7_incr_Days_grouped
```

```{r}
median(wwe7_incr_Days_grouped$wwe7_incr_Days)
```

***
***
***

***

Start making the table of statistics for the remaining 36 stocks, using the first set of 17 that were in the best performing portfolio compared to the DOW.

This gets the average and the median stock values from the start and end of this time series from Jan 3, 2007 to Feb 14, 2020.
```{r}
close53_avg <- Close53_g %>% group_by(stockName) %>% summarise_at(vars(stockDayValue),
                                                                  mean)
close53_median <- Close53_g %>% group_by(stockName) %>% summarise_at(vars(stockDayValue),
                                                                  median)
colnames(close53_avg)[2] <- 'avgStockValue'
colnames(close53_median)[2] <- 'medianStockValue'

```

Is the data skewed to the right or left, is the median below (to the left) or above (to the right) of the mean or average of the stock values? Assign a new field to a table of stocks that gives a 1 to those stocks with median stock values greater than the average, and a 0 otherwise.
```{r}
skewQuest <- merge(close53_avg, close53_median, by.x='stockName', by.y='stockName')
sce <- grep('SCE', skewQuest$stockName)
skewQuest <- skewQuest[-sce,]
skewQuest$MedianGrtrThanAvg <- ifelse(skewQuest$avgStockValue < 
                                        skewQuest$medianStockValue, 1,0)
skewedRight <- subset(skewQuest, skewQuest$MedianGrtrThanAvg == 1)
print('skewed right:')
skewedRight$stockName
print('------------------------------------------')
print('skewed Left:')
skewedLeft <- subset(skewQuest, skewQuest$MedianGrtrThanAvg==0)
skewedLeft$stockName
write.csv(skewQuest, 'skewQuest.csv', row.names=FALSE)
```



```{r, error=FALSE, message=FALSE, warning=FALSE}
first17 <- dROI17_lag7_d[,-c(1,4)]
row.names(first17) <- row.names(dROI17_lag7_d)

Remaining36 <- remaining36[order(remaining36$Date),]

remaining36_st_fi <- Remaining36[c(1,length(remaining36$Date)),]
remaining36_st_fi_t <- as.data.frame(t(remaining36_st_fi))
colnames(remaining36_st_fi_t) <- c('startValue', 'finalValue')

remaining36_st_fi_t <- remaining36_st_fi_t[-1,]
last36 <- remaining36_st_fi_t

last36$startValue <- as.numeric(as.character(last36$startValue))
last36$finalValue <- as.numeric(as.character(last36$finalValue))

last36$stock_ROI <- last36$finalValue/last36$startValue

last36$medn_cSum_decr_L7 <- 'median cSum down L7'
last36$Q3_cSum_decr_L7 <- '3rd Qntl cSum down L7'
last36$max_cSum_decr_L7 <- 'max cSum down L7'
last36$medn_cSum_incr_L7 <- 'median cSum up L7'
last36$Q3_cSum_incr_L7 <- '3rd Qntl cSun up L7'
last36$max_cSum_incr_L7 <- 'max cSum up L7'

all53 <- rbind(first17, last36)

all53$stockName <- row.names(all53)

all_53 <- merge(close53_avg, all53, by.x='stockName', by.y='stockName')
All53 <- merge(close53_median, all_53, by.x='stockName', by.y='stockName')
head(All53)
```


Add these statistics to their respective stock instance in the All53 table now that we have the table, there are 36 stock statistics on the number of times the stock increases and decreases in this time span that need to be filled in. Carefully find and replace the names of each of the remaining 36 stock for the lower and upper instances in the block below. Then after running each chunk of code, the All53 table will be filled in.

AAL-American Airlines:
```{r}
mdnaal_d <- median(countAAL2$aal7_decr_Days)
q3aal_d <- as.numeric(as.character(summary(countAAL2$aal7_decr_Days)["3rd Qu."]))
mxaal_d <- max(countAAL2$aal7_decr_Days)

mdnaal_i <- median(countAAL3$aal7_incr_Days)
q3aal_i <- as.numeric(as.character(summary(countAAL3$aal7_incr_Days)["3rd Qu."]))
mxaal_i <- max(countAAL3$aal7_incr_Days)

aal_g <- grep('AAL', All53$stockName )

All53[aal_g,7:12] <- c(mdnaal_d,q3aal_d,mxaal_d,mdnaal_i,q3aal_i,mxaal_i)

```

The above code chunk filled in the AAL stock statistical information.
```{r}
head(All53)

```

Now to fill in the other 35 stocks for our completed ML table of stats (for now).

ARWR-Arrowhead Pharmaceuticals:
```{r}
mdnarwr_d <- median(countARWR2$arwr7_decr_Days)
q3arwr_d <- as.numeric(as.character(summary(countARWR2$arwr7_decr_Days)["3rd Qu."]))
mxarwr_d <- max(countARWR2$arwr7_decr_Days)

mdnarwr_i <- median(countARWR3$arwr7_incr_Days)
q3arwr_i <- as.numeric(as.character(summary(countARWR3$arwr7_incr_Days)["3rd Qu."]))
mxarwr_i <- max(countARWR3$arwr7_incr_Days)

arwr_g <- grep('ARWR', All53$stockName )

All53[arwr_g,7:12] <- c(mdnarwr_d,q3arwr_d,mxarwr_d,mdnarwr_i,q3arwr_i,mxarwr_i)

```

C-Citigroup:
```{r}
mdnc_d <- median(countC2$c7_decr_Days)
q3c_d <- as.numeric(as.character(summary(countC2$c7_decr_Days)["3rd Qu."]))
mxc_d <- max(countC2$c7_decr_Days)

mdnc_i <- median(countC3$c7_incr_Days)
q3c_i <- as.numeric(as.character(summary(countC3$c7_incr_Days)["3rd Qu."]))
mxc_i <- max(countC3$c7_incr_Days)

c_g <- grep('C', All53$stockName )

All53[c_g,7:12] <- c(mdnc_d,q3c_d,mxc_d,mdnc_i,q3c_i,mxc_i)

```

EPD-Enterprise Products Partners:
```{r}
mdnepd_d <- median(countEPD2$epd7_decr_Days)
q3epd_d <- as.numeric(as.character(summary(countEPD2$epd7_decr_Days)["3rd Qu."]))
mxepd_d <- max(countEPD2$epd7_decr_Days)

mdnepd_i <- median(countEPD3$epd7_incr_Days)
q3epd_i <- as.numeric(as.character(summary(countEPD3$epd7_incr_Days)["3rd Qu."]))
mxepd_i <- max(countEPD3$epd7_incr_Days)

epd_g <- grep('EPD', All53$stockName )

All53[epd_g,7:12] <- c(mdnepd_d,q3epd_d,mxepd_d,mdnepd_i,q3epd_i,mxepd_i)

```

F-Ford:
```{r}
mdnf_d <- median(countF2$f7_decr_Days)
q3f_d <- as.numeric(as.character(summary(countF2$f7_decr_Days)["3rd Qu."]))
mxf_d <- max(countF2$f7_decr_Days)

mdnf_i <- median(countF3$f7_incr_Days)
q3f_i <- as.numeric(as.character(summary(countF3$f7_incr_Days)["3rd Qu."]))
mxf_i <- max(countF3$f7_incr_Days)

f_g <- grep('F', All53$stockName )

All53[f_g,7:12] <- c(mdnf_d,q3f_d,mxf_d,mdnf_i,q3f_i,mxf_i)

```

HRB-H&R Block:
```{r}
mdnhrb_d <- median(countHRB2$hrb7_decr_Days)
q3hrb_d <- as.numeric(as.character(summary(countHRB2$hrb7_decr_Days)["3rd Qu."]))
mxhrb_d <- max(countHRB2$hrb7_decr_Days)

mdnhrb_i <- median(countHRB3$hrb7_incr_Days)
q3hrb_i <- as.numeric(as.character(summary(countHRB3$hrb7_incr_Days)["3rd Qu."]))
mxhrb_i <- max(countHRB3$hrb7_incr_Days)

hrb_g <- grep('HRB', All53$stockName )

All53[hrb_g,7:12] <- c(mdnhrb_d,q3hrb_d,mxhrb_d,mdnhrb_i,q3hrb_i,mxhrb_i)

```

HST-Host Hotels & Resorts:
```{r}
mdnhst_d <- median(countHST2$hst7_decr_Days)
q3hst_d <- as.numeric(as.character(summary(countHST2$hst7_decr_Days)["3rd Qu."]))
mxhst_d <- max(countHST2$hst7_decr_Days)

mdnhst_i <- median(countHST3$hst7_incr_Days)
q3hst_i <- as.numeric(as.character(summary(countHST3$hst7_incr_Days)["3rd Qu."]))
mxhst_i <- max(countHST3$hst7_incr_Days)

hst_g <- grep('HST', All53$stockName )

All53[hst_g,7:12] <- c(mdnhst_d,q3hst_d,mxhst_d,mdnhst_i,q3hst_i,mxhst_i)

```

INO-Inovio Pharmaceuticals:
```{r}
mdnino_d <- median(countINO2$ino7_decr_Days)
q3ino_d <- as.numeric(as.character(summary(countINO2$ino7_decr_Days)["3rd Qu."]))
mxino_d <- max(countINO2$ino7_decr_Days)

mdnino_i <- median(countINO3$ino7_incr_Days)
q3ino_i <- as.numeric(as.character(summary(countINO3$ino7_incr_Days)["3rd Qu."]))
mxino_i <- max(countINO3$ino7_incr_Days)

ino_g <- grep('INO', All53$stockName )

All53[ino_g,7:12] <- c(mdnino_d,q3ino_d,mxino_d,mdnino_i,q3ino_i,mxino_i)

```

JBLU-Jet Blue Airways:
```{r}
mdnjblu_d <- median(countJBLU2$jblu7_decr_Days)
q3jblu_d <- as.numeric(as.character(summary(countJBLU2$jblu7_decr_Days)["3rd Qu."]))
mxjblu_d <- max(countJBLU2$jblu7_decr_Days)

mdnjblu_i <- median(countJBLU3$jblu7_incr_Days)
q3jblu_i <- as.numeric(as.character(summary(countJBLU3$jblu7_incr_Days)["3rd Qu."]))
mxjblu_i <- max(countJBLU3$jblu7_incr_Days)

jblu_g <- grep('JBLU', All53$stockName )

All53[jblu_g,7:12] <- c(mdnjblu_d,q3jblu_d,mxjblu_d,mdnjblu_i,q3jblu_i,mxjblu_i)

```

JPM-JP Morgan Chase & Co.:
```{r}
mdnjpm_d <- median(countJPM2$jpm7_decr_Days)
q3jpm_d <- as.numeric(as.character(summary(countJPM2$jpm7_decr_Days)["3rd Qu."]))
mxjpm_d <- max(countJPM2$jpm7_decr_Days)

mdnjpm_i <- median(countJPM3$jpm7_incr_Days)
q3jpm_i <- as.numeric(as.character(summary(countJPM3$jpm7_incr_Days)["3rd Qu."]))
mxjpm_i <- max(countJPM3$jpm7_incr_Days)

jpm_g <- grep('JPM', All53$stockName )

All53[jpm_g,7:12] <- c(mdnjpm_d,q3jpm_d,mxjpm_d,mdnjpm_i,q3jpm_i,mxjpm_i)


```

JWN-Nordstrom:
```{r}
mdnjwn_d <- median(countJWN2$jwn7_decr_Days)
q3jwn_d <- as.numeric(as.character(summary(countJWN2$jwn7_decr_Days)["3rd Qu."]))
mxjwn_d <- max(countJWN2$jwn7_decr_Days)

mdnjwn_i <- median(countJWN3$jwn7_incr_Days)
q3jwn_i <- as.numeric(as.character(summary(countJWN3$jwn7_incr_Days)["3rd Qu."]))
mxjwn_i <- max(countJWN3$jwn7_incr_Days)

jwn_g <- grep('JWN', All53$stockName )

All53[jwn_g,7:12] <- c(mdnjwn_d,q3jwn_d,mxjwn_d,mdnjwn_i,q3jwn_i,mxjwn_i)


```

KGJI-Kingold Jewelry,Inc:
```{r}
mdnkgji_d <- median(countKGJI2$kgji7_decr_Days)
q3kgji_d <- as.numeric(as.character(summary(countKGJI2$kgji7_decr_Days)["3rd Qu."]))
mxkgji_d <- max(countKGJI2$kgji7_decr_Days)

mdnkgji_i <- median(countKGJI3$kgji7_incr_Days)
q3kgji_i <- as.numeric(as.character(summary(countKGJI3$kgji7_incr_Days)["3rd Qu."]))
mxkgji_i <- max(countKGJI3$kgji7_incr_Days)

kgji_g <- grep('KGJI', All53$stockName )

All53[kgji_g,7:12] <- c(mdnkgji_d,q3kgji_d,mxkgji_d,mdnkgji_i,q3kgji_i,mxkgji_i)


```

KSS-Kohls Corporation:
```{r}
mdnkss_d <- median(countKSS2$kss7_decr_Days)
q3kss_d <- as.numeric(as.character(summary(countKSS2$kss7_decr_Days)["3rd Qu."]))
mxkss_d <- max(countKSS2$kss7_decr_Days)

mdnkss_i <- median(countKSS3$kss7_incr_Days)
q3kss_i <- as.numeric(as.character(summary(countKSS3$kss7_incr_Days)["3rd Qu."]))
mxkss_i <- max(countKSS3$kss7_incr_Days)

kss_g <- grep('KSS', All53$stockName )

All53[kss_g,7:12] <- c(mdnkss_d,q3kss_d,mxkss_d,mdnkss_i,q3kss_i,mxkss_i)


```

LUV-Southwest Airlines:
```{r}
mdnluv_d <- median(countLUV2$luv7_decr_Days)
q3luv_d <- as.numeric(as.character(summary(countLUV2$luv7_decr_Days)["3rd Qu."]))
mxluv_d <- max(countLUV2$luv7_decr_Days)

mdnluv_i <- median(countLUV3$luv7_incr_Days)
q3luv_i <- as.numeric(as.character(summary(countLUV3$luv7_incr_Days)["3rd Qu."]))
mxluv_i <- max(countLUV3$luv7_incr_Days)

luv_g <- grep('LUV', All53$stockName )

All53[luv_g,7:12] <- c(mdnluv_d,q3luv_d,mxluv_d,mdnluv_i,q3luv_i,mxluv_i)


```

M-Macys:
```{r}
mdnm_d <- median(countM2$m7_decr_Days)
q3m_d <- as.numeric(as.character(summary(countM2$m7_decr_Days)["3rd Qu."]))
mxm_d <- max(countM2$m7_decr_Days)

mdnm_i <- median(countM3$m7_incr_Days)
q3m_i <- as.numeric(as.character(summary(countM3$m7_incr_Days)["3rd Qu."]))
mxm_i <- max(countM3$m7_incr_Days)

m_g <- grep('M', All53$stockName )

All53[m_g,7:12] <- c(mdnm_d,q3m_d,mxm_d,mdnm_i,q3m_i,mxm_i)


```

NSANY-Nissan Motor Co.:
```{r}
mdnnsany_d <- median(countNSANY2$nsany7_decr_Days)
q3nsany_d <- as.numeric(as.character(summary(countNSANY2$nsany7_decr_Days)["3rd Qu."]))
mxnsany_d <- max(countNSANY2$nsany7_decr_Days)

mdnnsany_i <- median(countNSANY3$nsany7_incr_Days)
q3nsany_i <- as.numeric(as.character(summary(countNSANY3$nsany7_incr_Days)["3rd Qu."]))
mxnsany_i <- max(countNSANY3$nsany7_incr_Days)

nsany_g <- grep('NSANY', All53$stockName )

All53[nsany_g,7:12] <- c(mdnnsany_d,q3nsany_d,mxnsany_d,mdnnsany_i,q3nsany_i,mxnsany_i)


```

NUS-Nu Skin Enterprises:
```{r}
mdnnus_d <- median(countNUS2$nus7_decr_Days)
q3nus_d <- as.numeric(as.character(summary(countNUS2$nus7_decr_Days)["3rd Qu."]))
mxnus_d <- max(countNUS2$nus7_decr_Days)

mdnnus_i <- median(countNUS3$nus7_incr_Days)
q3nus_i <- as.numeric(as.character(summary(countNUS3$nus7_incr_Days)["3rd Qu."]))
mxnus_i <- max(countNUS3$nus7_incr_Days)

nus_g <- grep('NUS', All53$stockName )

All53[nus_g,7:12] <- c(mdnnus_d,q3nus_d,mxnus_d,mdnnus_i,q3nus_i,mxnus_i)


```

RRGB-Red Robin Gourmet Burgers:
```{r}
mdnrrgb_d <- median(countRRGB2$rrgb7_decr_Days)
q3rrgb_d <- as.numeric(as.character(summary(countRRGB2$rrgb7_decr_Days)["3rd Qu."]))
mxrrgb_d <- max(countRRGB2$rrgb7_decr_Days)

mdnrrgb_i <- median(countRRGB3$rrgb7_incr_Days)
q3rrgb_i <- as.numeric(as.character(summary(countRRGB3$rrgb7_incr_Days)["3rd Qu."]))
mxrrgb_i <- max(countRRGB3$rrgb7_incr_Days)

rrgb_g <- grep('RRGB', All53$stockName )

All53[rrgb_g,7:12] <- c(mdnrrgb_d,q3rrgb_d,mxrrgb_d,mdnrrgb_i,q3rrgb_i,mxrrgb_i)


```

S-Sprint Corporation:
```{r}
mdns_d <- median(countS2$s7_decr_Days)
q3s_d <- as.numeric(as.character(summary(countS2$s7_decr_Days)["3rd Qu."]))
mxs_d <- max(countS2$s7_decr_Days)

mdns_i <- median(countS3$s7_incr_Days)
q3s_i <- as.numeric(as.character(summary(countS3$s7_incr_Days)["3rd Qu."]))
mxs_i <- max(countS3$s7_incr_Days)

s_g <- grep('S', All53$stockName )

All53[s_g,7:12] <- c(mdns_d,q3s_d,mxs_d,mdns_i,q3s_i,mxs_i)


```

T-AT&T Inc:
```{r}
mdnt_d <- median(countT2$t7_decr_Days)
q3t_d <- as.numeric(as.character(summary(countT2$t7_decr_Days)["3rd Qu."]))
mxt_d <- max(countT2$t7_decr_Days)

mdnt_i <- median(countT3$t7_incr_Days)
q3t_i <- as.numeric(as.character(summary(countT3$t7_incr_Days)["3rd Qu."]))
mxt_i <- max(countT3$t7_incr_Days)

t_g <- grep('T', All53$stockName )

All53[t_g,7:12] <- c(mdnt_d,q3t_d,mxt_d,mdnt_i,q3t_i,mxt_i)


```

VZ-Verizon:
```{r}
mdnvz_d <- median(countVZ2$vz7_decr_Days)
q3vz_d <- as.numeric(as.character(summary(countVZ2$vz7_decr_Days)["3rd Qu."]))
mxvz_d <- max(countVZ2$vz7_decr_Days)

mdnvz_i <- median(countVZ3$vz7_incr_Days)
q3vz_i <- as.numeric(as.character(summary(countVZ3$vz7_incr_Days)["3rd Qu."]))
mxvz_i <- max(countVZ3$vz7_incr_Days)

vz_g <- grep('VZ', All53$stockName )

All53[vz_g,7:12] <- c(mdnvz_d,q3vz_d,mxvz_d,mdnvz_i,q3vz_i,mxvz_i)


```

WWE-World Wrestling Entertainment:
```{r}
mdnwwe_d <- median(countWWE2$wwe7_decr_Days)
q3wwe_d <- as.numeric(as.character(summary(countWWE2$wwe7_decr_Days)["3rd Qu."]))
mxwwe_d <- max(countWWE2$wwe7_decr_Days)

mdnwwe_i <- median(countWWE3$wwe7_incr_Days)
q3wwe_i <- as.numeric(as.character(summary(countWWE3$wwe7_incr_Days)["3rd Qu."]))
mxwwe_i <- max(countWWE3$wwe7_incr_Days)

wwe_g <- grep('WWE', All53$stockName )

All53[wwe_g,7:12] <- c(mdnwwe_d,q3wwe_d,mxwwe_d,mdnwwe_i,q3wwe_i,mxwwe_i)

```

***

Now, lets look at the columns to see they are the right data types.
```{r}
str(All53)

```

We need to change the stat columns in the All53 table from char to numeric. So lets do that.
```{r}
All53$medn_cSum_decr_L7 <- as.numeric(All53$medn_cSum_decr_L7)
All53$Q3_cSum_decr_L7 <- as.numeric(All53$Q3_cSum_decr_L7)
All53$max_cSum_decr_L7 <- as.numeric(All53$max_cSum_decr_L7)
All53$medn_cSum_incr_L7 <- as.numeric(All53$medn_cSum_incr_L7)
All53$Q3_cSum_incr_L7 <- as.numeric(All53$Q3_cSum_incr_L7)
All53$max_cSum_incr_L7 <- as.numeric(All53$max_cSum_incr_L7)

str(All53)
```

Lets also add the name of the stock to the stock name. We will also make a table of the total stocks in the hand picked portfolio of 65 that had many missing observations in the yahoo finance grab of stock information from 2007-2020 to start with.
```{r}
names53 <- stockNames[,1:2]
names53$stock <- gsub('.PB','', names53$stock)
names53$stock <- as.factor(names53$stock)

ALL53 <- merge(names53, All53, by.x='stock', by.y='stockName')
ALL65 <- merge(names53, All53, by.x='stock', by.y='stockName', all.x=TRUE)

ALL65 <- ALL65[order(ALL65$medn_cSum_decr_L7, na.last=TRUE),]
na12stocks <- ALL65[54:65,]
```

Before we write these to file, lets also categorize these stocks by type of stock. Such as cell phone, airlines, restaurants, etc. To get a category measure of each stock stats within their category or business category.
```{r}
businessType <- as.data.frame(c('airTravel','autoParts','athleticShoes','cloudComputing',
                  'genotypePharmaceuticals',
                  'bank','retail','fuel','discountRetail','fuel','automotive','bank',
                  'communications','cloudComputing','homeRepair','automotive',
                  'furniture','taxService', 'hotelTravel','immunoPharmaceuticals', 'airTravel',
                  'healthCarePharmaceuticals', 'bank','retail', 'jewelry', 
                  'retail', 'airTravel', 'retail',
                  'hotelTravel', 'CloudComputing', 'subsriptionEntertainment', 'athleticShoes',
                  'automotive','beautyProducts','cancerPharmaceuticals', 'energyUtility',
                  'discountRetail','restaurant','mobileCommunications','energyUtility',
                  'jewelry', 'communications','genericPharmaceuticals','retail','discountRetail',
                  'automotive','bank','mobileCommunications', 'bank','wasteUtility',
                  'discountRetail', 'sportsEntertainment','fuel'))
colnames(businessType) <- 'businessType'

businessType2 <- as.data.frame(c('movieEntertainment','athleticShoes','movieEntertainment',
                                 'automotive','automotive','immunoPharmaceuticals',
                                 'couponDeals','cancerPharmaceuticals',
                                 'fastFoodRestaurant','dentalBioTech','mobileCommunications',
                                 'businessSocialMedia'))
colnames(businessType2) <- 'businessType'
other12 <- cbind(businessType2,na12stocks)
other12 <- other12[,c(2,3,1,4:14)]
```

```{r}
ALL_53 <- cbind(businessType,ALL53)
ALL_53 <- ALL_53[,c(2,3,1,4:14)]

ALL_65 <- rbind(ALL_53,other12)


```

I noticed early in this script that SCE belongs to the other data set because of a class type that converted to numeric using the factors. That was why the plot early on of SCE was so choppy. Lets make a new data set to corresond to this new information.

```{r}
sce1 <- grep('SCE', ALL_53$stock)
ALL_52 <- ALL_53[-sce1,]
ALL_65_b <- ALL_65
ALL_65_b[sce1,3:13] <- NA
ALL_65_b <- ALL_65_b[order(ALL_65_b$stock,na.last=TRUE),]
```


***

***


***


This R markdown file shows all the work to gather statistical information on counts and other behind the scenes stock information on 52 hand picked stocks with time series information from Jan 2007- Feb 2020 compared to the 17 stock information of the same in the ROI_HandPickedStocks.Rmd file. 


Lets first get the median value for these stocks' ROI.
```{r}
colnames(ALL_52)

```

Lets add in some columns features for classifying this data. One to show if the stock has a low or high ROI based on the median ROI for these 52 stocks, one to show if the stock decreases more or less than the median number of times the stock has decreased from 2007-2020, and one to show if the stock increases more or less than the median number of times all stocks increased.
```{r}
med52ROI <- median(ALL_52$stock_ROI)
med52ROI
ALL_52$ROI_Low_High <- ifelse(ALL_52$stock_ROI > med52ROI,'High',
                              'Low')
med52Decr <- median(ALL_52$medn_cSum_decr_L7)
med52Decr
ALL_52$MedCountsDecreasing <- ifelse(ALL_52$medn_cSum_decr_L7 > med52Decr,
                                     'High Decreasing Counts',
                                     'Low Decreasing Counts')

med52Incr <- median(ALL_52$medn_cSum_incr_L7)
med52Incr
ALL_52$MedCountsIncreasing <- ifelse(ALL_52$medn_cSum_incr_L7 > med52Incr, 
                                     'High Increasing Counts', 
                                     'Low Increase Counts')

```


***

Lets add in columns for each stock from the number of times the stock increased or decreased in this time span of 2007-2020, and also how many times the stock had that many days of increasing or decreasing. So that, lets say the stock increased 23 days, but from 2007-2020, the stock actually had time periods it increased 23 days 8 times. This could also be a useful feature to have about the stock. We will go back to our ROI-HandPickedStocks.Rmd file to grab these values we made for the last 36 stocks not in the set of 17 best stocks that had positive median values of daily changes when the DOW was down and unemployment was higher than the month before.


```{r}

aal7_gd <- aal7_decr_Days_grouped
aal7_gi <- aal7_incr_Days_grouped


arwr7_gd <- arwr7_decr_Days_grouped
arwr7_gi <- arwr7_incr_Days_grouped

c7_gd <- c7_decr_Days_grouped
c7_gi <- c7_incr_Days_grouped


cvx7_gd <- cvx7_decr_Days_grouped
cvx7_gi <- cvx7_incr_Days_grouped

epd7_gd <- epd7_decr_Days_grouped
epd7_gi <- epd7_incr_Days_grouped


f7_gd <- f7_decr_Days_grouped
f7_gi <- f7_incr_Days_grouped

ftr7_gd <- ftr7_decr_Days_grouped
ftr7_gi <- ftr7_incr_Days_grouped


hmc7_gd <- hmc7_decr_Days_grouped
hmc7_gi <- hmc7_incr_Days_grouped

hoft7_gd <- hoft7_decr_Days_grouped
hoft7_gi <- hoft7_incr_Days_grouped


hrb7_gd <- hrb7_decr_Days_grouped
hrb7_gi <- hrb7_incr_Days_grouped

hst7_gd <- hst7_decr_Days_grouped
hst7_gi <- hst7_incr_Days_grouped


ino7_gd <- ino7_decr_Days_grouped
ino7_gi <- ino7_incr_Days_grouped

jblu7_gd <- jblu7_decr_Days_grouped
jblu7_gi <- jblu7_incr_Days_grouped


kgji7_gd <- kgji7_decr_Days_grouped
kgji7_gi <- kgji7_incr_Days_grouped

kss7_gd <- kss7_decr_Days_grouped
kss7_gi <- kss7_incr_Days_grouped


luv7_gd <- luv7_decr_Days_grouped
luv7_gi <- luv7_incr_Days_grouped

m7_gd <- m7_decr_Days_grouped
m7_gi <- m7_incr_Days_grouped


mgm7_gd <- mgm7_decr_Days_grouped
mgm7_gi <- mgm7_incr_Days_grouped

msft7_gd <- msft7_decr_Days_grouped
msft7_gi <- msft7_incr_Days_grouped


nsany7_gd <- nsany7_decr_Days_grouped
nsany7_gi <- nsany7_incr_Days_grouped

nus7_gd <- nus7_decr_Days_grouped
nus7_gi <- nus7_incr_Days_grouped


oncy7_gd <- oncy7_decr_Days_grouped
oncy7_gi <- oncy7_incr_Days_grouped

rrgb7_gd <- rrgb7_decr_Days_grouped
rrgb7_gi <- rrgb7_incr_Days_grouped


s7_gd <- s7_decr_Days_grouped
s7_gi <- s7_incr_Days_grouped

sig7_gd <- sig7_decr_Days_grouped
sig7_gi <- sig7_incr_Days_grouped


t7_gd <- t7_decr_Days_grouped
t7_gi <- t7_incr_Days_grouped

tg7_gd <- tgt7_decr_Days_grouped
tgt7_gi <- tgt7_incr_Days_grouped


tm7_gd <- tm7_decr_Days_grouped
tm7_gi <- tm7_incr_Days_grouped

ubsi7_gd <- ubsi7_decr_Days_grouped
ubsi7_gi <- ubsi7_incr_Days_grouped


vz7_gd <- vz7_decr_Days_grouped
vz7_gi <- vz7_incr_Days_grouped

wfc7_gd <- wfc7_decr_Days_grouped
wfc7_gi <- wfc7_incr_Days_grouped


wm7_gd <- wm7_decr_Days_grouped
wm7_gi <- wm7_incr_Days_grouped

wwe7_gd <- wwe7_decr_Days_grouped
wwe7_gi <- wwe7_incr_Days_grouped


```


The groups by each count of cumulative sums of days that increased or decreased and counts the number of times there were that number of days that increased or decreased before changing to the opposite direction in increasing or decreasing. These values were obtained by taking the date of each instance's stock value to the stock value 7 days earlier using the lag of the stock value with a value of 7 from the ROI-HandPickedStocks.Rmd file.
```{r}
ffin7_decr_Days_grouped <- countFFIN1 %>% group_by(decr_Days) %>% count(n=n())
ffin7_decr_Days_grouped <- ffin7_decr_Days_grouped[-3]
colnames(ffin7_decr_Days_grouped)[1] <- c('ffin_decr_Days')

ffin7_incr_Days_grouped <- countFFIN2 %>% group_by(incr_Days) %>% count(n=n())
ffin7_incr_Days_grouped <- ffin7_incr_Days_grouped[-3]
colnames(ffin7_incr_Days_grouped)[1] <- c('ffin_incr_Days')

ffin7_gd <- ffin7_decr_Days_grouped
ffin7_gi <- ffin7_incr_Days_grouped

```


```{r}
aap7_decr_Days_grouped <- countAAP1 %>% group_by(decr_Days) %>% count(n=n())
aap7_decr_Days_grouped <- aap7_decr_Days_grouped[-3]
colnames(aap7_decr_Days_grouped)[1] <- c('aap_decr_Days')

aap7_incr_Days_grouped <- countAAP2 %>% group_by(incr_Days) %>% count(n=n())
aap7_incr_Days_grouped <- aap7_incr_Days_grouped[-3]
colnames(aap7_incr_Days_grouped)[1] <- c('aap_incr_Days')

aap7_gd <- aap7_decr_Days_grouped
aap7_gi <- aap7_incr_Days_grouped


```


```{r}
addy7_decr_Days_grouped <- countADDYY1 %>% group_by(decr_Days) %>% count(n=n())
addy7_decr_Days_grouped <- addy7_decr_Days_grouped[-3]
colnames(addy7_decr_Days_grouped)[1] <- c('addy_decr_Days')

addy7_incr_Days_grouped <- countADDYY2 %>% group_by(incr_Days) %>% count(n=n())
addy7_incr_Days_grouped <- addy7_incr_Days_grouped[-3]
colnames(addy7_incr_Days_grouped)[1] <- c('addy_incr_Days')

addy7_gd <- addy7_decr_Days_grouped
addy7_gi <- addy7_incr_Days_grouped


```


```{r}
amzn7_decr_Days_grouped <- countAMZN1 %>% group_by(decr_Days) %>% count(n=n())
amzn7_decr_Days_grouped <- amzn7_decr_Days_grouped[-3]
colnames(amzn7_decr_Days_grouped)[1] <- c('amzn_decr_Days')

amzn7_incr_Days_grouped <- countAMZN2 %>% group_by(incr_Days) %>% count(n=n())
amzn7_incr_Days_grouped <- amzn7_incr_Days_grouped[-3]
colnames(amzn7_incr_Days_grouped)[1] <- c('amzn_incr_Days')

amzn7_gd <- amzn7_decr_Days_grouped
amzn7_gi <- amzn7_incr_Days_grouped


```



```{r}
cost7_decr_Days_grouped <- countCOST1 %>% group_by(decr_Days) %>% count(n=n())
cost7_decr_Days_grouped <- cost7_decr_Days_grouped[-3]
colnames(cost7_decr_Days_grouped)[1] <- c('cost_decr_Days')

cost7_incr_Days_grouped <- countCOST2 %>% group_by(incr_Days) %>% count(n=n())
cost7_incr_Days_grouped <- cost7_incr_Days_grouped[-3]
colnames(cost7_incr_Days_grouped)[1] <- c('cost_incr_Days')

cost7_gd <- cost7_decr_Days_grouped
cost7_gi <- cost7_incr_Days_grouped

```


```{r}
dltr7_decr_Days_grouped <- countDLTR1 %>% group_by(decr_Days) %>% count(n=n())
dltr7_decr_Days_grouped <- dltr7_decr_Days_grouped[-3]
colnames(dltr7_decr_Days_grouped)[1] <- c('dltr_decr_Days')

dltr7_incr_Days_grouped <- countDLTR2 %>% group_by(incr_Days) %>% count(n=n())
dltr7_incr_Days_grouped <- dltr7_incr_Days_grouped[-3]
colnames(dltr7_incr_Days_grouped)[1] <- c('dltr_incr_Days')

dltr7_gd <- dltr7_decr_Days_grouped
dltr7_gi <- dltr7_incr_Days_grouped

```


```{r}
goog7_decr_Days_grouped <- countGOOG1 %>% group_by(decr_Days) %>% count(n=n())
goog7_decr_Days_grouped <- goog7_decr_Days_grouped[-3]
colnames(goog7_decr_Days_grouped)[1] <- c('goog_decr_Days')

goog7_incr_Days_grouped <- countGOOG2 %>% group_by(incr_Days) %>% count(n=n())
goog7_incr_Days_grouped <- goog7_incr_Days_grouped[-3]
colnames(goog7_incr_Days_grouped)[1] <- c('goog_incr_Days')

goog7_gd <- goog7_decr_Days_grouped
goog7_gi <- goog7_incr_Days_grouped

```


```{r}
hd7_decr_Days_grouped <- countHD1 %>% group_by(decr_Days) %>% count(n=n())
hd7_decr_Days_grouped <- hd7_decr_Days_grouped[-3]
colnames(hd7_decr_Days_grouped)[1] <- c('hd_decr_Days')

hd7_incr_Days_grouped <- countHD2 %>% group_by(incr_Days) %>% count(n=n())
hd7_incr_Days_grouped <- hd7_incr_Days_grouped[-3]
colnames(hd7_incr_Days_grouped)[1] <- c('hd_incr_Days')

hd7_gd <- hd7_decr_Days_grouped
hd7_gi <- hd7_incr_Days_grouped

```


```{r}
jnj7_decr_Days_grouped <- countJNJ1 %>% group_by(decr_Days) %>% count(n=n())
jnj7_decr_Days_grouped <- jnj7_decr_Days_grouped[-3]
colnames(jnj7_decr_Days_grouped)[1] <- c('jnj_decr_Days')

jnj7_incr_Days_grouped <- countJNJ2 %>% group_by(incr_Days) %>% count(n=n())
jnj7_incr_Days_grouped <- jnj7_incr_Days_grouped[-3]
colnames(jnj7_incr_Days_grouped)[1] <- c('jnj_incr_Days')

jnj7_gd <- jnj7_decr_Days_grouped
jnj7_gi <- jnj7_incr_Days_grouped

```


```{r}
nflx7_decr_Days_grouped <- countNFLX1 %>% group_by(decr_Days) %>% count(n=n())
nflx7_decr_Days_grouped <- nflx7_decr_Days_grouped[-3]
colnames(nflx7_decr_Days_grouped)[1] <- c('nflx_decr_Days')

nflx7_incr_Days_grouped <- countNFLX2 %>% group_by(incr_Days) %>% count(n=n())
nflx7_incr_Days_grouped <- nflx7_incr_Days_grouped[-3]
colnames(nflx7_incr_Days_grouped)[1] <- c('nflx_incr_Days')

nflx7_gd <- nflx7_decr_Days_grouped
nflx7_gi <- nflx7_incr_Days_grouped

```


```{r}
nke7_decr_Days_grouped <- countNKE1 %>% group_by(decr_Days) %>% count(n=n())
nke7_decr_Days_grouped <- nke7_decr_Days_grouped[-3]
colnames(nke7_decr_Days_grouped)[1] <- c('nke_decr_Days')

nke7_incr_Days_grouped <- countNKE2 %>% group_by(incr_Days) %>% count(n=n())
nke7_incr_Days_grouped <- nke7_incr_Days_grouped[-3]
colnames(nke7_incr_Days_grouped)[1] <- c('nke_incr_Days')

nke7_gd <- nke7_decr_Days_grouped
nke7_gi <- nke7_incr_Days_grouped

```

```{r}
pcg7_decr_Days_grouped <- countPCG1 %>% group_by(decr_Days) %>% count(n=n())
pcg7_decr_Days_grouped <- pcg7_decr_Days_grouped[-3]
colnames(pcg7_decr_Days_grouped)[1] <- c('pcg_decr_Days')

pcg7_incr_Days_grouped <- countPCG2 %>% group_by(incr_Days) %>% count(n=n())
pcg7_incr_Days_grouped <- pcg7_incr_Days_grouped[-3]
colnames(pcg7_incr_Days_grouped)[1] <- c('pcg_incr_Days')

pcg7_gd <- pcg7_decr_Days_grouped
pcg7_gi <- pcg7_incr_Days_grouped

```


```{r}
rost7_decr_Days_grouped <- countROST1 %>% group_by(decr_Days) %>% count(n=n())
rost7_decr_Days_grouped <- rost7_decr_Days_grouped[-3]
colnames(rost7_decr_Days_grouped)[1] <- c('rost_decr_Days')

rost7_incr_Days_grouped <- countROST2 %>% group_by(incr_Days) %>% count(n=n())
rost7_incr_Days_grouped <- rost7_incr_Days_grouped[-3]
colnames(rost7_incr_Days_grouped)[1] <- c('rost_incr_Days')

rost7_gd <- rost7_decr_Days_grouped
rost7_gi <- rost7_incr_Days_grouped

```


```{r}
teva7_decr_Days_grouped <- countTEVA1 %>% group_by(decr_Days) %>% count(n=n())
teva7_decr_Days_grouped <- teva7_decr_Days_grouped[-3]
colnames(teva7_decr_Days_grouped)[1] <- c('teva_decr_Days')

teva7_incr_Days_grouped <- countTEVA2 %>% group_by(incr_Days) %>% count(n=n())
teva7_incr_Days_grouped <- teva7_incr_Days_grouped[-3]
colnames(teva7_incr_Days_grouped)[1] <- c('teva_incr_Days')

teva7_gd <- teva7_decr_Days_grouped
teva7_gi <- teva7_incr_Days_grouped

```


```{r}
tjx7_decr_Days_grouped <- countTJX1 %>% group_by(decr_Days) %>% count(n=n())
tjx7_decr_Days_grouped <- tjx7_decr_Days_grouped[-3]
colnames(tjx7_decr_Days_grouped)[1] <- c('tjx_decr_Days')

tjx7_incr_Days_grouped <- countTJX2 %>% group_by(incr_Days) %>% count(n=n())
tjx7_incr_Days_grouped <- tjx7_incr_Days_grouped[-3]
colnames(tjx7_incr_Days_grouped)[1] <- c('tjx_incr_Days')

tjx7_gd <- tjx7_decr_Days_grouped
tjx7_gi <- tjx7_incr_Days_grouped

```

 

```{r}
wmt7_decr_Days_grouped <- countWMT1 %>% group_by(decr_Days) %>% count(n=n())
wmt7_decr_Days_grouped <- wmt7_decr_Days_grouped[-3]
colnames(wmt7_decr_Days_grouped)[1] <- c('wmt_decr_Days')

wmt7_incr_Days_grouped <- countWMT2 %>% group_by(incr_Days) %>% count(n=n())
wmt7_incr_Days_grouped <- wmt7_incr_Days_grouped[-3]
colnames(wmt7_incr_Days_grouped)[1] <- c('wmt_incr_Days')

wmt7_gd <- wmt7_decr_Days_grouped
wmt7_gi <- wmt7_incr_Days_grouped

```


```{r}
xom7_decr_Days_grouped <- countXOM1 %>% group_by(decr_Days) %>% count(n=n())
xom7_decr_Days_grouped <- xom7_decr_Days_grouped[-3]
colnames(xom7_decr_Days_grouped)[1] <- c('xom_decr_Days')

xom7_incr_Days_grouped <- countXOM2 %>% group_by(incr_Days) %>% count(n=n())
xom7_incr_Days_grouped <- xom7_incr_Days_grouped[-3]
colnames(xom7_incr_Days_grouped)[1] <- c('xom_incr_Days')

xom7_gd <- xom7_decr_Days_grouped
xom7_gi <- xom7_incr_Days_grouped

```

***

Now that we have the grouped counts of how many times a stock in this set increased or decreased consecutively from 2007-2020. We can add these values to our dataset of ALL_52.
```{r}

ALL_52$MedianDecrDayGroup <- 'Median Decreasing Group'
ALL_52$MedianDecrDayCounts <- 'median N times Group Decr'

ALL_52$Q3DecrDayGroup <- '3rd Quantile Decreasing Group'
ALL_52$Q3DecrDayCounts <- '3rd Quantile N times Group Decr'

ALL_52$MaxDecrDayGroup <- 'Max Decreasing Group'
ALL_52$MaxDecrDayCounts <- 'Max N times Group Decr'

ALL_52$MedianIncrDayGroup <- 'group incr median'
ALL_52$MedianIncrDayCounts <- 'median N times Group Incr'

ALL_52$Q3IncrDayGroup <- 'group incr 3rd quantile'
ALL_52$Q3IncrDayCounts <- '3rd Quantile N times Group Incr'

ALL_52$MaxIncrDayGroup <- 'group incr max'
ALL_52$MaxIncrDayCounts <- 'Max N times Group Incr'


```

AAL
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
aal7_gd <- aal7_decr_Days_grouped
aal7_gi <- aal7_incr_Days_grouped

#removes the row names 
row.names(aal7_gd) <- NULL
row.names(aal7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
aal7_gd <- aal7_gd[order(aal7_gd$n),]
aal7_gi <- aal7_gi[order(aal7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnaal_d <- as.numeric(floor(quantile(aal7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(aal7_gd$n)/2)
mdnaal_d1 <- as.numeric(aal7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3aal_d <- as.numeric(floor(quantile(aal7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(aal7_gd$n)*.75)
q3aal_d1 <- as.numeric(aal7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxaal_d <- as.numeric(floor(quantile(aal7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxaal_d1 <- as.numeric(aal7_gd[length(aal7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnaal_i <- as.numeric(floor(quantile(aal7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(aal7_gi$n)/2)
mdnaal_i1 <- as.numeric(aal7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3aal_i <- as.numeric(floor(quantile(aal7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(aal7_gi$n)*.75)
q3aal_i1 <- as.numeric(aal7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxaal_i <- as.numeric(floor(quantile(aal7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxaal_i1 <- as.numeric(aal7_gi[length(aal7_gi$n),1])


aal_g <- grep('AAL', ALL_52$stock)

ALL_52[aal_g,18:29] <- c(mdnaal_d1, mdnaal_d, q3aal_d1, q3aal_d,
                         mxaal_d1, mxaal_d, mdnaal_i1, mdnaal_i,
                         q3aal_i1, q3aal_i, mxaal_i1, mxaal_i)

```

AAP
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
aap7_gd <- aap7_decr_Days_grouped
aap7_gi <- aap7_incr_Days_grouped

#removes the row names 
row.names(aap7_gd) <- NULL
row.names(aap7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
aap7_gd <- aap7_gd[order(aap7_gd$n),]
aap7_gi <- aap7_gi[order(aap7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnaap_d <- as.numeric(floor(quantile(aap7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(aap7_gd$n)/2)
mdnaap_d1 <- as.numeric(aap7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3aap_d <- as.numeric(floor(quantile(aap7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(aap7_gd$n)*.75)
q3aap_d1 <- as.numeric(aap7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxaap_d <- as.numeric(floor(quantile(aap7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxaap_d1 <- as.numeric(aap7_gd[length(aap7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnaap_i <- as.numeric(floor(quantile(aap7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(aap7_gi$n)/2)
mdnaap_i1 <- as.numeric(aap7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3aap_i <- as.numeric(floor(quantile(aap7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(aap7_gi$n)*.75)
q3aap_i1 <- as.numeric(aap7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxaap_i <- as.numeric(floor(quantile(aap7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxaap_i1 <- as.numeric(aap7_gi[length(aap7_gi$n),1])


aap_g <- grep('AAP', ALL_52$stock)

ALL_52[aap_g,18:29] <- c(mdnaap_d1, mdnaap_d, q3aap_d1, q3aap_d,
                         mxaap_d1, mxaap_d, mdnaap_i1, mdnaap_i,
                         q3aap_i1, q3aap_i, mxaap_i1, mxaap_i)


```

ADDY
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
addy7_gd <- addy7_decr_Days_grouped
addy7_gi <- addy7_incr_Days_grouped

#removes the row names 
row.names(addy7_gd) <- NULL
row.names(addy7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
addy7_gd <- addy7_gd[order(addy7_gd$n),]
addy7_gi <- addy7_gi[order(addy7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnaddy_d <- as.numeric(floor(quantile(addy7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(addy7_gd$n)/2)
mdnaddy_d1 <- as.numeric(addy7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3addy_d <- as.numeric(floor(quantile(addy7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(addy7_gd$n)*.75)
q3addy_d1 <- as.numeric(addy7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxaddy_d <- as.numeric(floor(quantile(addy7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxaddy_d1 <- as.numeric(addy7_gd[length(addy7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnaddy_i <- as.numeric(floor(quantile(addy7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(addy7_gi$n)/2)
mdnaddy_i1 <- as.numeric(addy7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3addy_i <- as.numeric(floor(quantile(addy7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(addy7_gi$n)*.75)
q3addy_i1 <- as.numeric(addy7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxaddy_i <- as.numeric(floor(quantile(addy7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxaddy_i1 <- as.numeric(addy7_gi[length(addy7_gi$n),1])


addy_g <- grep('ADDY', ALL_52$stock)

ALL_52[addy_g,18:29] <- c(mdnaddy_d1, mdnaddy_d, q3addy_d1, q3addy_d,
                         mxaddy_d1, mxaddy_d, mdnaddy_i1, mdnaddy_i,
                         q3addy_i1, q3addy_i, mxaddy_i1, mxaddy_i)


```

AMZN
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
amzn7_gd <- amzn7_decr_Days_grouped
amzn7_gi <- amzn7_incr_Days_grouped

#removes the row names 
row.names(amzn7_gd) <- NULL
row.names(amzn7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
amzn7_gd <- amzn7_gd[order(amzn7_gd$n),]
amzn7_gi <- amzn7_gi[order(amzn7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnamzn_d <- as.numeric(floor(quantile(amzn7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(amzn7_gd$n)/2)
mdnamzn_d1 <- as.numeric(amzn7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3amzn_d <- as.numeric(floor(quantile(amzn7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(amzn7_gd$n)*.75)
q3amzn_d1 <- as.numeric(amzn7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxamzn_d <- as.numeric(floor(quantile(amzn7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxamzn_d1 <- as.numeric(amzn7_gd[length(amzn7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnamzn_i <- as.numeric(floor(quantile(amzn7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(amzn7_gi$n)/2)
mdnamzn_i1 <- as.numeric(amzn7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3amzn_i <- as.numeric(floor(quantile(amzn7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(amzn7_gi$n)*.75)
q3amzn_i1 <- as.numeric(amzn7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxamzn_i <- as.numeric(floor(quantile(amzn7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxamzn_i1 <- as.numeric(amzn7_gi[length(amzn7_gi$n),1])


amzn_g <- grep('AMZN', ALL_52$stock)

ALL_52[amzn_g,18:29] <- c(mdnamzn_d1, mdnamzn_d, q3amzn_d1, q3amzn_d,
                         mxamzn_d1, mxamzn_d, mdnamzn_i1, mdnamzn_i,
                         q3amzn_i1, q3amzn_i, mxamzn_i1, mxamzn_i)


```

ARWR
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
arwr7_gd <- arwr7_decr_Days_grouped
arwr7_gi <- arwr7_incr_Days_grouped

#removes the row names 
row.names(arwr7_gd) <- NULL
row.names(arwr7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
arwr7_gd <- arwr7_gd[order(arwr7_gd$n),]
arwr7_gi <- arwr7_gi[order(arwr7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnarwr_d <- as.numeric(floor(quantile(arwr7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(arwr7_gd$n)/2)
mdnarwr_d1 <- as.numeric(arwr7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3arwr_d <- as.numeric(floor(quantile(arwr7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(arwr7_gd$n)*.75)
q3arwr_d1 <- as.numeric(arwr7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxarwr_d <- as.numeric(floor(quantile(arwr7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxarwr_d1 <- as.numeric(arwr7_gd[length(arwr7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnarwr_i <- as.numeric(floor(quantile(arwr7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(arwr7_gi$n)/2)
mdnarwr_i1 <- as.numeric(arwr7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3arwr_i <- as.numeric(floor(quantile(arwr7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(arwr7_gi$n)*.75)
q3arwr_i1 <- as.numeric(arwr7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxarwr_i <- as.numeric(floor(quantile(arwr7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxarwr_i1 <- as.numeric(arwr7_gi[length(arwr7_gi$n),1])


arwr_g <- grep('ARWR', ALL_52$stock)

ALL_52[arwr_g,18:29] <- c(mdnarwr_d1, mdnarwr_d, q3arwr_d1, q3arwr_d,
                         mxarwr_d1, mxarwr_d, mdnarwr_i1, mdnarwr_i,
                         q3arwr_i1, q3arwr_i, mxarwr_i1, mxarwr_i)


```

C
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
c7_gd <- c7_decr_Days_grouped
c7_gi <- c7_incr_Days_grouped

#removes the row names 
row.names(c7_gd) <- NULL
row.names(c7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
c7_gd <- c7_gd[order(c7_gd$n),]
c7_gi <- c7_gi[order(c7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnc_d <- as.numeric(floor(quantile(c7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(c7_gd$n)/2)
mdnc_d1 <- as.numeric(c7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3c_d <- as.numeric(floor(quantile(c7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(c7_gd$n)*.75)
q3c_d1 <- as.numeric(c7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxc_d <- as.numeric(floor(quantile(c7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxc_d1 <- as.numeric(c7_gd[length(c7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnc_i <- as.numeric(floor(quantile(c7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(c7_gi$n)/2)
mdnc_i1 <- as.numeric(c7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3c_i <- as.numeric(floor(quantile(c7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(c7_gi$n)*.75)
q3c_i1 <- as.numeric(c7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxc_i <- as.numeric(floor(quantile(c7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxc_i1 <- as.numeric(c7_gi[length(c7_gi$n),1])


c_g <- grep('^C$', ALL_52$stock)

ALL_52[c_g,18:29] <- c(mdnc_d1, mdnc_d, q3c_d1, q3c_d,
                         mxc_d1, mxc_d, mdnc_i1, mdnc_i,
                         q3c_i1, q3c_i, mxc_i1, mxc_i)


```

COST
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
cost7_gd <- cost7_decr_Days_grouped
cost7_gi <- cost7_incr_Days_grouped

#removes the row names 
row.names(cost7_gd) <- NULL
row.names(cost7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
cost7_gd <- cost7_gd[order(cost7_gd$n),]
cost7_gi <- cost7_gi[order(cost7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdncost_d <- as.numeric(floor(quantile(cost7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(cost7_gd$n)/2)
mdncost_d1 <- as.numeric(cost7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3cost_d <- as.numeric(floor(quantile(cost7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(cost7_gd$n)*.75)
q3cost_d1 <- as.numeric(cost7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxcost_d <- as.numeric(floor(quantile(cost7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxcost_d1 <- as.numeric(cost7_gd[length(cost7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdncost_i <- as.numeric(floor(quantile(cost7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(cost7_gi$n)/2)
mdncost_i1 <- as.numeric(cost7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3cost_i <- as.numeric(floor(quantile(cost7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(cost7_gi$n)*.75)
q3cost_i1 <- as.numeric(cost7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxcost_i <- as.numeric(floor(quantile(cost7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxcost_i1 <- as.numeric(cost7_gi[length(cost7_gi$n),1])


cost_g <- grep('COST', ALL_52$stock)

ALL_52[cost_g,18:29] <- c(mdncost_d1, mdncost_d, q3cost_d1, q3cost_d,
                         mxcost_d1, mxcost_d, mdncost_i1, mdncost_i,
                         q3cost_i1, q3cost_i, mxcost_i1, mxcost_i)


```

CVX
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
cvx7_gd <- cvx7_decr_Days_grouped
cvx7_gi <- cvx7_incr_Days_grouped

#removes the row names 
row.names(cvx7_gd) <- NULL
row.names(cvx7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
cvx7_gd <- cvx7_gd[order(cvx7_gd$n),]
cvx7_gi <- cvx7_gi[order(cvx7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdncvx_d <- as.numeric(floor(quantile(cvx7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(cvx7_gd$n)/2)
mdncvx_d1 <- as.numeric(cvx7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3cvx_d <- as.numeric(floor(quantile(cvx7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(cvx7_gd$n)*.75)
q3cvx_d1 <- as.numeric(cvx7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxcvx_d <- as.numeric(floor(quantile(cvx7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxcvx_d1 <- as.numeric(cvx7_gd[length(cvx7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdncvx_i <- as.numeric(floor(quantile(cvx7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(cvx7_gi$n)/2)
mdncvx_i1 <- as.numeric(cvx7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3cvx_i <- as.numeric(floor(quantile(cvx7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(cvx7_gi$n)*.75)
q3cvx_i1 <- as.numeric(cvx7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxcvx_i <- as.numeric(floor(quantile(cvx7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxcvx_i1 <- as.numeric(cvx7_gi[length(cvx7_gi$n),1])


cvx_g <- grep('CVX', ALL_52$stock)

ALL_52[cvx_g,18:29] <- c(mdncvx_d1, mdncvx_d, q3cvx_d1, q3cvx_d,
                         mxcvx_d1, mxcvx_d, mdncvx_i1, mdncvx_i,
                         q3cvx_i1, q3cvx_i, mxcvx_i1, mxcvx_i)


```

DLTR
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
dltr7_gd <- dltr7_decr_Days_grouped
dltr7_gi <- dltr7_incr_Days_grouped

#removes the row names 
row.names(dltr7_gd) <- NULL
row.names(dltr7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
dltr7_gd <- dltr7_gd[order(dltr7_gd$n),]
dltr7_gi <- dltr7_gi[order(dltr7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdndltr_d <- as.numeric(floor(quantile(dltr7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(dltr7_gd$n)/2)
mdndltr_d1 <- as.numeric(dltr7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3dltr_d <- as.numeric(floor(quantile(dltr7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(dltr7_gd$n)*.75)
q3dltr_d1 <- as.numeric(dltr7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxdltr_d <- as.numeric(floor(quantile(dltr7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxdltr_d1 <- as.numeric(dltr7_gd[length(dltr7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdndltr_i <- as.numeric(floor(quantile(dltr7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(dltr7_gi$n)/2)
mdndltr_i1 <- as.numeric(dltr7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3dltr_i <- as.numeric(floor(quantile(dltr7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(dltr7_gi$n)*.75)
q3dltr_i1 <- as.numeric(dltr7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxdltr_i <- as.numeric(floor(quantile(dltr7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxdltr_i1 <- as.numeric(dltr7_gi[length(dltr7_gi$n),1])


dltr_g <- grep('DLTR', ALL_52$stock)

ALL_52[dltr_g,18:29] <- c(mdndltr_d1, mdndltr_d, q3dltr_d1, q3dltr_d,
                         mxdltr_d1, mxdltr_d, mdndltr_i1, mdndltr_i,
                         q3dltr_i1, q3dltr_i, mxdltr_i1, mxdltr_i)


```

EPD
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
epd7_gd <- epd7_decr_Days_grouped
epd7_gi <- epd7_incr_Days_grouped

#removes the row names 
row.names(epd7_gd) <- NULL
row.names(epd7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
epd7_gd <- epd7_gd[order(epd7_gd$n),]
epd7_gi <- epd7_gi[order(epd7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnepd_d <- as.numeric(floor(quantile(epd7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(epd7_gd$n)/2)
mdnepd_d1 <- as.numeric(epd7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3epd_d <- as.numeric(floor(quantile(epd7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(epd7_gd$n)*.75)
q3epd_d1 <- as.numeric(epd7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxepd_d <- as.numeric(floor(quantile(epd7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxepd_d1 <- as.numeric(epd7_gd[length(epd7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnepd_i <- as.numeric(floor(quantile(epd7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(epd7_gi$n)/2)
mdnepd_i1 <- as.numeric(epd7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3epd_i <- as.numeric(floor(quantile(epd7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(epd7_gi$n)*.75)
q3epd_i1 <- as.numeric(epd7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxepd_i <- as.numeric(floor(quantile(epd7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxepd_i1 <- as.numeric(epd7_gi[length(epd7_gi$n),1])


epd_g <- grep('EPD', ALL_52$stock)

ALL_52[epd_g,18:29] <- c(mdnepd_d1, mdnepd_d, q3epd_d1, q3epd_d,
                         mxepd_d1, mxepd_d, mdnepd_i1, mdnepd_i,
                         q3epd_i1, q3epd_i, mxepd_i1, mxepd_i)


```

F
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
f7_gd <- f7_decr_Days_grouped
f7_gi <- f7_incr_Days_grouped

#removes the row names 
row.names(f7_gd) <- NULL
row.names(f7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
f7_gd <- f7_gd[order(f7_gd$n),]
f7_gi <- f7_gi[order(f7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnf_d <- as.numeric(floor(quantile(f7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(f7_gd$n)/2)
mdnf_d1 <- as.numeric(f7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3f_d <- as.numeric(floor(quantile(f7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(f7_gd$n)*.75)
q3f_d1 <- as.numeric(f7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxf_d <- as.numeric(floor(quantile(f7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxf_d1 <- as.numeric(f7_gd[length(f7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnf_i <- as.numeric(floor(quantile(f7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(f7_gi$n)/2)
mdnf_i1 <- as.numeric(f7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3f_i <- as.numeric(floor(quantile(f7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(f7_gi$n)*.75)
q3f_i1 <- as.numeric(f7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxf_i <- as.numeric(floor(quantile(f7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxf_i1 <- as.numeric(f7_gi[length(f7_gi$n),1])


f_g <- grep('^F$', ALL_52$stock)

ALL_52[f_g,18:29] <- c(mdnf_d1, mdnf_d, q3f_d1, q3f_d,
                         mxf_d1, mxf_d, mdnf_i1, mdnf_i,
                         q3f_i1, q3f_i, mxf_i1, mxf_i)


```

FFIN
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
ffin7_gd <- ffin7_decr_Days_grouped
ffin7_gi <- ffin7_incr_Days_grouped

#removes the row names 
row.names(ffin7_gd) <- NULL
row.names(ffin7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
ffin7_gd <- ffin7_gd[order(ffin7_gd$n),]
ffin7_gi <- ffin7_gi[order(ffin7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnffin_d <- as.numeric(floor(quantile(ffin7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(ffin7_gd$n)/2)
mdnffin_d1 <- as.numeric(ffin7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3ffin_d <- as.numeric(floor(quantile(ffin7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(ffin7_gd$n)*.75)
q3ffin_d1 <- as.numeric(ffin7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxffin_d <- as.numeric(floor(quantile(ffin7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxffin_d1 <- as.numeric(ffin7_gd[length(ffin7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnffin_i <- as.numeric(floor(quantile(ffin7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(ffin7_gi$n)/2)
mdnffin_i1 <- as.numeric(ffin7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3ffin_i <- as.numeric(floor(quantile(ffin7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(ffin7_gi$n)*.75)
q3ffin_i1 <- as.numeric(ffin7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxffin_i <- as.numeric(floor(quantile(ffin7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxffin_i1 <- as.numeric(ffin7_gi[length(ffin7_gi$n),1])


ffin_g <- grep('FFIN', ALL_52$stock)

ALL_52[ffin_g,18:29] <- c(mdnffin_d1, mdnffin_d, q3ffin_d1, q3ffin_d,
                         mxffin_d1, mxffin_d, mdnffin_i1, mdnffin_i,
                         q3ffin_i1, q3ffin_i, mxffin_i1, mxffin_i)


```

FTR
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
ftr7_gd <- ftr7_decr_Days_grouped
ftr7_gi <- ftr7_incr_Days_grouped

#removes the row names 
row.names(ftr7_gd) <- NULL
row.names(ftr7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
ftr7_gd <- ftr7_gd[order(ftr7_gd$n),]
ftr7_gi <- ftr7_gi[order(ftr7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnftr_d <- as.numeric(floor(quantile(ftr7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(ftr7_gd$n)/2)
mdnftr_d1 <- as.numeric(ftr7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3ftr_d <- as.numeric(floor(quantile(ftr7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(ftr7_gd$n)*.75)
q3ftr_d1 <- as.numeric(ftr7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxftr_d <- as.numeric(floor(quantile(ftr7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxftr_d1 <- as.numeric(ftr7_gd[length(ftr7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnftr_i <- as.numeric(floor(quantile(ftr7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(ftr7_gi$n)/2)
mdnftr_i1 <- as.numeric(ftr7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3ftr_i <- as.numeric(floor(quantile(ftr7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(ftr7_gi$n)*.75)
q3ftr_i1 <- as.numeric(ftr7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxftr_i <- as.numeric(floor(quantile(ftr7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxftr_i1 <- as.numeric(ftr7_gi[length(ftr7_gi$n),1])


ftr_g <- grep('FTR', ALL_52$stock)

ALL_52[ftr_g,18:29] <- c(mdnftr_d1, mdnftr_d, q3ftr_d1, q3ftr_d,
                         mxftr_d1, mxftr_d, mdnftr_i1, mdnftr_i,
                         q3ftr_i1, q3ftr_i, mxftr_i1, mxftr_i)


```

GOOG
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
goog7_gd <- goog7_decr_Days_grouped
goog7_gi <- goog7_incr_Days_grouped

#removes the row names 
row.names(goog7_gd) <- NULL
row.names(goog7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
goog7_gd <- goog7_gd[order(goog7_gd$n),]
goog7_gi <- goog7_gi[order(goog7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdngoog_d <- as.numeric(floor(quantile(goog7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(goog7_gd$n)/2)
mdngoog_d1 <- as.numeric(goog7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3goog_d <- as.numeric(floor(quantile(goog7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(goog7_gd$n)*.75)
q3goog_d1 <- as.numeric(goog7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxgoog_d <- as.numeric(floor(quantile(goog7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxgoog_d1 <- as.numeric(goog7_gd[length(goog7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdngoog_i <- as.numeric(floor(quantile(goog7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(goog7_gi$n)/2)
mdngoog_i1 <- as.numeric(goog7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3goog_i <- as.numeric(floor(quantile(goog7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(goog7_gi$n)*.75)
q3goog_i1 <- as.numeric(goog7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxgoog_i <- as.numeric(floor(quantile(goog7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxgoog_i1 <- as.numeric(goog7_gi[length(goog7_gi$n),1])


goog_g <- grep('GOOG', ALL_52$stock)

ALL_52[goog_g,18:29] <- c(mdngoog_d1, mdngoog_d, q3goog_d1, q3goog_d,
                         mxgoog_d1, mxgoog_d, mdngoog_i1, mdngoog_i,
                         q3goog_i1, q3goog_i, mxgoog_i1, mxgoog_i)


```

HD
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
hd7_gd <- hd7_decr_Days_grouped
hd7_gi <- hd7_incr_Days_grouped

#removes the row names 
row.names(hd7_gd) <- NULL
row.names(hd7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
hd7_gd <- hd7_gd[order(hd7_gd$n),]
hd7_gi <- hd7_gi[order(hd7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnhd_d <- as.numeric(floor(quantile(hd7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(hd7_gd$n)/2)
mdnhd_d1 <- as.numeric(hd7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3hd_d <- as.numeric(floor(quantile(hd7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(hd7_gd$n)*.75)
q3hd_d1 <- as.numeric(hd7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxhd_d <- as.numeric(floor(quantile(hd7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxhd_d1 <- as.numeric(hd7_gd[length(hd7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnhd_i <- as.numeric(floor(quantile(hd7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(hd7_gi$n)/2)
mdnhd_i1 <- as.numeric(hd7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3hd_i <- as.numeric(floor(quantile(hd7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(hd7_gi$n)*.75)
q3hd_i1 <- as.numeric(hd7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxhd_i <- as.numeric(floor(quantile(hd7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxhd_i1 <- as.numeric(hd7_gi[length(hd7_gi$n),1])


hd_g <- grep('HD', ALL_52$stock)

ALL_52[hd_g,18:29] <- c(mdnhd_d1, mdnhd_d, q3hd_d1, q3hd_d,
                         mxhd_d1, mxhd_d, mdnhd_i1, mdnhd_i,
                         q3hd_i1, q3hd_i, mxhd_i1, mxhd_i)


```

HMC
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
hmc7_gd <- hmc7_decr_Days_grouped
hmc7_gi <- hmc7_incr_Days_grouped

#removes the row names 
row.names(hmc7_gd) <- NULL
row.names(hmc7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
hmc7_gd <- hmc7_gd[order(hmc7_gd$n),]
hmc7_gi <- hmc7_gi[order(hmc7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnhmc_d <- as.numeric(floor(quantile(hmc7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(hmc7_gd$n)/2)
mdnhmc_d1 <- as.numeric(hmc7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3hmc_d <- as.numeric(floor(quantile(hmc7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(hmc7_gd$n)*.75)
q3hmc_d1 <- as.numeric(hmc7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxhmc_d <- as.numeric(floor(quantile(hmc7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxhmc_d1 <- as.numeric(hmc7_gd[length(hmc7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnhmc_i <- as.numeric(floor(quantile(hmc7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(hmc7_gi$n)/2)
mdnhmc_i1 <- as.numeric(hmc7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3hmc_i <- as.numeric(floor(quantile(hmc7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(hmc7_gi$n)*.75)
q3hmc_i1 <- as.numeric(hmc7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxhmc_i <- as.numeric(floor(quantile(hmc7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxhmc_i1 <- as.numeric(hmc7_gi[length(hmc7_gi$n),1])


hmc_g <- grep('HMC', ALL_52$stock)

ALL_52[hmc_g,18:29] <- c(mdnhmc_d1, mdnhmc_d, q3hmc_d1, q3hmc_d,
                         mxhmc_d1, mxhmc_d, mdnhmc_i1, mdnhmc_i,
                         q3hmc_i1, q3hmc_i, mxhmc_i1, mxhmc_i)


```


HOFT
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
hoft7_gd <- hoft7_decr_Days_grouped
hoft7_gi <- hoft7_incr_Days_grouped

#removes the row names 
row.names(hoft7_gd) <- NULL
row.names(hoft7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
hoft7_gd <- hoft7_gd[order(hoft7_gd$n),]
hoft7_gi <- hoft7_gi[order(hoft7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnhoft_d <- as.numeric(floor(quantile(hoft7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(hoft7_gd$n)/2)
mdnhoft_d1 <- as.numeric(hoft7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3hoft_d <- as.numeric(floor(quantile(hoft7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(hoft7_gd$n)*.75)
q3hoft_d1 <- as.numeric(hoft7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxhoft_d <- as.numeric(floor(quantile(hoft7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxhoft_d1 <- as.numeric(hoft7_gd[length(hoft7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnhoft_i <- as.numeric(floor(quantile(hoft7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(hoft7_gi$n)/2)
mdnhoft_i1 <- as.numeric(hoft7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3hoft_i <- as.numeric(floor(quantile(hoft7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(hoft7_gi$n)*.75)
q3hoft_i1 <- as.numeric(hoft7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxhoft_i <- as.numeric(floor(quantile(hoft7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxhoft_i1 <- as.numeric(hoft7_gi[length(hoft7_gi$n),1])


hoft_g <- grep('HOFT', ALL_52$stock)

ALL_52[hoft_g,18:29] <- c(mdnhoft_d1, mdnhoft_d, q3hoft_d1, q3hoft_d,
                         mxhoft_d1, mxhoft_d, mdnhoft_i1, mdnhoft_i,
                         q3hoft_i1, q3hoft_i, mxhoft_i1, mxhoft_i)


```

HRB
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
hrb7_gd <- hrb7_decr_Days_grouped
hrb7_gi <- hrb7_incr_Days_grouped

#removes the row names 
row.names(hrb7_gd) <- NULL
row.names(hrb7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
hrb7_gd <- hrb7_gd[order(hrb7_gd$n),]
hrb7_gi <- hrb7_gi[order(hrb7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnhrb_d <- as.numeric(floor(quantile(hrb7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(hrb7_gd$n)/2)
mdnhrb_d1 <- as.numeric(hrb7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3hrb_d <- as.numeric(floor(quantile(hrb7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(hrb7_gd$n)*.75)
q3hrb_d1 <- as.numeric(hrb7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxhrb_d <- as.numeric(floor(quantile(hrb7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxhrb_d1 <- as.numeric(hrb7_gd[length(hrb7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnhrb_i <- as.numeric(floor(quantile(hrb7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(hrb7_gi$n)/2)
mdnhrb_i1 <- as.numeric(hrb7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3hrb_i <- as.numeric(floor(quantile(hrb7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(hrb7_gi$n)*.75)
q3hrb_i1 <- as.numeric(hrb7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxhrb_i <- as.numeric(floor(quantile(hrb7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxhrb_i1 <- as.numeric(hrb7_gi[length(hrb7_gi$n),1])


hrb_g <- grep('HRB', ALL_52$stock)

ALL_52[hrb_g,18:29] <- c(mdnhrb_d1, mdnhrb_d, q3hrb_d1, q3hrb_d,
                         mxhrb_d1, mxhrb_d, mdnhrb_i1, mdnhrb_i,
                         q3hrb_i1, q3hrb_i, mxhrb_i1, mxhrb_i)


```

HST
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
hst7_gd <- hst7_decr_Days_grouped
hst7_gi <- hst7_incr_Days_grouped

#removes the row names 
row.names(hst7_gd) <- NULL
row.names(hst7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
hst7_gd <- hst7_gd[order(hst7_gd$n),]
hst7_gi <- hst7_gi[order(hst7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnhst_d <- as.numeric(floor(quantile(hst7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(hst7_gd$n)/2)
mdnhst_d1 <- as.numeric(hst7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3hst_d <- as.numeric(floor(quantile(hst7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(hst7_gd$n)*.75)
q3hst_d1 <- as.numeric(hst7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxhst_d <- as.numeric(floor(quantile(hst7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxhst_d1 <- as.numeric(hst7_gd[length(hst7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnhst_i <- as.numeric(floor(quantile(hst7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(hst7_gi$n)/2)
mdnhst_i1 <- as.numeric(hst7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3hst_i <- as.numeric(floor(quantile(hst7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(hst7_gi$n)*.75)
q3hst_i1 <- as.numeric(hst7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxhst_i <- as.numeric(floor(quantile(hst7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxhst_i1 <- as.numeric(hst7_gi[length(hst7_gi$n),1])


hst_g <- grep('HST', ALL_52$stock)

ALL_52[hst_g,18:29] <- c(mdnhst_d1, mdnhst_d, q3hst_d1, q3hst_d,
                         mxhst_d1, mxhst_d, mdnhst_i1, mdnhst_i,
                         q3hst_i1, q3hst_i, mxhst_i1, mxhst_i)


```

INO
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
ino7_gd <- ino7_decr_Days_grouped
ino7_gi <- ino7_incr_Days_grouped

#removes the row names 
row.names(ino7_gd) <- NULL
row.names(ino7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
ino7_gd <- ino7_gd[order(ino7_gd$n),]
ino7_gi <- ino7_gi[order(ino7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnino_d <- as.numeric(floor(quantile(ino7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(ino7_gd$n)/2)
mdnino_d1 <- as.numeric(ino7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3ino_d <- as.numeric(floor(quantile(ino7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(ino7_gd$n)*.75)
q3ino_d1 <- as.numeric(ino7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxino_d <- as.numeric(floor(quantile(ino7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxino_d1 <- as.numeric(ino7_gd[length(ino7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnino_i <- as.numeric(floor(quantile(ino7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(ino7_gi$n)/2)
mdnino_i1 <- as.numeric(ino7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3ino_i <- as.numeric(floor(quantile(ino7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(ino7_gi$n)*.75)
q3ino_i1 <- as.numeric(ino7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxino_i <- as.numeric(floor(quantile(ino7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxino_i1 <- as.numeric(ino7_gi[length(ino7_gi$n),1])


ino_g <- grep('INO', ALL_52$stock)

ALL_52[ino_g,18:29] <- c(mdnino_d1, mdnino_d, q3ino_d1, q3ino_d,
                         mxino_d1, mxino_d, mdnino_i1, mdnino_i,
                         q3ino_i1, q3ino_i, mxino_i1, mxino_i)


```

JBLU
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
jblu7_gd <- jblu7_decr_Days_grouped
jblu7_gi <- jblu7_incr_Days_grouped

#removes the row names 
row.names(jblu7_gd) <- NULL
row.names(jblu7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
jblu7_gd <- jblu7_gd[order(jblu7_gd$n),]
jblu7_gi <- jblu7_gi[order(jblu7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnjblu_d <- as.numeric(floor(quantile(jblu7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(jblu7_gd$n)/2)
mdnjblu_d1 <- as.numeric(jblu7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3jblu_d <- as.numeric(floor(quantile(jblu7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(jblu7_gd$n)*.75)
q3jblu_d1 <- as.numeric(jblu7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxjblu_d <- as.numeric(floor(quantile(jblu7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxjblu_d1 <- as.numeric(jblu7_gd[length(jblu7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnjblu_i <- as.numeric(floor(quantile(jblu7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(jblu7_gi$n)/2)
mdnjblu_i1 <- as.numeric(jblu7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3jblu_i <- as.numeric(floor(quantile(jblu7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(jblu7_gi$n)*.75)
q3jblu_i1 <- as.numeric(jblu7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxjblu_i <- as.numeric(floor(quantile(jblu7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxjblu_i1 <- as.numeric(jblu7_gi[length(jblu7_gi$n),1])


jblu_g <- grep('JBLU', ALL_52$stock)

ALL_52[jblu_g,18:29] <- c(mdnjblu_d1, mdnjblu_d, q3jblu_d1, q3jblu_d,
                         mxjblu_d1, mxjblu_d, mdnjblu_i1, mdnjblu_i,
                         q3jblu_i1, q3jblu_i, mxjblu_i1, mxjblu_i)


```

JNJ
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
jnj7_gd <- jnj7_decr_Days_grouped
jnj7_gi <- jnj7_incr_Days_grouped

#removes the row names 
row.names(jnj7_gd) <- NULL
row.names(jnj7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
jnj7_gd <- jnj7_gd[order(jnj7_gd$n),]
jnj7_gi <- jnj7_gi[order(jnj7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnjnj_d <- as.numeric(floor(quantile(jnj7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(jnj7_gd$n)/2)
mdnjnj_d1 <- as.numeric(jnj7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3jnj_d <- as.numeric(floor(quantile(jnj7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(jnj7_gd$n)*.75)
q3jnj_d1 <- as.numeric(jnj7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxjnj_d <- as.numeric(floor(quantile(jnj7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxjnj_d1 <- as.numeric(jnj7_gd[length(jnj7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnjnj_i <- as.numeric(floor(quantile(jnj7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(jnj7_gi$n)/2)
mdnjnj_i1 <- as.numeric(jnj7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3jnj_i <- as.numeric(floor(quantile(jnj7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(jnj7_gi$n)*.75)
q3jnj_i1 <- as.numeric(jnj7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxjnj_i <- as.numeric(floor(quantile(jnj7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxjnj_i1 <- as.numeric(jnj7_gi[length(jnj7_gi$n),1])


jnj_g <- grep('JNJ', ALL_52$stock)

ALL_52[jnj_g,18:29] <- c(mdnjnj_d1, mdnjnj_d, q3jnj_d1, q3jnj_d,
                         mxjnj_d1, mxjnj_d, mdnjnj_i1, mdnjnj_i,
                         q3jnj_i1, q3jnj_i, mxjnj_i1, mxjnj_i)


```

JPM
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
jpm7_gd <- jpm7_decr_Days_grouped
jpm7_gi <- jpm7_incr_Days_grouped

#removes the row names 
row.names(jpm7_gd) <- NULL
row.names(jpm7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
jpm7_gd <- jpm7_gd[order(jpm7_gd$n),]
jpm7_gi <- jpm7_gi[order(jpm7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnjpm_d <- as.numeric(floor(quantile(jpm7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(jpm7_gd$n)/2)
mdnjpm_d1 <- as.numeric(jpm7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3jpm_d <- as.numeric(floor(quantile(jpm7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(jpm7_gd$n)*.75)
q3jpm_d1 <- as.numeric(jpm7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxjpm_d <- as.numeric(floor(quantile(jpm7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxjpm_d1 <- as.numeric(jpm7_gd[length(jpm7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnjpm_i <- as.numeric(floor(quantile(jpm7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(jpm7_gi$n)/2)
mdnjpm_i1 <- as.numeric(jpm7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3jpm_i <- as.numeric(floor(quantile(jpm7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(jpm7_gi$n)*.75)
q3jpm_i1 <- as.numeric(jpm7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxjpm_i <- as.numeric(floor(quantile(jpm7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxjpm_i1 <- as.numeric(jpm7_gi[length(jpm7_gi$n),1])


jpm_g <- grep('JPM', ALL_52$stock)

ALL_52[jpm_g,18:29] <- c(mdnjpm_d1, mdnjpm_d, q3jpm_d1, q3jpm_d,
                         mxjpm_d1, mxjpm_d, mdnjpm_i1, mdnjpm_i,
                         q3jpm_i1, q3jpm_i, mxjpm_i1, mxjpm_i)


```

JWN
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
jwn7_gd <- jwn7_decr_Days_grouped
jwn7_gi <- jwn7_incr_Days_grouped

#removes the row names 
row.names(jwn7_gd) <- NULL
row.names(jwn7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
jwn7_gd <- jwn7_gd[order(jwn7_gd$n),]
jwn7_gi <- jwn7_gi[order(jwn7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnjwn_d <- as.numeric(floor(quantile(jwn7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(jwn7_gd$n)/2)
mdnjwn_d1 <- as.numeric(jwn7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3jwn_d <- as.numeric(floor(quantile(jwn7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(jwn7_gd$n)*.75)
q3jwn_d1 <- as.numeric(jwn7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxjwn_d <- as.numeric(floor(quantile(jwn7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxjwn_d1 <- as.numeric(jwn7_gd[length(jwn7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnjwn_i <- as.numeric(floor(quantile(jwn7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(jwn7_gi$n)/2)
mdnjwn_i1 <- as.numeric(jwn7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3jwn_i <- as.numeric(floor(quantile(jwn7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(jwn7_gi$n)*.75)
q3jwn_i1 <- as.numeric(jwn7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxjwn_i <- as.numeric(floor(quantile(jwn7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxjwn_i1 <- as.numeric(jwn7_gi[length(jwn7_gi$n),1])


jwn_g <- grep('JWN', ALL_52$stock)

ALL_52[jwn_g,18:29] <- c(mdnjwn_d1, mdnjwn_d, q3jwn_d1, q3jwn_d,
                         mxjwn_d1, mxjwn_d, mdnjwn_i1, mdnjwn_i,
                         q3jwn_i1, q3jwn_i, mxjwn_i1, mxjwn_i)


```

KGJI
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
kgji7_gd <- kgji7_decr_Days_grouped
kgji7_gi <- kgji7_incr_Days_grouped

#removes the row names 
row.names(kgji7_gd) <- NULL
row.names(kgji7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
kgji7_gd <- kgji7_gd[order(kgji7_gd$n),]
kgji7_gi <- kgji7_gi[order(kgji7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnkgji_d <- as.numeric(floor(quantile(kgji7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(kgji7_gd$n)/2)
mdnkgji_d1 <- as.numeric(kgji7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3kgji_d <- as.numeric(floor(quantile(kgji7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(kgji7_gd$n)*.75)
q3kgji_d1 <- as.numeric(kgji7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxkgji_d <- as.numeric(floor(quantile(kgji7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxkgji_d1 <- as.numeric(kgji7_gd[length(kgji7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnkgji_i <- as.numeric(floor(quantile(kgji7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(kgji7_gi$n)/2)
mdnkgji_i1 <- as.numeric(kgji7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3kgji_i <- as.numeric(floor(quantile(kgji7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(kgji7_gi$n)*.75)
q3kgji_i1 <- as.numeric(kgji7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxkgji_i <- as.numeric(floor(quantile(kgji7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxkgji_i1 <- as.numeric(kgji7_gi[length(kgji7_gi$n),1])


kgji_g <- grep('KGJI', ALL_52$stock)

ALL_52[kgji_g,18:29] <- c(mdnkgji_d1, mdnkgji_d, q3kgji_d1, q3kgji_d,
                         mxkgji_d1, mxkgji_d, mdnkgji_i1, mdnkgji_i,
                         q3kgji_i1, q3kgji_i, mxkgji_i1, mxkgji_i)


```

KSS
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
kss7_gd <- kss7_decr_Days_grouped
kss7_gi <- kss7_incr_Days_grouped

#removes the row names 
row.names(kss7_gd) <- NULL
row.names(kss7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
kss7_gd <- kss7_gd[order(kss7_gd$n),]
kss7_gi <- kss7_gi[order(kss7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnkss_d <- as.numeric(floor(quantile(kss7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(kss7_gd$n)/2)
mdnkss_d1 <- as.numeric(kss7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3kss_d <- as.numeric(floor(quantile(kss7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(kss7_gd$n)*.75)
q3kss_d1 <- as.numeric(kss7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxkss_d <- as.numeric(floor(quantile(kss7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxkss_d1 <- as.numeric(kss7_gd[length(kss7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnkss_i <- as.numeric(floor(quantile(kss7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(kss7_gi$n)/2)
mdnkss_i1 <- as.numeric(kss7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3kss_i <- as.numeric(floor(quantile(kss7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(kss7_gi$n)*.75)
q3kss_i1 <- as.numeric(kss7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxkss_i <- as.numeric(floor(quantile(kss7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxkss_i1 <- as.numeric(kss7_gi[length(kss7_gi$n),1])


kss_g <- grep('KSS', ALL_52$stock)

ALL_52[kss_g,18:29] <- c(mdnkss_d1, mdnkss_d, q3kss_d1, q3kss_d,
                         mxkss_d1, mxkss_d, mdnkss_i1, mdnkss_i,
                         q3kss_i1, q3kss_i, mxkss_i1, mxkss_i)


```

LUV
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
luv7_gd <- luv7_decr_Days_grouped
luv7_gi <- luv7_incr_Days_grouped

#removes the row names 
row.names(luv7_gd) <- NULL
row.names(luv7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
luv7_gd <- luv7_gd[order(luv7_gd$n),]
luv7_gi <- luv7_gi[order(luv7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnluv_d <- as.numeric(floor(quantile(luv7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(luv7_gd$n)/2)
mdnluv_d1 <- as.numeric(luv7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3luv_d <- as.numeric(floor(quantile(luv7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(luv7_gd$n)*.75)
q3luv_d1 <- as.numeric(luv7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxluv_d <- as.numeric(floor(quantile(luv7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxluv_d1 <- as.numeric(luv7_gd[length(luv7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnluv_i <- as.numeric(floor(quantile(luv7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(luv7_gi$n)/2)
mdnluv_i1 <- as.numeric(luv7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3luv_i <- as.numeric(floor(quantile(luv7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(luv7_gi$n)*.75)
q3luv_i1 <- as.numeric(luv7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxluv_i <- as.numeric(floor(quantile(luv7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxluv_i1 <- as.numeric(luv7_gi[length(luv7_gi$n),1])


luv_g <- grep('LUV', ALL_52$stock)

ALL_52[luv_g,18:29] <- c(mdnluv_d1, mdnluv_d, q3luv_d1, q3luv_d,
                         mxluv_d1, mxluv_d, mdnluv_i1, mdnluv_i,
                         q3luv_i1, q3luv_i, mxluv_i1, mxluv_i)


```

M
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
m7_gd <- m7_decr_Days_grouped
m7_gi <- m7_incr_Days_grouped

#removes the row names 
row.names(m7_gd) <- NULL
row.names(m7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
m7_gd <- m7_gd[order(m7_gd$n),]
m7_gi <- m7_gi[order(m7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnm_d <- as.numeric(floor(quantile(m7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(m7_gd$n)/2)
mdnm_d1 <- as.numeric(m7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3m_d <- as.numeric(floor(quantile(m7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(m7_gd$n)*.75)
q3m_d1 <- as.numeric(m7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxm_d <- as.numeric(floor(quantile(m7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxm_d1 <- as.numeric(m7_gd[length(m7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnm_i <- as.numeric(floor(quantile(m7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(m7_gi$n)/2)
mdnm_i1 <- as.numeric(m7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3m_i <- as.numeric(floor(quantile(m7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(m7_gi$n)*.75)
q3m_i1 <- as.numeric(m7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxm_i <- as.numeric(floor(quantile(m7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxm_i1 <- as.numeric(m7_gi[length(m7_gi$n),1])


m_g <- grep('^M$', ALL_52$stock)

ALL_52[m_g,18:29] <- c(mdnm_d1, mdnm_d, q3m_d1, q3m_d,
                         mxm_d1, mxm_d, mdnm_i1, mdnm_i,
                         q3m_i1, q3m_i, mxm_i1, mxm_i)


```

MGM
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
mgm7_gd <- mgm7_decr_Days_grouped
mgm7_gi <- mgm7_incr_Days_grouped

#removes the row names 
row.names(mgm7_gd) <- NULL
row.names(mgm7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
mgm7_gd <- mgm7_gd[order(mgm7_gd$n),]
mgm7_gi <- mgm7_gi[order(mgm7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnmgm_d <- as.numeric(floor(quantile(mgm7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(mgm7_gd$n)/2)
mdnmgm_d1 <- as.numeric(mgm7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3mgm_d <- as.numeric(floor(quantile(mgm7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(mgm7_gd$n)*.75)
q3mgm_d1 <- as.numeric(mgm7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxmgm_d <- as.numeric(floor(quantile(mgm7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxmgm_d1 <- as.numeric(mgm7_gd[length(mgm7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnmgm_i <- as.numeric(floor(quantile(mgm7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(mgm7_gi$n)/2)
mdnmgm_i1 <- as.numeric(mgm7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3mgm_i <- as.numeric(floor(quantile(mgm7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(mgm7_gi$n)*.75)
q3mgm_i1 <- as.numeric(mgm7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxmgm_i <- as.numeric(floor(quantile(mgm7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxmgm_i1 <- as.numeric(mgm7_gi[length(mgm7_gi$n),1])


mgm_g <- grep('MGM', ALL_52$stock)

ALL_52[mgm_g,18:29] <- c(mdnmgm_d1, mdnmgm_d, q3mgm_d1, q3mgm_d,
                         mxmgm_d1, mxmgm_d, mdnmgm_i1, mdnmgm_i,
                         q3mgm_i1, q3mgm_i, mxmgm_i1, mxmgm_i)


```


MSFT
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
msft7_gd <- msft7_decr_Days_grouped
msft7_gi <- msft7_incr_Days_grouped

#removes the row names 
row.names(msft7_gd) <- NULL
row.names(msft7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
msft7_gd <- msft7_gd[order(msft7_gd$n),]
msft7_gi <- msft7_gi[order(msft7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnmsft_d <- as.numeric(floor(quantile(msft7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(msft7_gd$n)/2)
mdnmsft_d1 <- as.numeric(msft7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3msft_d <- as.numeric(floor(quantile(msft7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(msft7_gd$n)*.75)
q3msft_d1 <- as.numeric(msft7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxmsft_d <- as.numeric(floor(quantile(msft7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxmsft_d1 <- as.numeric(msft7_gd[length(msft7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnmsft_i <- as.numeric(floor(quantile(msft7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(msft7_gi$n)/2)
mdnmsft_i1 <- as.numeric(msft7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3msft_i <- as.numeric(floor(quantile(msft7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(msft7_gi$n)*.75)
q3msft_i1 <- as.numeric(msft7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxmsft_i <- as.numeric(floor(quantile(msft7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxmsft_i1 <- as.numeric(msft7_gi[length(msft7_gi$n),1])


msft_g <- grep('MSFT', ALL_52$stock)

ALL_52[msft_g,18:29] <- c(mdnmsft_d1, mdnmsft_d, q3msft_d1, q3msft_d,
                         mxmsft_d1, mxmsft_d, mdnmsft_i1, mdnmsft_i,
                         q3msft_i1, q3msft_i, mxmsft_i1, mxmsft_i)


```


NFLX
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
nflx7_gd <- nflx7_decr_Days_grouped
nflx7_gi <- nflx7_incr_Days_grouped

#removes the row names 
row.names(nflx7_gd) <- NULL
row.names(nflx7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
nflx7_gd <- nflx7_gd[order(nflx7_gd$n),]
nflx7_gi <- nflx7_gi[order(nflx7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnnflx_d <- as.numeric(floor(quantile(nflx7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(nflx7_gd$n)/2)
mdnnflx_d1 <- as.numeric(nflx7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3nflx_d <- as.numeric(floor(quantile(nflx7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(nflx7_gd$n)*.75)
q3nflx_d1 <- as.numeric(nflx7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxnflx_d <- as.numeric(floor(quantile(nflx7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxnflx_d1 <- as.numeric(nflx7_gd[length(nflx7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnnflx_i <- as.numeric(floor(quantile(nflx7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(nflx7_gi$n)/2)
mdnnflx_i1 <- as.numeric(nflx7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3nflx_i <- as.numeric(floor(quantile(nflx7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(nflx7_gi$n)*.75)
q3nflx_i1 <- as.numeric(nflx7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxnflx_i <- as.numeric(floor(quantile(nflx7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxnflx_i1 <- as.numeric(nflx7_gi[length(nflx7_gi$n),1])


nflx_g <- grep('NFLX', ALL_52$stock)

ALL_52[nflx_g,18:29] <- c(mdnnflx_d1, mdnnflx_d, q3nflx_d1, q3nflx_d,
                         mxnflx_d1, mxnflx_d, mdnnflx_i1, mdnnflx_i,
                         q3nflx_i1, q3nflx_i, mxnflx_i1, mxnflx_i)


```

NKE
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
nke7_gd <- nke7_decr_Days_grouped
nke7_gi <- nke7_incr_Days_grouped

#removes the row names 
row.names(nke7_gd) <- NULL
row.names(nke7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
nke7_gd <- nke7_gd[order(nke7_gd$n),]
nke7_gi <- nke7_gi[order(nke7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnnke_d <- as.numeric(floor(quantile(nke7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(nke7_gd$n)/2)
mdnnke_d1 <- as.numeric(nke7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3nke_d <- as.numeric(floor(quantile(nke7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(nke7_gd$n)*.75)
q3nke_d1 <- as.numeric(nke7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxnke_d <- as.numeric(floor(quantile(nke7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxnke_d1 <- as.numeric(nke7_gd[length(nke7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnnke_i <- as.numeric(floor(quantile(nke7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(nke7_gi$n)/2)
mdnnke_i1 <- as.numeric(nke7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3nke_i <- as.numeric(floor(quantile(nke7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(nke7_gi$n)*.75)
q3nke_i1 <- as.numeric(nke7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxnke_i <- as.numeric(floor(quantile(nke7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxnke_i1 <- as.numeric(nke7_gi[length(nke7_gi$n),1])


nke_g <- grep('NKE', ALL_52$stock)

ALL_52[nke_g,18:29] <- c(mdnnke_d1, mdnnke_d, q3nke_d1, q3nke_d,
                         mxnke_d1, mxnke_d, mdnnke_i1, mdnnke_i,
                         q3nke_i1, q3nke_i, mxnke_i1, mxnke_i)


```

NSANY
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
nsany7_gd <- nsany7_decr_Days_grouped
nsany7_gi <- nsany7_incr_Days_grouped

#removes the row names 
row.names(nsany7_gd) <- NULL
row.names(nsany7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
nsany7_gd <- nsany7_gd[order(nsany7_gd$n),]
nsany7_gi <- nsany7_gi[order(nsany7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnnsany_d <- as.numeric(floor(quantile(nsany7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(nsany7_gd$n)/2)
mdnnsany_d1 <- as.numeric(nsany7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3nsany_d <- as.numeric(floor(quantile(nsany7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(nsany7_gd$n)*.75)
q3nsany_d1 <- as.numeric(nsany7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxnsany_d <- as.numeric(floor(quantile(nsany7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxnsany_d1 <- as.numeric(nsany7_gd[length(nsany7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnnsany_i <- as.numeric(floor(quantile(nsany7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(nsany7_gi$n)/2)
mdnnsany_i1 <- as.numeric(nsany7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3nsany_i <- as.numeric(floor(quantile(nsany7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(nsany7_gi$n)*.75)
q3nsany_i1 <- as.numeric(nsany7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxnsany_i <- as.numeric(floor(quantile(nsany7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxnsany_i1 <- as.numeric(nsany7_gi[length(nsany7_gi$n),1])


nsany_g <- grep('NSANY', ALL_52$stock)

ALL_52[nsany_g,18:29] <- c(mdnnsany_d1, mdnnsany_d, q3nsany_d1, q3nsany_d,
                         mxnsany_d1, mxnsany_d, mdnnsany_i1, mdnnsany_i,
                         q3nsany_i1, q3nsany_i, mxnsany_i1, mxnsany_i)


```

NUS
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
nus7_gd <- nus7_decr_Days_grouped
nus7_gi <- nus7_incr_Days_grouped

#removes the row names 
row.names(nus7_gd) <- NULL
row.names(nus7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
nus7_gd <- nus7_gd[order(nus7_gd$n),]
nus7_gi <- nus7_gi[order(nus7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnnus_d <- as.numeric(floor(quantile(nus7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(nus7_gd$n)/2)
mdnnus_d1 <- as.numeric(nus7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3nus_d <- as.numeric(floor(quantile(nus7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(nus7_gd$n)*.75)
q3nus_d1 <- as.numeric(nus7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxnus_d <- as.numeric(floor(quantile(nus7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxnus_d1 <- as.numeric(nus7_gd[length(nus7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnnus_i <- as.numeric(floor(quantile(nus7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(nus7_gi$n)/2)
mdnnus_i1 <- as.numeric(nus7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3nus_i <- as.numeric(floor(quantile(nus7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(nus7_gi$n)*.75)
q3nus_i1 <- as.numeric(nus7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxnus_i <- as.numeric(floor(quantile(nus7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxnus_i1 <- as.numeric(nus7_gi[length(nus7_gi$n),1])


nus_g <- grep('NUS', ALL_52$stock)

ALL_52[nus_g,18:29] <- c(mdnnus_d1, mdnnus_d, q3nus_d1, q3nus_d,
                         mxnus_d1, mxnus_d, mdnnus_i1, mdnnus_i,
                         q3nus_i1, q3nus_i, mxnus_i1, mxnus_i)


```

ONCY
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
oncy7_gd <- oncy7_decr_Days_grouped
oncy7_gi <- oncy7_incr_Days_grouped

#removes the row names 
row.names(oncy7_gd) <- NULL
row.names(oncy7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
oncy7_gd <- oncy7_gd[order(oncy7_gd$n),]
oncy7_gi <- oncy7_gi[order(oncy7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnoncy_d <- as.numeric(floor(quantile(oncy7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(oncy7_gd$n)/2)
mdnoncy_d1 <- as.numeric(oncy7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3oncy_d <- as.numeric(floor(quantile(oncy7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(oncy7_gd$n)*.75)
q3oncy_d1 <- as.numeric(oncy7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxoncy_d <- as.numeric(floor(quantile(oncy7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxoncy_d1 <- as.numeric(oncy7_gd[length(oncy7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnoncy_i <- as.numeric(floor(quantile(oncy7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(oncy7_gi$n)/2)
mdnoncy_i1 <- as.numeric(oncy7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3oncy_i <- as.numeric(floor(quantile(oncy7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(oncy7_gi$n)*.75)
q3oncy_i1 <- as.numeric(oncy7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxoncy_i <- as.numeric(floor(quantile(oncy7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxoncy_i1 <- as.numeric(oncy7_gi[length(oncy7_gi$n),1])


oncy_g <- grep('ONCY', ALL_52$stock)

ALL_52[oncy_g,18:29] <- c(mdnoncy_d1, mdnoncy_d, q3oncy_d1, q3oncy_d,
                         mxoncy_d1, mxoncy_d, mdnoncy_i1, mdnoncy_i,
                         q3oncy_i1, q3oncy_i, mxoncy_i1, mxoncy_i)


```

PCG
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
pcg7_gd <- pcg7_decr_Days_grouped
pcg7_gi <- pcg7_incr_Days_grouped

#removes the row names 
row.names(pcg7_gd) <- NULL
row.names(pcg7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
pcg7_gd <- pcg7_gd[order(pcg7_gd$n),]
pcg7_gi <- pcg7_gi[order(pcg7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnpcg_d <- as.numeric(floor(quantile(pcg7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(pcg7_gd$n)/2)
mdnpcg_d1 <- as.numeric(pcg7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3pcg_d <- as.numeric(floor(quantile(pcg7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(pcg7_gd$n)*.75)
q3pcg_d1 <- as.numeric(pcg7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxpcg_d <- as.numeric(floor(quantile(pcg7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxpcg_d1 <- as.numeric(pcg7_gd[length(pcg7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnpcg_i <- as.numeric(floor(quantile(pcg7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(pcg7_gi$n)/2)
mdnpcg_i1 <- as.numeric(pcg7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3pcg_i <- as.numeric(floor(quantile(pcg7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(pcg7_gi$n)*.75)
q3pcg_i1 <- as.numeric(pcg7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxpcg_i <- as.numeric(floor(quantile(pcg7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxpcg_i1 <- as.numeric(pcg7_gi[length(pcg7_gi$n),1])


pcg_g <- grep('PCG', ALL_52$stock)

ALL_52[pcg_g,18:29] <- c(mdnpcg_d1, mdnpcg_d, q3pcg_d1, q3pcg_d,
                         mxpcg_d1, mxpcg_d, mdnpcg_i1, mdnpcg_i,
                         q3pcg_i1, q3pcg_i, mxpcg_i1, mxpcg_i)


```

ROST
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
rost7_gd <- rost7_decr_Days_grouped
rost7_gi <- rost7_incr_Days_grouped

#removes the row names 
row.names(rost7_gd) <- NULL
row.names(rost7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
rost7_gd <- rost7_gd[order(rost7_gd$n),]
rost7_gi <- rost7_gi[order(rost7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnrost_d <- as.numeric(floor(quantile(rost7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(rost7_gd$n)/2)
mdnrost_d1 <- as.numeric(rost7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3rost_d <- as.numeric(floor(quantile(rost7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(rost7_gd$n)*.75)
q3rost_d1 <- as.numeric(rost7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxrost_d <- as.numeric(floor(quantile(rost7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxrost_d1 <- as.numeric(rost7_gd[length(rost7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnrost_i <- as.numeric(floor(quantile(rost7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(rost7_gi$n)/2)
mdnrost_i1 <- as.numeric(rost7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3rost_i <- as.numeric(floor(quantile(rost7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(rost7_gi$n)*.75)
q3rost_i1 <- as.numeric(rost7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxrost_i <- as.numeric(floor(quantile(rost7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxrost_i1 <- as.numeric(rost7_gi[length(rost7_gi$n),1])


rost_g <- grep('ROST', ALL_52$stock)

ALL_52[rost_g,18:29] <- c(mdnrost_d1, mdnrost_d, q3rost_d1, q3rost_d,
                         mxrost_d1, mxrost_d, mdnrost_i1, mdnrost_i,
                         q3rost_i1, q3rost_i, mxrost_i1, mxrost_i)


```

RRGB
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
rrgb7_gd <- rrgb7_decr_Days_grouped
rrgb7_gi <- rrgb7_incr_Days_grouped

#removes the row names 
row.names(rrgb7_gd) <- NULL
row.names(rrgb7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
rrgb7_gd <- rrgb7_gd[order(rrgb7_gd$n),]
rrgb7_gi <- rrgb7_gi[order(rrgb7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnrrgb_d <- as.numeric(floor(quantile(rrgb7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(rrgb7_gd$n)/2)
mdnrrgb_d1 <- as.numeric(rrgb7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3rrgb_d <- as.numeric(floor(quantile(rrgb7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(rrgb7_gd$n)*.75)
q3rrgb_d1 <- as.numeric(rrgb7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxrrgb_d <- as.numeric(floor(quantile(rrgb7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxrrgb_d1 <- as.numeric(rrgb7_gd[length(rrgb7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnrrgb_i <- as.numeric(floor(quantile(rrgb7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(rrgb7_gi$n)/2)
mdnrrgb_i1 <- as.numeric(rrgb7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3rrgb_i <- as.numeric(floor(quantile(rrgb7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(rrgb7_gi$n)*.75)
q3rrgb_i1 <- as.numeric(rrgb7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxrrgb_i <- as.numeric(floor(quantile(rrgb7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxrrgb_i1 <- as.numeric(rrgb7_gi[length(rrgb7_gi$n),1])


rrgb_g <- grep('RRGB', ALL_52$stock)

ALL_52[rrgb_g,18:29] <- c(mdnrrgb_d1, mdnrrgb_d, q3rrgb_d1, q3rrgb_d,
                         mxrrgb_d1, mxrrgb_d, mdnrrgb_i1, mdnrrgb_i,
                         q3rrgb_i1, q3rrgb_i, mxrrgb_i1, mxrrgb_i)


```

S
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
s7_gd <- s7_decr_Days_grouped
s7_gi <- s7_incr_Days_grouped

#removes the row names 
row.names(s7_gd) <- NULL
row.names(s7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
s7_gd <- s7_gd[order(s7_gd$n),]
s7_gi <- s7_gi[order(s7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdns_d <- as.numeric(floor(quantile(s7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(s7_gd$n)/2)
mdns_d1 <- as.numeric(s7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3s_d <- as.numeric(floor(quantile(s7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(s7_gd$n)*.75)
q3s_d1 <- as.numeric(s7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxs_d <- as.numeric(floor(quantile(s7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxs_d1 <- as.numeric(s7_gd[length(s7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdns_i <- as.numeric(floor(quantile(s7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(s7_gi$n)/2)
mdns_i1 <- as.numeric(s7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3s_i <- as.numeric(floor(quantile(s7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(s7_gi$n)*.75)
q3s_i1 <- as.numeric(s7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxs_i <- as.numeric(floor(quantile(s7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxs_i1 <- as.numeric(s7_gi[length(s7_gi$n),1])


s_g <- grep('S$', ALL_52$stock)

ALL_52[s_g,18:29] <- c(mdns_d1, mdns_d, q3s_d1, q3s_d,
                         mxs_d1, mxs_d, mdns_i1, mdns_i,
                         q3s_i1, q3s_i, mxs_i1, mxs_i)


```

SIG
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
sig7_gd <- sig7_decr_Days_grouped
sig7_gi <- sig7_incr_Days_grouped

#removes the row names 
row.names(sig7_gd) <- NULL
row.names(sig7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
sig7_gd <- sig7_gd[order(sig7_gd$n),]
sig7_gi <- sig7_gi[order(sig7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnsig_d <- as.numeric(floor(quantile(sig7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(sig7_gd$n)/2)
mdnsig_d1 <- as.numeric(sig7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3sig_d <- as.numeric(floor(quantile(sig7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(sig7_gd$n)*.75)
q3sig_d1 <- as.numeric(sig7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxsig_d <- as.numeric(floor(quantile(sig7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxsig_d1 <- as.numeric(sig7_gd[length(sig7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnsig_i <- as.numeric(floor(quantile(sig7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(sig7_gi$n)/2)
mdnsig_i1 <- as.numeric(sig7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3sig_i <- as.numeric(floor(quantile(sig7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(sig7_gi$n)*.75)
q3sig_i1 <- as.numeric(sig7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxsig_i <- as.numeric(floor(quantile(sig7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxsig_i1 <- as.numeric(sig7_gi[length(sig7_gi$n),1])


sig_g <- grep('SIG', ALL_52$stock)

ALL_52[sig_g,18:29] <- c(mdnsig_d1, mdnsig_d, q3sig_d1, q3sig_d,
                         mxsig_d1, mxsig_d, mdnsig_i1, mdnsig_i,
                         q3sig_i1, q3sig_i, mxsig_i1, mxsig_i)


```

T
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
t7_gd <- t7_decr_Days_grouped
t7_gi <- t7_incr_Days_grouped

#removes the row names 
row.names(t7_gd) <- NULL
row.names(t7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
t7_gd <- t7_gd[order(t7_gd$n),]
t7_gi <- t7_gi[order(t7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnt_d <- as.numeric(floor(quantile(t7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(t7_gd$n)/2)
mdnt_d1 <- as.numeric(t7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3t_d <- as.numeric(floor(quantile(t7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(t7_gd$n)*.75)
q3t_d1 <- as.numeric(t7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxt_d <- as.numeric(floor(quantile(t7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxt_d1 <- as.numeric(t7_gd[length(t7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnt_i <- as.numeric(floor(quantile(t7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(t7_gi$n)/2)
mdnt_i1 <- as.numeric(t7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3t_i <- as.numeric(floor(quantile(t7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(t7_gi$n)*.75)
q3t_i1 <- as.numeric(t7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxt_i <- as.numeric(floor(quantile(t7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxt_i1 <- as.numeric(t7_gi[length(t7_gi$n),1])


t_g <- grep('^T$', ALL_52$stock)

ALL_52[t_g,18:29] <- c(mdnt_d1, mdnt_d, q3t_d1, q3t_d,
                         mxt_d1, mxt_d, mdnt_i1, mdnt_i,
                         q3t_i1, q3t_i, mxt_i1, mxt_i)


```

TEVA
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
teva7_gd <- teva7_decr_Days_grouped
teva7_gi <- teva7_incr_Days_grouped

#removes the row names 
row.names(teva7_gd) <- NULL
row.names(teva7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
teva7_gd <- teva7_gd[order(teva7_gd$n),]
teva7_gi <- teva7_gi[order(teva7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnteva_d <- as.numeric(floor(quantile(teva7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(teva7_gd$n)/2)
mdnteva_d1 <- as.numeric(teva7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3teva_d <- as.numeric(floor(quantile(teva7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(teva7_gd$n)*.75)
q3teva_d1 <- as.numeric(teva7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxteva_d <- as.numeric(floor(quantile(teva7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxteva_d1 <- as.numeric(teva7_gd[length(teva7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnteva_i <- as.numeric(floor(quantile(teva7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(teva7_gi$n)/2)
mdnteva_i1 <- as.numeric(teva7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3teva_i <- as.numeric(floor(quantile(teva7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(teva7_gi$n)*.75)
q3teva_i1 <- as.numeric(teva7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxteva_i <- as.numeric(floor(quantile(teva7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxteva_i1 <- as.numeric(teva7_gi[length(teva7_gi$n),1])


teva_g <- grep('TEVA', ALL_52$stock)

ALL_52[teva_g,18:29] <- c(mdnteva_d1, mdnteva_d, q3teva_d1, q3teva_d,
                         mxteva_d1, mxteva_d, mdnteva_i1, mdnteva_i,
                         q3teva_i1, q3teva_i, mxteva_i1, mxteva_i)


```

TGT
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
tgt7_gd <- tgt7_decr_Days_grouped
tgt7_gi <- tgt7_incr_Days_grouped

#removes the row names 
row.names(tgt7_gd) <- NULL
row.names(tgt7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
tgt7_gd <- tgt7_gd[order(tgt7_gd$n),]
tgt7_gi <- tgt7_gi[order(tgt7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdntgt_d <- as.numeric(floor(quantile(tgt7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(tgt7_gd$n)/2)
mdntgt_d1 <- as.numeric(tgt7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3tgt_d <- as.numeric(floor(quantile(tgt7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(tgt7_gd$n)*.75)
q3tgt_d1 <- as.numeric(tgt7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxtgt_d <- as.numeric(floor(quantile(tgt7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxtgt_d1 <- as.numeric(tgt7_gd[length(tgt7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdntgt_i <- as.numeric(floor(quantile(tgt7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(tgt7_gi$n)/2)
mdntgt_i1 <- as.numeric(tgt7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3tgt_i <- as.numeric(floor(quantile(tgt7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(tgt7_gi$n)*.75)
q3tgt_i1 <- as.numeric(tgt7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxtgt_i <- as.numeric(floor(quantile(tgt7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxtgt_i1 <- as.numeric(tgt7_gi[length(tgt7_gi$n),1])


tgt_g <- grep('TGT', ALL_52$stock)

ALL_52[tgt_g,18:29] <- c(mdntgt_d1, mdntgt_d, q3tgt_d1, q3tgt_d,
                         mxtgt_d1, mxtgt_d, mdntgt_i1, mdntgt_i,
                         q3tgt_i1, q3tgt_i, mxtgt_i1, mxtgt_i)


```

TJX
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
tjx7_gd <- tjx7_decr_Days_grouped
tjx7_gi <- tjx7_incr_Days_grouped

#removes the row names 
row.names(tjx7_gd) <- NULL
row.names(tjx7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
tjx7_gd <- tjx7_gd[order(tjx7_gd$n),]
tjx7_gi <- tjx7_gi[order(tjx7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdntjx_d <- as.numeric(floor(quantile(tjx7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(tjx7_gd$n)/2)
mdntjx_d1 <- as.numeric(tjx7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3tjx_d <- as.numeric(floor(quantile(tjx7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(tjx7_gd$n)*.75)
q3tjx_d1 <- as.numeric(tjx7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxtjx_d <- as.numeric(floor(quantile(tjx7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxtjx_d1 <- as.numeric(tjx7_gd[length(tjx7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdntjx_i <- as.numeric(floor(quantile(tjx7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(tjx7_gi$n)/2)
mdntjx_i1 <- as.numeric(tjx7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3tjx_i <- as.numeric(floor(quantile(tjx7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(tjx7_gi$n)*.75)
q3tjx_i1 <- as.numeric(tjx7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxtjx_i <- as.numeric(floor(quantile(tjx7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxtjx_i1 <- as.numeric(tjx7_gi[length(tjx7_gi$n),1])


tjx_g <- grep('TJX', ALL_52$stock)

ALL_52[tjx_g,18:29] <- c(mdntjx_d1, mdntjx_d, q3tjx_d1, q3tjx_d,
                         mxtjx_d1, mxtjx_d, mdntjx_i1, mdntjx_i,
                         q3tjx_i1, q3tjx_i, mxtjx_i1, mxtjx_i)


```

TM
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
tm7_gd <- tm7_decr_Days_grouped
tm7_gi <- tm7_incr_Days_grouped

#removes the row names 
row.names(tm7_gd) <- NULL
row.names(tm7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
tm7_gd <- tm7_gd[order(tm7_gd$n),]
tm7_gi <- tm7_gi[order(tm7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdntm_d <- as.numeric(floor(quantile(tm7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(tm7_gd$n)/2)
mdntm_d1 <- as.numeric(tm7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3tm_d <- as.numeric(floor(quantile(tm7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(tm7_gd$n)*.75)
q3tm_d1 <- as.numeric(tm7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxtm_d <- as.numeric(floor(quantile(tm7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxtm_d1 <- as.numeric(tm7_gd[length(tm7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdntm_i <- as.numeric(floor(quantile(tm7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(tm7_gi$n)/2)
mdntm_i1 <- as.numeric(tm7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3tm_i <- as.numeric(floor(quantile(tm7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(tm7_gi$n)*.75)
q3tm_i1 <- as.numeric(tm7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxtm_i <- as.numeric(floor(quantile(tm7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxtm_i1 <- as.numeric(tm7_gi[length(tm7_gi$n),1])


tm_g <- grep('^TM$', ALL_52$stock)

ALL_52[tm_g,18:29] <- c(mdntm_d1, mdntm_d, q3tm_d1, q3tm_d,
                         mxtm_d1, mxtm_d, mdntm_i1, mdntm_i,
                         q3tm_i1, q3tm_i, mxtm_i1, mxtm_i)


```

UBSI
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
ubsi7_gd <- ubsi7_decr_Days_grouped
ubsi7_gi <- ubsi7_incr_Days_grouped

#removes the row names 
row.names(ubsi7_gd) <- NULL
row.names(ubsi7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
ubsi7_gd <- ubsi7_gd[order(ubsi7_gd$n),]
ubsi7_gi <- ubsi7_gi[order(ubsi7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnubsi_d <- as.numeric(floor(quantile(ubsi7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(ubsi7_gd$n)/2)
mdnubsi_d1 <- as.numeric(ubsi7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3ubsi_d <- as.numeric(floor(quantile(ubsi7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(ubsi7_gd$n)*.75)
q3ubsi_d1 <- as.numeric(ubsi7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxubsi_d <- as.numeric(floor(quantile(ubsi7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxubsi_d1 <- as.numeric(ubsi7_gd[length(ubsi7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnubsi_i <- as.numeric(floor(quantile(ubsi7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(ubsi7_gi$n)/2)
mdnubsi_i1 <- as.numeric(ubsi7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3ubsi_i <- as.numeric(floor(quantile(ubsi7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(ubsi7_gi$n)*.75)
q3ubsi_i1 <- as.numeric(ubsi7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxubsi_i <- as.numeric(floor(quantile(ubsi7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxubsi_i1 <- as.numeric(ubsi7_gi[length(ubsi7_gi$n),1])


ubsi_g <- grep('UBSI', ALL_52$stock)

ALL_52[ubsi_g,18:29] <- c(mdnubsi_d1, mdnubsi_d, q3ubsi_d1, q3ubsi_d,
                         mxubsi_d1, mxubsi_d, mdnubsi_i1, mdnubsi_i,
                         q3ubsi_i1, q3ubsi_i, mxubsi_i1, mxubsi_i)


```

VZ
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
vz7_gd <- vz7_decr_Days_grouped
vz7_gi <- vz7_incr_Days_grouped

#removes the row names 
row.names(vz7_gd) <- NULL
row.names(vz7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
vz7_gd <- vz7_gd[order(vz7_gd$n),]
vz7_gi <- vz7_gi[order(vz7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnvz_d <- as.numeric(floor(quantile(vz7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(vz7_gd$n)/2)
mdnvz_d1 <- as.numeric(vz7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3vz_d <- as.numeric(floor(quantile(vz7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(vz7_gd$n)*.75)
q3vz_d1 <- as.numeric(vz7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxvz_d <- as.numeric(floor(quantile(vz7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxvz_d1 <- as.numeric(vz7_gd[length(vz7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnvz_i <- as.numeric(floor(quantile(vz7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(vz7_gi$n)/2)
mdnvz_i1 <- as.numeric(vz7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3vz_i <- as.numeric(floor(quantile(vz7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(vz7_gi$n)*.75)
q3vz_i1 <- as.numeric(vz7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxvz_i <- as.numeric(floor(quantile(vz7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxvz_i1 <- as.numeric(vz7_gi[length(vz7_gi$n),1])


vz_g <- grep('VZ', ALL_52$stock)

ALL_52[vz_g,18:29] <- c(mdnvz_d1, mdnvz_d, q3vz_d1, q3vz_d,
                         mxvz_d1, mxvz_d, mdnvz_i1, mdnvz_i,
                         q3vz_i1, q3vz_i, mxvz_i1, mxvz_i)


```

WFC
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
wfc7_gd <- wfc7_decr_Days_grouped
wfc7_gi <- wfc7_incr_Days_grouped

#removes the row names 
row.names(wfc7_gd) <- NULL
row.names(wfc7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
wfc7_gd <- wfc7_gd[order(wfc7_gd$n),]
wfc7_gi <- wfc7_gi[order(wfc7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnwfc_d <- as.numeric(floor(quantile(wfc7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(wfc7_gd$n)/2)
mdnwfc_d1 <- as.numeric(wfc7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3wfc_d <- as.numeric(floor(quantile(wfc7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(wfc7_gd$n)*.75)
q3wfc_d1 <- as.numeric(wfc7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxwfc_d <- as.numeric(floor(quantile(wfc7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxwfc_d1 <- as.numeric(wfc7_gd[length(wfc7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnwfc_i <- as.numeric(floor(quantile(wfc7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(wfc7_gi$n)/2)
mdnwfc_i1 <- as.numeric(wfc7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3wfc_i <- as.numeric(floor(quantile(wfc7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(wfc7_gi$n)*.75)
q3wfc_i1 <- as.numeric(wfc7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxwfc_i <- as.numeric(floor(quantile(wfc7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxwfc_i1 <- as.numeric(wfc7_gi[length(wfc7_gi$n),1])


wfc_g <- grep('WFC', ALL_52$stock)

ALL_52[wfc_g,18:29] <- c(mdnwfc_d1, mdnwfc_d, q3wfc_d1, q3wfc_d,
                         mxwfc_d1, mxwfc_d, mdnwfc_i1, mdnwfc_i,
                         q3wfc_i1, q3wfc_i, mxwfc_i1, mxwfc_i)


```

WM
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
wm7_gd <- wm7_decr_Days_grouped
wm7_gi <- wm7_incr_Days_grouped

#removes the row names 
row.names(wm7_gd) <- NULL
row.names(wm7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
wm7_gd <- wm7_gd[order(wm7_gd$n),]
wm7_gi <- wm7_gi[order(wm7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnwm_d <- as.numeric(floor(quantile(wm7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(wm7_gd$n)/2)
mdnwm_d1 <- as.numeric(wm7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3wm_d <- as.numeric(floor(quantile(wm7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(wm7_gd$n)*.75)
q3wm_d1 <- as.numeric(wm7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxwm_d <- as.numeric(floor(quantile(wm7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxwm_d1 <- as.numeric(wm7_gd[length(wm7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnwm_i <- as.numeric(floor(quantile(wm7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(wm7_gi$n)/2)
mdnwm_i1 <- as.numeric(wm7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3wm_i <- as.numeric(floor(quantile(wm7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(wm7_gi$n)*.75)
q3wm_i1 <- as.numeric(wm7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxwm_i <- as.numeric(floor(quantile(wm7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxwm_i1 <- as.numeric(wm7_gi[length(wm7_gi$n),1])


wm_g <- grep('^WM$', ALL_52$stock)

ALL_52[wm_g,18:29] <- c(mdnwm_d1, mdnwm_d, q3wm_d1, q3wm_d,
                         mxwm_d1, mxwm_d, mdnwm_i1, mdnwm_i,
                         q3wm_i1, q3wm_i, mxwm_i1, mxwm_i)


```

WMT
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
wmt7_gd <- wmt7_decr_Days_grouped
wmt7_gi <- wmt7_incr_Days_grouped

#removes the row names 
row.names(wmt7_gd) <- NULL
row.names(wmt7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
wmt7_gd <- wmt7_gd[order(wmt7_gd$n),]
wmt7_gi <- wmt7_gi[order(wmt7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnwmt_d <- as.numeric(floor(quantile(wmt7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(wmt7_gd$n)/2)
mdnwmt_d1 <- as.numeric(wmt7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3wmt_d <- as.numeric(floor(quantile(wmt7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(wmt7_gd$n)*.75)
q3wmt_d1 <- as.numeric(wmt7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxwmt_d <- as.numeric(floor(quantile(wmt7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxwmt_d1 <- as.numeric(wmt7_gd[length(wmt7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnwmt_i <- as.numeric(floor(quantile(wmt7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(wmt7_gi$n)/2)
mdnwmt_i1 <- as.numeric(wmt7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3wmt_i <- as.numeric(floor(quantile(wmt7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(wmt7_gi$n)*.75)
q3wmt_i1 <- as.numeric(wmt7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxwmt_i <- as.numeric(floor(quantile(wmt7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxwmt_i1 <- as.numeric(wmt7_gi[length(wmt7_gi$n),1])


wmt_g <- grep('WMT$', ALL_52$stock)

ALL_52[wmt_g,18:29] <- c(mdnwmt_d1, mdnwmt_d, q3wmt_d1, q3wmt_d,
                         mxwmt_d1, mxwmt_d, mdnwmt_i1, mdnwmt_i,
                         q3wmt_i1, q3wmt_i, mxwmt_i1, mxwmt_i)


```

WWE
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
wwe7_gd <- wwe7_decr_Days_grouped
wwe7_gi <- wwe7_incr_Days_grouped

#removes the row names 
row.names(wwe7_gd) <- NULL
row.names(wwe7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
wwe7_gd <- wwe7_gd[order(wwe7_gd$n),]
wwe7_gi <- wwe7_gi[order(wwe7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnwwe_d <- as.numeric(floor(quantile(wwe7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(wwe7_gd$n)/2)
mdnwwe_d1 <- as.numeric(wwe7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3wwe_d <- as.numeric(floor(quantile(wwe7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(wwe7_gd$n)*.75)
q3wwe_d1 <- as.numeric(wwe7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxwwe_d <- as.numeric(floor(quantile(wwe7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxwwe_d1 <- as.numeric(wwe7_gd[length(wwe7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnwwe_i <- as.numeric(floor(quantile(wwe7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(wwe7_gi$n)/2)
mdnwwe_i1 <- as.numeric(wwe7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3wwe_i <- as.numeric(floor(quantile(wwe7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(wwe7_gi$n)*.75)
q3wwe_i1 <- as.numeric(wwe7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxwwe_i <- as.numeric(floor(quantile(wwe7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxwwe_i1 <- as.numeric(wwe7_gi[length(wwe7_gi$n),1])


wwe_g <- grep('WWE', ALL_52$stock)

ALL_52[wwe_g,18:29] <- c(mdnwwe_d1, mdnwwe_d, q3wwe_d1, q3wwe_d,
                         mxwwe_d1, mxwwe_d, mdnwwe_i1, mdnwwe_i,
                         q3wwe_i1, q3wwe_i, mxwwe_i1, mxwwe_i)


```

XOM
```{r}
#the grouped tables for the decreasing and increasing counts as sets
#where each set of counts happened one or more times
xom7_gd <- xom7_decr_Days_grouped
xom7_gi <- xom7_incr_Days_grouped

#removes the row names 
row.names(xom7_gd) <- NULL
row.names(xom7_gi) <- NULL

#orders the tables by n counts of decreasing days, so indexing can be done
xom7_gd <- xom7_gd[order(xom7_gd$n),]
xom7_gi <- xom7_gi[order(xom7_gi$n),]

#the median value of counts for the number of times a stock decr in this time span
mdnxom_d <- as.numeric(floor(quantile(xom7_gd$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of decr days occurred in this time series
c1 <- ceiling(length(xom7_gd$n)/2)
mdnxom_d1 <- as.numeric(xom7_gd[c1,1])

#the 3rd quantile of counts of sets decr days in this time span from a quantile tibble
#has to be set to numeric
q3xom_d <- as.numeric(floor(quantile(xom7_gd$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the decr set that occured 75% of the time in counts for this time span
c2 <- floor(length(xom7_gd$n)*.75)
q3xom_d1 <- as.numeric(xom7_gd[c2,1])

#the max value of times a set's decr days occurred in this time span
mxxom_d <- as.numeric(floor(quantile(xom7_gd$n, probs=1, na.rm=TRUE)))

#the set of decreasing days in the max counts
mxxom_d1 <- as.numeric(xom7_gd[length(xom7_gd$n),1])


#the median value of counts for the number of times a stock incr in this time span
mdnxom_i <- as.numeric(floor(quantile(xom7_gi$n, probs=0.5, na.rm=TRUE)))

#the index of the median number of times a sum of incr days occurred in this time series
c1 <- ceiling(length(xom7_gi$n)/2)
mdnxom_i1 <- as.numeric(xom7_gi[c1,1])

#the 3rd quantile of counts of sets incr days in this time span from a quantile tibble
#has to be set to numeric
q3xom_i <- as.numeric(floor(quantile(xom7_gi$n, probs=0.75, na.rm=TRUE)))

#the index of the 3rd quantile, to get the incr set that occured 75% of the time in counts for this time span
c2 <- floor(length(xom7_gi$n)*.75)
q3xom_i1 <- as.numeric(xom7_gi[c2,1])

#the max value of times a set's incr days occurred in this time span
mxxom_i <- as.numeric(floor(quantile(xom7_gi$n, probs=1, na.rm=TRUE)))

#the set of increasing days in the max counts
mxxom_i1 <- as.numeric(xom7_gi[length(xom7_gi$n),1])


xom_g <- grep('XOM', ALL_52$stock)

ALL_52[xom_g,18:29] <- c(mdnxom_d1, mdnxom_d, q3xom_d1, q3xom_d,
                         mxxom_d1, mxxom_d, mdnxom_i1, mdnxom_i,
                         q3xom_i1, q3xom_i, mxxom_i1, mxxom_i)


```

Write this file out to csv.
```{r}
colnames(ALL_52) <- paste(colnames(ALL_52),
                                       year(START_DATE), sep='_')
write.csv(ALL_52, paste(paste('ALL_52_L7_grouped_counts',year(START_DATE), 
                        sep='_'),'.csv', sep=''), row.names=TRUE)
```


Combine the skewed data to this data set.
```{r}
skewQuest1 <- skewQuest[,-c(2:3)]
colnames(skewQuest1) <- paste(colnames(skewQuest1),year(START_DATE),sep='_')
stocknm <- colnames(skewQuest1)[1]
stockname <- colnames(ALL_52)[1]
ALL_52_groups_skews <- merge(ALL_52, skewQuest1, by.x=stockname, by.y=stocknm)
```

```{r}
ALL_52_groups_skews <- ALL_52_groups_skews[,c(1:5,30,6:29)]
```

Write to csv.
```{r}
write.csv(ALL_52_groups_skews, paste(paste('ALL_52_groups_skews.csv',year(START_DATE), 
                        sep='_'),'.csv',sep=''), row.names=TRUE)
```
